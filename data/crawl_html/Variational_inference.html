<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Variational Bayesian methods - Wikipedia</title>
<script>(function(){var className="client-js vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-available";var cookie=document.cookie.match(/(?:^|; )enwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"8df0c3e2-a002-431f-99bb-8367f7d9b5ac","wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Variational_Bayesian_methods","wgTitle":"Variational Bayesian methods","wgCurRevisionId":1318931229,"wgRevisionId":1318931229,"wgArticleId":1208480,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Articles with short description","Short description matches Wikidata","Webarchive template wayback links","Bayesian statistics"],"wgPageViewLanguage":"en","wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Variational_Bayesian_methods","wgRelevantArticleId":1208480,"wgTempUserName":null,"wgIsProbablyEditable":true,"wgRelevantPageIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Variational_inference","wgNoticeProject":"wikipedia","wgFlaggedRevsParams":{"tags":{"status":{"levels":1}}},"wgConfirmEditCaptchaNeededForGenericEdit":"hcaptcha","wgConfirmEditHCaptchaVisualEditorOnLoadIntegrationEnabled":false,"wgConfirmEditHCaptchaSiteKey":"ccd26dec-6c86-4034-a704-e402435cd53c","wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgPopupsFlags":0,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"watchlist":true,"tagline":false,"nearby":true},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":60000,"wgInternalRedirectTargetUrl":"/wiki/Variational_Bayesian_methods","wgEditSubmitButtonLabelPublish":true,"wgULSPosition":"interlanguage","wgULSisCompactLinksEnabled":false,"wgVector2022LanguageInHeader":true,"wgULSisLanguageSelectorEmpty":false,"wgWikibaseItemId":"Q7915794","wgCheckUserClientHintsHeadersJsApi":["brands","architecture","bitness","fullVersionList","mobile","model","platform","platformVersion"],"GEHomepageSuggestedEditsEnableTopics":true,"wgGESuggestedEditsTaskTypes":{"taskTypes":["copyedit","link-recommendation"],"unavailableTaskTypes":[]},"wgGETopicsMatchModeEnabled":false,"wgGELevelingUpEnabledForUser":false,"wgGEUseMetricsPlatformExtension":true,"wgMetricsPlatformUserExperiments":{"active_experiments":[],"overrides":[],"enrolled":[],"assigned":[],"subject_ids":[],"sampling_units":[],"coordinator":[]}};
RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.math.styles":"ready","ext.cite.styles":"ready","ext.wikimediamessages.styles":"ready","skins.vector.search.codex.styles":"ready","skins.vector.styles":"ready","skins.vector.icons":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","wikibase.client.init":"ready"};RLPAGEMODULES=["mediawiki.action.view.redirect","ext.cite.ux-enhancements","mediawiki.page.media","site","mediawiki.page.ready","mediawiki.toc","skins.vector.js","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.gadget.ReferenceTooltips","ext.gadget.switcher","ext.urlShortener.toolbar","ext.centralauth.centralautologin","mmv.bootstrap","ext.popups","ext.visualEditor.desktopArticleTarget.init","ext.echo.centralauth","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.interface","ext.cx.eventlogging.campaigns","ext.cx.uls.quick.actions","wikibase.client.vector-2022","wikibase.databox.fromWikidata","ext.checkUser.clientHints","ext.growthExperiments.SuggestedEditSession","ext.xLab"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.cite.styles%7Cext.math.styles%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cext.wikimediamessages.styles%7Cskins.vector.icons%2Cstyles%7Cskins.vector.search.codex.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector-2022">
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector-2022"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector-2022">
<meta name="generator" content="MediaWiki 1.46.0-wmf.5">
<meta name="referrer" content="origin">
<meta name="referrer" content="origin-when-cross-origin">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<meta property="og:title" content="Variational Bayesian methods - Wikipedia">
<meta property="og:type" content="website">
<link rel="preconnect" href="//upload.wikimedia.org">
<link rel="alternate" type="application/x-wiki" title="Edit this page" href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit">
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png">
<link rel="icon" href="/static/favicon/wikipedia.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/w/rest.php/v1/search" title="Wikipedia (en)">
<link rel="EditURI" type="application/rsd+xml" href="//en.wikipedia.org/w/api.php?action=rsd">
<link rel="canonical" href="https://en.wikipedia.org/wiki/Variational_Bayesian_methods">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">
<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
<link rel="dns-prefetch" href="auth.wikimedia.org">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject mw-editable page-Variational_Bayesian_methods rootpage-Variational_Bayesian_methods skin-vector-2022 action-view">
<div id="mw-aria-live-region" class="mw-aria-live-region" aria-live="polite"></div><a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	<header class="vector-header mw-header no-font-mode-scale">
		<div class="vector-header-start">
			<nav class="vector-main-menu-landmark" aria-label="Site">
				
<div id="vector-main-menu-dropdown" class="vector-dropdown vector-main-menu-dropdown vector-button-flush-left vector-button-flush-right"  title="Main menu" >
	<input type="checkbox" id="vector-main-menu-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-main-menu-dropdown" class="vector-dropdown-checkbox "  aria-label="Main menu"  >
	<label id="vector-main-menu-dropdown-label" for="vector-main-menu-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-menu mw-ui-icon-wikimedia-menu"></span>

<span class="vector-dropdown-label-text">Main menu</span>
	</label>
	<div class="vector-dropdown-content">


				<div id="vector-main-menu-unpinned-container" class="vector-unpinned-container">
		
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-main-menu-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="main-menu-pinned"
	data-pinnable-element-id="vector-main-menu"
	data-pinned-container-id="vector-main-menu-pinned-container"
	data-unpinned-container-id="vector-main-menu-unpinned-container"
>
	<div class="vector-pinnable-header-label">Main menu</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-main-menu.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-main-menu.unpin">hide</button>
</div>

	
<div id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation"  >
	<div class="vector-menu-heading">
		Navigation
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-mainpage-description" class="mw-list-item"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-contents" class="mw-list-item"><a href="/wiki/Wikipedia:Contents" title="Guides to browsing Wikipedia"><span>Contents</span></a></li><li id="n-currentevents" class="mw-list-item"><a href="/wiki/Portal:Current_events" title="Articles related to current events"><span>Current events</span></a></li><li id="n-randompage" class="mw-list-item"><a href="/wiki/Special:Random" title="Visit a randomly selected article [x]" accesskey="x"><span>Random article</span></a></li><li id="n-aboutsite" class="mw-list-item"><a href="/wiki/Wikipedia:About" title="Learn about Wikipedia and how it works"><span>About Wikipedia</span></a></li><li id="n-contactpage" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia"><span>Contact us</span></a></li>
		</ul>
		
	</div>
</div>

	
<div id="p-interaction" class="vector-menu mw-portlet mw-portlet-interaction"  >
	<div class="vector-menu-heading">
		Contribute
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-help" class="mw-list-item"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia"><span>Help</span></a></li><li id="n-introduction" class="mw-list-item"><a href="/wiki/Help:Introduction" title="Learn how to edit Wikipedia"><span>Learn to edit</span></a></li><li id="n-portal" class="mw-list-item"><a href="/wiki/Wikipedia:Community_portal" title="The hub for editors"><span>Community portal</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes to Wikipedia [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-upload" class="mw-list-item"><a href="/wiki/Wikipedia:File_upload_wizard" title="Add images or other media for use on Wikipedia"><span>Upload file</span></a></li><li id="n-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages"><span>Special pages</span></a></li>
		</ul>
		
	</div>
</div>

</div>

				</div>

	</div>
</div>

		</nav>
			
<a href="/wiki/Main_Page" class="mw-logo">
	<img class="mw-logo-icon" src="/static/images/icons/wikipedia.png" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container skin-invert">
		<img class="mw-logo-wordmark" alt="Wikipedia" src="/static/images/mobile/copyright/wikipedia-wordmark-en.svg" style="width: 7.5em; height: 1.125em;">
		<img class="mw-logo-tagline" alt="The Free Encyclopedia" src="/static/images/mobile/copyright/wikipedia-tagline-en.svg" width="117" height="13" style="width: 7.3125em; height: 0.8125em;">
	</span>
</a>

		</div>
		<div class="vector-header-end">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="/wiki/Special:Search" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only search-toggle" title="Search Wikipedia [f]" accesskey="f"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
	</a>
	<div class="vector-typeahead-search-container">
		<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail cdx-typeahead-search--auto-expand-width">
			<form action="/w/index.php" id="searchform" class="cdx-search-input cdx-search-input--has-end-button">
				<div id="simpleSearch" class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
					<div class="cdx-text-input cdx-text-input--has-start-icon">
						<input
							class="cdx-text-input__input mw-searchInput" autocomplete="off"
							 type="search" name="search" placeholder="Search Wikipedia" aria-label="Search Wikipedia" autocapitalize="sentences" spellcheck="false" title="Search Wikipedia [f]" accesskey="f" id="searchInput"
							>
						<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
					</div>
					<input type="hidden" name="title" value="Special:Search">
				</div>
				<button class="cdx-button cdx-search-input__end-button">Search</button>
			</form>
		</div>
	</div>
</div>

			<nav class="vector-user-links vector-user-links-wide" aria-label="Personal tools">
	<div class="vector-user-links-main">
	
<div id="p-vector-user-menu-preferences" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-userpage" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	<nav class="vector-appearance-landmark" aria-label="Appearance">
		
<div id="vector-appearance-dropdown" class="vector-dropdown "  title="Change the appearance of the page&#039;s font size, width, and color" >
	<input type="checkbox" id="vector-appearance-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-appearance-dropdown" class="vector-dropdown-checkbox "  aria-label="Appearance"  >
	<label id="vector-appearance-dropdown-label" for="vector-appearance-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-appearance mw-ui-icon-wikimedia-appearance"></span>

<span class="vector-dropdown-label-text">Appearance</span>
	</label>
	<div class="vector-dropdown-content">


			<div id="vector-appearance-unpinned-container" class="vector-unpinned-container">
				
			</div>
		
	</div>
</div>

	</nav>
	
<div id="p-vector-user-menu-notifications" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="pt-sitesupport-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en" class=""><span>Donate</span></a>
</li>
<li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="/w/index.php?title=Special:CreateAccount&amp;returnto=Variational+Bayesian+methods" title="You are encouraged to create an account and log in; however, it is not mandatory" class=""><span>Create account</span></a>
</li>
<li id="pt-login-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw-interface  href="/w/index.php?title=Special:UserLogin&amp;returnto=Variational+Bayesian+methods" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o" class=""><span>Log in</span></a>
</li>

			
		</ul>
		
	</div>
</div>

	</div>
	
<div id="vector-user-links-dropdown" class="vector-dropdown vector-user-menu vector-button-flush-right vector-user-menu-logged-out user-links-collapsible-item"  title="Log in and more options" >
	<input type="checkbox" id="vector-user-links-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-user-links-dropdown" class="vector-dropdown-checkbox "  aria-label="Personal tools"  >
	<label id="vector-user-links-dropdown-label" for="vector-user-links-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

<span class="vector-dropdown-label-text">Personal tools</span>
	</label>
	<div class="vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal user-links-collapsible-item"  title="User menu" >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-sitesupport" class="user-links-collapsible-item mw-list-item"><a href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en"><span>Donate</span></a></li><li id="pt-createaccount" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Variational+Bayesian+methods" title="You are encouraged to create an account and log in; however, it is not mandatory"><span class="vector-icon mw-ui-icon-userAdd mw-ui-icon-wikimedia-userAdd"></span> <span>Create account</span></a></li><li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Variational+Bayesian+methods" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o"><span class="vector-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li>
		</ul>
		
	</div>
</div>

	
	</div>
</div>

</nav>

		</div>
	</header>
</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-sitenotice-container">
			<div id="siteNotice"><!-- CentralNotice --></div>
		</div>
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		<div id="mw-navigation">
			<nav id="mw-panel" class="vector-main-menu-landmark" aria-label="Site">
				<div id="vector-main-menu-pinned-container" class="vector-pinned-container">
				
				</div>
		</nav>
		</div>
	</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="toc-pinned"
	data-pinnable-element-id="vector-toc"
	
	
>
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text"
			class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">(Top)</div>
			</a>
		</li>
		<li id="toc-Mathematical_derivation"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Mathematical_derivation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Mathematical derivation</span>
			</div>
		</a>
		
			<button aria-controls="toc-Mathematical_derivation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Mathematical derivation subsection</span>
			</button>
		
		<ul id="toc-Mathematical_derivation-sublist" class="vector-toc-list">
			<li id="toc-Problem"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Problem">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.1</span>
					<span>Problem</span>
				</div>
			</a>
			
			<ul id="toc-Problem-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-KL_divergence"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#KL_divergence">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2</span>
					<span>KL divergence</span>
				</div>
			</a>
			
			<ul id="toc-KL_divergence-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Intractability"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Intractability">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.3</span>
					<span>Intractability</span>
				</div>
			</a>
			
			<ul id="toc-Intractability-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Evidence_lower_bound"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Evidence_lower_bound">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.4</span>
					<span>Evidence lower bound</span>
				</div>
			</a>
			
			<ul id="toc-Evidence_lower_bound-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Proofs"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Proofs">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.5</span>
					<span>Proofs</span>
				</div>
			</a>
			
			<ul id="toc-Proofs-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Mean_field_approximation"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Mean_field_approximation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Mean field approximation</span>
			</div>
		</a>
		
		<ul id="toc-Mean_field_approximation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-A_duality_formula_for_variational_inference"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#A_duality_formula_for_variational_inference">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>A duality formula for variational inference</span>
			</div>
		</a>
		
		<ul id="toc-A_duality_formula_for_variational_inference-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-A_basic_example"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#A_basic_example">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>A basic example</span>
			</div>
		</a>
		
			<button aria-controls="toc-A_basic_example-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle A basic example subsection</span>
			</button>
		
		<ul id="toc-A_basic_example-sublist" class="vector-toc-list">
			<li id="toc-The_mathematical_model"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#The_mathematical_model">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>The mathematical model</span>
				</div>
			</a>
			
			<ul id="toc-The_mathematical_model-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-The_joint_probability"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#The_joint_probability">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>The joint probability</span>
				</div>
			</a>
			
			<ul id="toc-The_joint_probability-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Factorized_approximation"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Factorized_approximation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>Factorized approximation</span>
				</div>
			</a>
			
			<ul id="toc-Factorized_approximation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Derivation_of_q(μ)"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Derivation_of_q(μ)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.4</span>
					<span>Derivation of <span><i>q</i>(<i>μ</i>)</span></span>
				</div>
			</a>
			
			<ul id="toc-Derivation_of_q(μ)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Derivation_of_q(τ)"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Derivation_of_q(τ)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.5</span>
					<span>Derivation of <span>q(τ)</span></span>
				</div>
			</a>
			
			<ul id="toc-Derivation_of_q(τ)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Algorithm_for_computing_the_parameters"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Algorithm_for_computing_the_parameters">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.6</span>
					<span>Algorithm for computing the parameters</span>
				</div>
			</a>
			
			<ul id="toc-Algorithm_for_computing_the_parameters-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Further_discussion"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Further_discussion">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Further discussion</span>
			</div>
		</a>
		
			<button aria-controls="toc-Further_discussion-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Further discussion subsection</span>
			</button>
		
		<ul id="toc-Further_discussion-sublist" class="vector-toc-list">
			<li id="toc-Step-by-step_recipe"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step-by-step_recipe">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Step-by-step recipe</span>
				</div>
			</a>
			
			<ul id="toc-Step-by-step_recipe-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Most_important_points"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Most_important_points">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Most important points</span>
				</div>
			</a>
			
			<ul id="toc-Most_important_points-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Compared_with_expectation–maximization_(EM)"
			class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Compared_with_expectation–maximization_(EM)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.3</span>
					<span>Compared with expectation–maximization (EM)</span>
				</div>
			</a>
			
			<ul id="toc-Compared_with_expectation–maximization_(EM)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-A_more_complex_example"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#A_more_complex_example">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>A more complex example</span>
			</div>
		</a>
		
		<ul id="toc-A_more_complex_example-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Exponential-family_distributions"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Exponential-family_distributions">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Exponential-family distributions</span>
			</div>
		</a>
		
		<ul id="toc-Exponential-family_distributions-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-References"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#References">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">9</span>
				<span>References</span>
			</div>
		</a>
		
		<ul id="toc-References-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-External_links"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#External_links">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">10</span>
				<span>External links</span>
			</div>
		</a>
		
		<ul id="toc-External_links-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left"  title="Table of Contents" >
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox "  aria-label="Toggle the table of contents"  >
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Variational Bayesian methods</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang"  >
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 6 languages"   >
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-6" aria-hidden="true"  ><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">6 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ca mw-list-item"><a href="https://ca.wikipedia.org/wiki/M%C3%A8todes_bayesians_variacionals" title="Mètodes bayesians variacionals – Catalan" lang="ca" hreflang="ca" data-title="Mètodes bayesians variacionals" data-language-autonym="Català" data-language-local-name="Catalan" class="interlanguage-link-target"><span>Català</span></a></li><li class="interlanguage-link interwiki-fa mw-list-item"><a href="https://fa.wikipedia.org/wiki/%D8%A7%D8%B3%D8%AA%D9%86%D8%A8%D8%A7%D8%B7_%D8%A8%DB%8C%D8%B2%DB%8C_%D8%AA%D8%BA%DB%8C%DB%8C%D8%B1%D8%A7%D8%AA%DB%8C" title="استنباط بیزی تغییراتی – Persian" lang="fa" hreflang="fa" data-title="استنباط بیزی تغییراتی" data-language-autonym="فارسی" data-language-local-name="Persian" class="interlanguage-link-target"><span>فارسی</span></a></li><li class="interlanguage-link interwiki-ko mw-list-item"><a href="https://ko.wikipedia.org/wiki/%EB%B3%80%EB%B6%84_%EB%B2%A0%EC%9D%B4%EC%A6%88_%EB%B0%A9%EB%B2%95" title="변분 베이즈 방법 – Korean" lang="ko" hreflang="ko" data-title="변분 베이즈 방법" data-language-autonym="한국어" data-language-local-name="Korean" class="interlanguage-link-target"><span>한국어</span></a></li><li class="interlanguage-link interwiki-it mw-list-item"><a href="https://it.wikipedia.org/wiki/Inferenza_bayesiana_variazionale" title="Inferenza bayesiana variazionale – Italian" lang="it" hreflang="it" data-title="Inferenza bayesiana variazionale" data-language-autonym="Italiano" data-language-local-name="Italian" class="interlanguage-link-target"><span>Italiano</span></a></li><li class="interlanguage-link interwiki-zh-yue mw-list-item"><a href="https://zh-yue.wikipedia.org/wiki/%E8%AE%8A%E5%88%86%E6%8E%A8%E6%96%B7" title="變分推斷 – Cantonese" lang="yue" hreflang="yue" data-title="變分推斷" data-language-autonym="粵語" data-language-local-name="Cantonese" class="interlanguage-link-target"><span>粵語</span></a></li><li class="interlanguage-link interwiki-zh mw-list-item"><a href="https://zh.wikipedia.org/wiki/%E5%8F%98%E5%88%86%E8%B4%9D%E5%8F%B6%E6%96%AF%E6%96%B9%E6%B3%95" title="变分贝叶斯方法 – Chinese" lang="zh" hreflang="zh" data-title="变分贝叶斯方法" data-language-autonym="中文" data-language-local-name="Chinese" class="interlanguage-link-target"><span>中文</span></a></li>
			</ul>
			<div class="after-portlet after-portlet-lang"><span class="wb-langlinks-edit wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q7915794#sitelinks-wikipedia" title="Edit interlanguage links" class="wbc-editpage">Edit links</a></span></div>
		</div>

	</div>
</div>
</header>
				<div class="vector-page-toolbar vector-feature-custom-font-size-clientpref--excluded">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/Variational_Bayesian_methods" title="View the content page [c]" accesskey="c"><span>Article</span></a></li><li id="ca-talk" class="vector-tab-noicon mw-list-item"><a href="/wiki/Talk:Variational_Bayesian_methods" rel="discussion" title="Discuss improvements to the content page [t]" accesskey="t"><span>Talk</span></a></li>
		</ul>
		
	</div>
</div>

								
<div id="vector-variants-dropdown" class="vector-dropdown emptyPortlet"  >
	<input type="checkbox" id="vector-variants-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-variants-dropdown" class="vector-dropdown-checkbox " aria-label="Change language variant"   >
	<label id="vector-variants-dropdown-label" for="vector-variants-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">English</span>
	</label>
	<div class="vector-dropdown-content">


					
<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

				
	</div>
</div>

							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/Variational_Bayesian_methods"><span>Read</span></a></li><li id="ca-edit" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit" title="Edit this page [e]" accesskey="e"><span>Edit</span></a></li><li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="Page tools">
								
<div id="vector-page-tools-dropdown" class="vector-dropdown vector-page-tools-dropdown"  >
	<input type="checkbox" id="vector-page-tools-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-tools-dropdown" class="vector-dropdown-checkbox "  aria-label="Tools"  >
	<label id="vector-page-tools-dropdown-label" for="vector-page-tools-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">Tools</span>
	</label>
	<div class="vector-dropdown-content">


									<div id="vector-page-tools-unpinned-container" class="vector-unpinned-container">
						
<div id="vector-page-tools" class="vector-page-tools vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-page-tools-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="page-tools-pinned"
	data-pinnable-element-id="vector-page-tools"
	data-pinned-container-id="vector-page-tools-pinned-container"
	data-unpinned-container-id="vector-page-tools-unpinned-container"
>
	<div class="vector-pinnable-header-label">Tools</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-page-tools.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-page-tools.unpin">hide</button>
</div>

	
<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-has-collapsible-items"  title="More options" >
	<div class="vector-menu-heading">
		Actions
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="/wiki/Variational_Bayesian_methods"><span>Read</span></a></li><li id="ca-more-edit" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit" title="Edit this page [e]" accesskey="e"><span>Edit</span></a></li><li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=history"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-tb" class="vector-menu mw-portlet mw-portlet-tb"  >
	<div class="vector-menu-heading">
		General
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/Variational_Bayesian_methods" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/Variational_Bayesian_methods" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-upload" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:File_Upload_Wizard" title="Upload files [u]" accesskey="u"><span>Upload file</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;oldid=1318931229" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-cite" class="mw-list-item"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=Variational_Bayesian_methods&amp;id=1318931229&amp;wpFormIdentifier=titleform" title="Information on how to cite this page"><span>Cite this page</span></a></li><li id="t-urlshortener" class="mw-list-item"><a href="/w/index.php?title=Special:UrlShortener&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FVariational_Bayesian_methods"><span>Get shortened URL</span></a></li><li id="t-urlshortener-qrcode" class="mw-list-item"><a href="/w/index.php?title=Special:QrCode&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FVariational_Bayesian_methods"><span>Download QR code</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-coll-print_export" class="vector-menu mw-portlet mw-portlet-coll-print_export"  >
	<div class="vector-menu-heading">
		Print/export
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="coll-download-as-rl" class="mw-list-item"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=Variational_Bayesian_methods&amp;action=show-download-screen" title="Download this page as a PDF file"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="/w/index.php?title=Variational_Bayesian_methods&amp;printable=yes" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-wikibase-otherprojects" class="vector-menu mw-portlet mw-portlet-wikibase-otherprojects"  >
	<div class="vector-menu-heading">
		In other projects
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-wikibase" class="wb-otherproject-link wb-otherproject-wikibase-dataitem mw-list-item"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q7915794" title="Structured data on this page hosted by Wikidata [g]" accesskey="g"><span>Wikidata item</span></a></li>
		</ul>
		
	</div>
</div>

</div>

									</div>
				
	</div>
</div>

							</nav>
						</div>
					</div>
				</div>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="appearance-pinned"
	data-pinnable-element-id="vector-appearance"
	data-pinned-container-id="vector-appearance-pinned-container"
	data-unpinned-container-id="vector-appearance-unpinned-container"
>
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From Wikipedia, the free encyclopedia</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><span class="mw-redirectedfrom">(Redirected from <a href="/w/index.php?title=Variational_inference&amp;redirect=no" class="mw-redirect" title="Variational inference">Variational inference</a>)</span></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><div class="shortdescription nomobile noexcerpt noprint searchaux" style="display:none">Mathematical methods used in Bayesian inference and machine learning</div>
<style data-mw-deduplicate="TemplateStyles:r1320445320">.mw-parser-output .hatnote{font-style:italic}.mw-parser-output div.hatnote{padding-left:1.6em;margin-bottom:0.5em}.mw-parser-output .hatnote i{font-style:normal}.mw-parser-output .hatnote+link+.hatnote{margin-top:-0.5em}@media print{body.ns-0 .mw-parser-output .hatnote{display:none!important}}</style><div role="note" class="hatnote navigation-not-searchable">For the method of approximation in quantum mechanics, see <a href="/wiki/Variational_method_(quantum_mechanics)" title="Variational method (quantum mechanics)">Variational method (quantum mechanics)</a>.</div>
<style data-mw-deduplicate="TemplateStyles:r1129693374">.mw-parser-output .hlist dl,.mw-parser-output .hlist ol,.mw-parser-output .hlist ul{margin:0;padding:0}.mw-parser-output .hlist dd,.mw-parser-output .hlist dt,.mw-parser-output .hlist li{margin:0;display:inline}.mw-parser-output .hlist.inline,.mw-parser-output .hlist.inline dl,.mw-parser-output .hlist.inline ol,.mw-parser-output .hlist.inline ul,.mw-parser-output .hlist dl dl,.mw-parser-output .hlist dl ol,.mw-parser-output .hlist dl ul,.mw-parser-output .hlist ol dl,.mw-parser-output .hlist ol ol,.mw-parser-output .hlist ol ul,.mw-parser-output .hlist ul dl,.mw-parser-output .hlist ul ol,.mw-parser-output .hlist ul ul{display:inline}.mw-parser-output .hlist .mw-empty-li{display:none}.mw-parser-output .hlist dt::after{content:": "}.mw-parser-output .hlist dd::after,.mw-parser-output .hlist li::after{content:" · ";font-weight:bold}.mw-parser-output .hlist dd:last-child::after,.mw-parser-output .hlist dt:last-child::after,.mw-parser-output .hlist li:last-child::after{content:none}.mw-parser-output .hlist dd dd:first-child::before,.mw-parser-output .hlist dd dt:first-child::before,.mw-parser-output .hlist dd li:first-child::before,.mw-parser-output .hlist dt dd:first-child::before,.mw-parser-output .hlist dt dt:first-child::before,.mw-parser-output .hlist dt li:first-child::before,.mw-parser-output .hlist li dd:first-child::before,.mw-parser-output .hlist li dt:first-child::before,.mw-parser-output .hlist li li:first-child::before{content:" (";font-weight:normal}.mw-parser-output .hlist dd dd:last-child::after,.mw-parser-output .hlist dd dt:last-child::after,.mw-parser-output .hlist dd li:last-child::after,.mw-parser-output .hlist dt dd:last-child::after,.mw-parser-output .hlist dt dt:last-child::after,.mw-parser-output .hlist dt li:last-child::after,.mw-parser-output .hlist li dd:last-child::after,.mw-parser-output .hlist li dt:last-child::after,.mw-parser-output .hlist li li:last-child::after{content:")";font-weight:normal}.mw-parser-output .hlist ol{counter-reset:listitem}.mw-parser-output .hlist ol>li{counter-increment:listitem}.mw-parser-output .hlist ol>li::before{content:" "counter(listitem)"\a0 "}.mw-parser-output .hlist dd ol>li:first-child::before,.mw-parser-output .hlist dt ol>li:first-child::before,.mw-parser-output .hlist li ol>li:first-child::before{content:" ("counter(listitem)"\a0 "}</style><style data-mw-deduplicate="TemplateStyles:r1246091330">.mw-parser-output .sidebar{width:22em;float:right;clear:right;margin:0.5em 0 1em 1em;background:var(--background-color-neutral-subtle,#f8f9fa);border:1px solid var(--border-color-base,#a2a9b1);padding:0.2em;text-align:center;line-height:1.4em;font-size:88%;border-collapse:collapse;display:table}body.skin-minerva .mw-parser-output .sidebar{display:table!important;float:right!important;margin:0.5em 0 1em 1em!important}.mw-parser-output .sidebar-subgroup{width:100%;margin:0;border-spacing:0}.mw-parser-output .sidebar-left{float:left;clear:left;margin:0.5em 1em 1em 0}.mw-parser-output .sidebar-none{float:none;clear:both;margin:0.5em 1em 1em 0}.mw-parser-output .sidebar-outer-title{padding:0 0.4em 0.2em;font-size:125%;line-height:1.2em;font-weight:bold}.mw-parser-output .sidebar-top-image{padding:0.4em}.mw-parser-output .sidebar-top-caption,.mw-parser-output .sidebar-pretitle-with-top-image,.mw-parser-output .sidebar-caption{padding:0.2em 0.4em 0;line-height:1.2em}.mw-parser-output .sidebar-pretitle{padding:0.4em 0.4em 0;line-height:1.2em}.mw-parser-output .sidebar-title,.mw-parser-output .sidebar-title-with-pretitle{padding:0.2em 0.8em;font-size:145%;line-height:1.2em}.mw-parser-output .sidebar-title-with-pretitle{padding:0.1em 0.4em}.mw-parser-output .sidebar-image{padding:0.2em 0.4em 0.4em}.mw-parser-output .sidebar-heading{padding:0.1em 0.4em}.mw-parser-output .sidebar-content{padding:0 0.5em 0.4em}.mw-parser-output .sidebar-content-with-subgroup{padding:0.1em 0.4em 0.2em}.mw-parser-output .sidebar-above,.mw-parser-output .sidebar-below{padding:0.3em 0.8em;font-weight:bold}.mw-parser-output .sidebar-collapse .sidebar-above,.mw-parser-output .sidebar-collapse .sidebar-below{border-top:1px solid #aaa;border-bottom:1px solid #aaa}.mw-parser-output .sidebar-navbar{text-align:right;font-size:115%;padding:0 0.4em 0.4em}.mw-parser-output .sidebar-list-title{padding:0 0.4em;text-align:left;font-weight:bold;line-height:1.6em;font-size:105%}.mw-parser-output .sidebar-list-title-c{padding:0 0.4em;text-align:center;margin:0 3.3em}@media(max-width:640px){body.mediawiki .mw-parser-output .sidebar{width:100%!important;clear:both;float:none!important;margin-left:0!important;margin-right:0!important}}body.skin--responsive .mw-parser-output .sidebar a>img{max-width:none!important}@media screen{html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-list-title,html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle{background:transparent!important}html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle a{color:var(--color-progressive)!important}}@media screen and (prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-list-title,html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle{background:transparent!important}html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle a{color:var(--color-progressive)!important}}@media print{body.ns-0 .mw-parser-output .sidebar{display:none!important}}</style><table class="sidebar nomobile nowraplinks hlist"><tbody><tr><td class="sidebar-pretitle">Part of a series on</td></tr><tr><th class="sidebar-title-with-pretitle"><a href="/wiki/Bayesian_statistics" title="Bayesian statistics">Bayesian statistics</a></th></tr><tr><td class="sidebar-image"><span typeof="mw:File"><a href="/wiki/File:Bayes_icon.svg" class="mw-file-description"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/e/ed/Bayes_icon.svg/120px-Bayes_icon.svg.png" decoding="async" width="80" height="48" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/e/ed/Bayes_icon.svg/250px-Bayes_icon.svg.png 2x" data-file-width="500" data-file-height="300" /></a></span></td></tr><tr><td class="sidebar-content">
<a href="/wiki/Posterior_probability" title="Posterior probability">Posterior</a> = <a href="/wiki/Likelihood_function" title="Likelihood function">Likelihood</a> × <a href="/wiki/Prior_probability" title="Prior probability">Prior</a> ÷ <a href="/wiki/Marginal_likelihood" title="Marginal likelihood">Evidence</a></td>
</tr><tr><th class="sidebar-heading">
Background</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Bayesian_inference" title="Bayesian inference">Bayesian inference</a></li>
<li><a href="/wiki/Bayesian_probability" title="Bayesian probability">Bayesian probability</a></li>
<li><a href="/wiki/Bayes%27_theorem" title="Bayes&#39; theorem">Bayes' theorem</a></li>
<li><a href="/wiki/Bernstein%E2%80%93von_Mises_theorem" title="Bernstein–von Mises theorem">Bernstein–von Mises theorem</a></li>
<li><a href="/wiki/Coherence_(philosophical_gambling_strategy)" class="mw-redirect" title="Coherence (philosophical gambling strategy)">Coherence</a></li>
<li><a href="/wiki/Cox%27s_theorem" title="Cox&#39;s theorem">Cox's theorem</a></li>
<li><a href="/wiki/Cromwell%27s_rule" title="Cromwell&#39;s rule">Cromwell's rule</a></li>
<li><a href="/wiki/Likelihood_principle" title="Likelihood principle">Likelihood principle</a></li>
<li><a href="/wiki/Principle_of_indifference" title="Principle of indifference">Principle of indifference</a></li>
<li><a href="/wiki/Principle_of_maximum_entropy" title="Principle of maximum entropy">Principle of maximum entropy</a></li></ul></td>
</tr><tr><th class="sidebar-heading">
Model building</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Conjugate_prior" title="Conjugate prior">Conjugate prior</a></li>
<li><a href="/wiki/Bayesian_linear_regression" title="Bayesian linear regression">Linear regression</a></li>
<li><a href="/wiki/Empirical_Bayes_method" title="Empirical Bayes method">Empirical Bayes</a></li>
<li><a href="/wiki/Bayesian_hierarchical_modeling" title="Bayesian hierarchical modeling">Hierarchical model</a></li></ul></td>
</tr><tr><th class="sidebar-heading">
Posterior approximation</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Markov_chain_Monte_Carlo" title="Markov chain Monte Carlo">Markov chain Monte Carlo</a></li>
<li><a href="/wiki/Laplace%27s_approximation" title="Laplace&#39;s approximation">Laplace's approximation</a></li>
<li><a href="/wiki/Integrated_nested_Laplace_approximations" title="Integrated nested Laplace approximations">Integrated nested Laplace approximations</a></li>
<li><a class="mw-selflink selflink">Variational inference</a></li>
<li><a href="/wiki/Approximate_Bayesian_computation" title="Approximate Bayesian computation">Approximate Bayesian computation</a></li></ul></td>
</tr><tr><th class="sidebar-heading">
Estimators</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Bayesian_estimator" class="mw-redirect" title="Bayesian estimator">Bayesian estimator</a></li>
<li><a href="/wiki/Credible_interval" title="Credible interval">Credible interval</a></li>
<li><a href="/wiki/Maximum_a_posteriori_estimation" title="Maximum a posteriori estimation">Maximum a posteriori estimation</a></li></ul></td>
</tr><tr><th class="sidebar-heading">
Evidence approximation</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Evidence_lower_bound" title="Evidence lower bound">Evidence lower bound</a></li>
<li><a href="/wiki/Nested_sampling_algorithm" title="Nested sampling algorithm">Nested sampling</a></li></ul></td>
</tr><tr><th class="sidebar-heading">
Model evaluation</th></tr><tr><td class="sidebar-content">
<ul><li><a href="/wiki/Bayes_factor" title="Bayes factor">Bayes factor</a> (<a href="/wiki/Bayesian_information_criterion" title="Bayesian information criterion">Schwarz criterion</a>)</li>
<li><a href="/wiki/Bayesian_model_averaging" class="mw-redirect" title="Bayesian model averaging">Model averaging</a></li>
<li><a href="/wiki/Posterior_predictive_distribution" title="Posterior predictive distribution">Posterior predictive</a></li></ul></td>
</tr><tr><td class="sidebar-below">
<ul><li><span class="nowrap"><span class="skin-invert-image noviewer" typeof="mw:File"><a href="/wiki/File:Nuvola_apps_edu_mathematics_blue-p.svg" class="mw-file-description"><img alt="icon" src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Nuvola_apps_edu_mathematics_blue-p.svg/40px-Nuvola_apps_edu_mathematics_blue-p.svg.png" decoding="async" width="28" height="28" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Nuvola_apps_edu_mathematics_blue-p.svg/60px-Nuvola_apps_edu_mathematics_blue-p.svg.png 1.5x" data-file-width="128" data-file-height="128" /></a></span> </span><a href="/wiki/Portal:Mathematics" title="Portal:Mathematics">Mathematics&#32;portal</a></li></ul></td></tr><tr><td class="sidebar-navbar"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1129693374" /><style data-mw-deduplicate="TemplateStyles:r1239400231">.mw-parser-output .navbar{display:inline;font-size:88%;font-weight:normal}.mw-parser-output .navbar-collapse{float:left;text-align:left}.mw-parser-output .navbar-boxtext{word-spacing:0}.mw-parser-output .navbar ul{display:inline-block;white-space:nowrap;line-height:inherit}.mw-parser-output .navbar-brackets::before{margin-right:-0.125em;content:"[ "}.mw-parser-output .navbar-brackets::after{margin-left:-0.125em;content:" ]"}.mw-parser-output .navbar li{word-spacing:-0.125em}.mw-parser-output .navbar a>span,.mw-parser-output .navbar a>abbr{text-decoration:inherit}.mw-parser-output .navbar-mini abbr{font-variant:small-caps;border-bottom:none;text-decoration:none;cursor:inherit}.mw-parser-output .navbar-ct-full{font-size:114%;margin:0 7em}.mw-parser-output .navbar-ct-mini{font-size:114%;margin:0 4em}html.skin-theme-clientpref-night .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}@media(prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}}@media print{.mw-parser-output .navbar{display:none!important}}</style><div class="navbar plainlinks hlist navbar-mini"><ul><li class="nv-view"><a href="/wiki/Template:Bayesian_statistics" title="Template:Bayesian statistics"><abbr title="View this template">v</abbr></a></li><li class="nv-talk"><a href="/wiki/Template_talk:Bayesian_statistics" title="Template talk:Bayesian statistics"><abbr title="Discuss this template">t</abbr></a></li><li class="nv-edit"><a href="/wiki/Special:EditPage/Template:Bayesian_statistics" title="Special:EditPage/Template:Bayesian statistics"><abbr title="Edit this template">e</abbr></a></li></ul></div></td></tr></tbody></table>
<p><b>Variational Bayesian methods</b> are a family of techniques for approximating intractable <a href="/wiki/Integral" title="Integral">integrals</a> arising in <a href="/wiki/Bayesian_inference" title="Bayesian inference">Bayesian inference</a> and <a href="/wiki/Machine_learning" title="Machine learning">machine learning</a>.  They are typically used in complex <a href="/wiki/Statistical_model" title="Statistical model">statistical models</a> consisting of observed variables (usually termed "data") as well as unknown <a href="/wiki/Parameter" title="Parameter">parameters</a> and <a href="/wiki/Latent_variable" class="mw-redirect" title="Latent variable">latent variables</a>, with various sorts of relationships among the three types of <a href="/wiki/Random_variable" title="Random variable">random variables</a>, as might be described by a <a href="/wiki/Graphical_model" title="Graphical model">graphical model</a>.  As typical in Bayesian inference, the parameters and latent variables are grouped together as "unobserved variables". Variational Bayesian methods are primarily used for two purposes:
</p>
<ol><li>To provide an analytical approximation to the <a href="/wiki/Posterior_probability" title="Posterior probability">posterior probability</a> of the unobserved variables, in order to do <a href="/wiki/Statistical_inference" title="Statistical inference">statistical inference</a> over these variables.</li>
<li>To derive a <a href="/wiki/Lower_bound" class="mw-redirect" title="Lower bound">lower bound</a> for the <a href="/wiki/Marginal_likelihood" title="Marginal likelihood">marginal likelihood</a> (sometimes called the <i>evidence</i>) of the observed data (i.e. the <a href="/wiki/Marginal_probability" class="mw-redirect" title="Marginal probability">marginal probability</a> of the data given the model, with marginalization performed over unobserved variables).  This is typically used for performing <a href="/wiki/Model_selection" title="Model selection">model selection</a>, the general idea being that a higher marginal likelihood for a given model indicates a better fit of the data by that model and hence a greater probability that the model in question was the one that generated the data. (See also the <a href="/wiki/Bayes_factor" title="Bayes factor">Bayes factor</a> article.)</li></ol>
<p>In the former purpose (that of approximating a posterior probability), variational Bayes is an alternative to <a href="/wiki/Monte_Carlo_sampling" class="mw-redirect" title="Monte Carlo sampling">Monte Carlo sampling</a> methods—particularly, <a href="/wiki/Markov_chain_Monte_Carlo" title="Markov chain Monte Carlo">Markov chain Monte Carlo</a> methods such as <a href="/wiki/Gibbs_sampling" title="Gibbs sampling">Gibbs sampling</a>—for taking a fully Bayesian approach to <a href="/wiki/Statistical_inference" title="Statistical inference">statistical inference</a> over complex <a href="/wiki/Probability_distribution" title="Probability distribution">distributions</a> that are difficult to evaluate directly or <a href="/wiki/Sample_(statistics)" class="mw-redirect" title="Sample (statistics)">sample</a>. In particular, whereas Monte Carlo techniques provide a numerical approximation to the exact posterior using a set of samples, variational Bayes provides a locally-optimal, exact analytical solution to an approximation of the posterior.
</p><p>Variational Bayes can be seen as an extension of the <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization</a> (EM) algorithm from <a href="/wiki/Maximum_likelihood_estimation" title="Maximum likelihood estimation">maximum likelihood</a> (ML) or <a href="/wiki/Maximum_a_posteriori_estimation" title="Maximum a posteriori estimation">maximum a posteriori</a> (MAP) estimation of the single most probable value of each parameter to fully Bayesian estimation which computes (an approximation to) the entire <a href="/wiki/Posterior_distribution" class="mw-redirect" title="Posterior distribution">posterior distribution</a> of the parameters and latent variables.  As in EM, it finds a set of optimal parameter values, and it has the same alternating structure as does EM, based on a set of interlocked (mutually dependent) equations that cannot be solved analytically.
</p><p>For many applications, variational Bayes produces solutions of comparable accuracy to Gibbs sampling at greater speed.  However, deriving the set of equations used to update the parameters iteratively often requires a large amount of work compared with deriving the comparable Gibbs sampling equations.  This is the case even for many models that are conceptually quite simple, as is demonstrated below in the case of a basic non-hierarchical model with only two parameters and no latent variables.
</p>
<meta property="mw:PageProp/toc" />
<div class="mw-heading mw-heading2"><h2 id="Mathematical_derivation">Mathematical derivation</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=1" title="Edit section: Mathematical derivation"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<div class="mw-heading mw-heading3"><h3 id="Problem">Problem</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=2" title="Edit section: Problem"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>In <a href="/wiki/Calculus_of_variations" title="Calculus of variations">variational</a> inference, the posterior distribution over a set of unobserved variables <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} =\{Z_{1}\dots Z_{n}\}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>=</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>&#x2026;<!-- … --></mo>
        <msub>
          <mi>Z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo fence="false" stretchy="false">}</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} =\{Z_{1}\dots Z_{n}\}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3b5a4e89a042a5d0878b3f590f8ea2d5be8d74a0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:16.002ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} =\{Z_{1}\dots Z_{n}\}}"></span> given some data <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {X} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {X} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9f75966a2f9d5672136fa9401ee1e75008f95ffd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.019ex; height:2.176ex;" alt="{\displaystyle \mathbf {X} }"></span> is approximated by a so-called <b>variational distribution</b>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} ):}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>:</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} ):}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c098c21deef6c31cbc33d18797c8ac983121f1bf" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:6.574ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} ):}"></span>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )\approx Q(\mathbf {Z} ).}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x2248;<!-- ≈ --></mo>
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )\approx Q(\mathbf {Z} ).}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2c9da53fec9fd72febf9cbd1c6554fb3ba25ebf2" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:18.172ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )\approx Q(\mathbf {Z} ).}"></span></dd></dl>
<p>The distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88749053afc1a144f8a7763a9ba2c564cb234f46" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.282ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )}"></span> is restricted to belong to a family of distributions of simpler form than <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1093996252ce78495fc6eca165bde03055ed469e" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.145ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}"></span> (e.g. a family of Gaussian distributions), selected with the intention of making <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88749053afc1a144f8a7763a9ba2c564cb234f46" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.282ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )}"></span> similar to the true posterior, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1093996252ce78495fc6eca165bde03055ed469e" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.145ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}"></span>.
</p><p>The similarity (or dissimilarity) is measured in terms of a dissimilarity function <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle d(Q;P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>d</mi>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>;</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle d(Q;P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/37257c5a3c70edaacab240d77b9409e7e7417654" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:7.643ex; height:2.843ex;" alt="{\displaystyle d(Q;P)}"></span> and hence inference is performed by selecting the distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88749053afc1a144f8a7763a9ba2c564cb234f46" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.282ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )}"></span> that minimizes <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle d(Q;P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>d</mi>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>;</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle d(Q;P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/37257c5a3c70edaacab240d77b9409e7e7417654" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:7.643ex; height:2.843ex;" alt="{\displaystyle d(Q;P)}"></span>.
</p>
<div class="mw-heading mw-heading3"><h3 id="KL_divergence">KL divergence</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=3" title="Edit section: KL divergence"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>The most common type of variational Bayes uses the <a href="/wiki/Kullback%E2%80%93Leibler_divergence" title="Kullback–Leibler divergence">Kullback–Leibler divergence</a> (KL-divergence) of <i>Q</i> from <i>P</i> as the choice of dissimilarity function.  This choice makes this minimization tractable.  The KL-divergence is defined as
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\triangleq \sum _{\mathbf {Z} }Q(\mathbf {Z} )\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} \mid \mathbf {X} )}}.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x225C;<!-- ≜ --></mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
          </mrow>
        </munder>
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>Q</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo>&#x2223;<!-- ∣ --></mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
          </mfrac>
        </mrow>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\triangleq \sum _{\mathbf {Z} }Q(\mathbf {Z} )\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} \mid \mathbf {X} )}}.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/17e7cbe23713c8146b1956a4a953eb60a89425b8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:38.805ex; height:6.843ex;" alt="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\triangleq \sum _{\mathbf {Z} }Q(\mathbf {Z} )\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} \mid \mathbf {X} )}}.}"></span></dd></dl>
<p>Note that <i>Q</i> and <i>P</i> are reversed from what one might expect.  This use of reversed KL-divergence is conceptually similar to the <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization algorithm</a>. (Using the KL-divergence in the other way produces the <a href="/wiki/Expectation_propagation" title="Expectation propagation">expectation propagation</a> algorithm.)
</p>
<div class="mw-heading mw-heading3"><h3 id="Intractability">Intractability</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=4" title="Edit section: Intractability"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Variational techniques are typically used to form an approximation for:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{P(\mathbf {X} )}}={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{\int _{\mathbf {Z} }P(\mathbf {X} ,\mathbf {Z} ')\,d\mathbf {Z} '}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo>&#x2223;<!-- ∣ --></mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo>&#x2223;<!-- ∣ --></mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <msub>
                <mo>&#x222B;<!-- ∫ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">Z</mi>
                  </mrow>
                </mrow>
              </msub>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo>,</mo>
              <msup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>&#x2032;</mo>
              </msup>
              <mo stretchy="false">)</mo>
              <mspace width="thinmathspace" />
              <mi>d</mi>
              <msup>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>&#x2032;</mo>
              </msup>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{P(\mathbf {X} )}}={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{\int _{\mathbf {Z} }P(\mathbf {X} ,\mathbf {Z} ')\,d\mathbf {Z} '}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d580617702dc7d0a4e6f8107287f1e481e5478b4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:47.069ex; height:6.843ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{P(\mathbf {X} )}}={\frac {P(\mathbf {X} \mid \mathbf {Z} )P(\mathbf {Z} )}{\int _{\mathbf {Z} }P(\mathbf {X} ,\mathbf {Z} &#039;)\,d\mathbf {Z} &#039;}}}"></span></dd></dl>
<p>The marginalization over <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b776aaf12c2da4b78ca777cb8295c2000bfd51f5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.634ex; height:2.176ex;" alt="{\displaystyle \mathbf {Z} }"></span> to calculate <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f79cd1a2596bb9ce4566be9ebc380b64ede03e4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.574ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {X} )}"></span> in the denominator is typically intractable, because, for example, the search space of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b776aaf12c2da4b78ca777cb8295c2000bfd51f5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.634ex; height:2.176ex;" alt="{\displaystyle \mathbf {Z} }"></span> is combinatorially large. Therefore, we seek an approximation, using <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )\approx P(\mathbf {Z} \mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x2248;<!-- ≈ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )\approx P(\mathbf {Z} \mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4cca38629c0343535cc9d79e04e82031a4ddabd3" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:17.525ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )\approx P(\mathbf {Z} \mid \mathbf {X} )}"></span>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Evidence_lower_bound">Evidence lower bound</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=5" title="Edit section: Evidence lower bound"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1320445320" /><div role="note" class="hatnote navigation-not-searchable">Main article: <a href="/wiki/Evidence_lower_bound" title="Evidence lower bound">Evidence lower bound</a></div>
<p>Given that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} ,\mathbf {Z} )}{P(\mathbf {X} )}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo>,</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">Z</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">X</mi>
              </mrow>
              <mo stretchy="false">)</mo>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} ,\mathbf {Z} )}{P(\mathbf {X} )}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/65dc63c3744b999c341fc0635fc325206a9bb63c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -2.671ex; width:21.322ex; height:6.509ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )={\frac {P(\mathbf {X} ,\mathbf {Z} )}{P(\mathbf {X} )}}}"></span>, the KL-divergence above can also be written as
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{array}{rl}D_{\mathrm {KL} }(Q\parallel P)&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} ,\mathbf {X} )}}+\log P(\mathbf {X} )\right]\\&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log P(\mathbf {X} )\right]\end{array}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left" rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">K</mi>
                      <mi mathvariant="normal">L</mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>Q</mi>
                <mo>&#x2225;<!-- ∥ --></mo>
                <mi>P</mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mo>=</mo>
                <munder>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                  </mrow>
                </munder>
                <mi>Q</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mi>Q</mi>
                          <mo stretchy="false">(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">Z</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <mi>P</mi>
                          <mo stretchy="false">(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">Z</mi>
                          </mrow>
                          <mo>,</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">X</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mfrac>
                    </mrow>
                    <mo>+</mo>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>P</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mo>=</mo>
                <munder>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                  </mrow>
                </munder>
                <mi>Q</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>Q</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>P</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <munder>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                  </mrow>
                </munder>
                <mi>Q</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>P</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{array}{rl}D_{\mathrm {KL} }(Q\parallel P)&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} ,\mathbf {X} )}}+\log P(\mathbf {X} )\right]\\&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log P(\mathbf {X} )\right]\end{array}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/31dbf180c8df24086d1661802b87e61b9ee08efc" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.505ex; width:75.073ex; height:8.176ex;" alt="{\displaystyle {\begin{array}{rl}D_{\mathrm {KL} }(Q\parallel P)&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log {\frac {Q(\mathbf {Z} )}{P(\mathbf {Z} ,\mathbf {X} )}}+\log P(\mathbf {X} )\right]\\&amp;=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log P(\mathbf {X} )\right]\end{array}}}"></span></dd></dl>
<p>Because <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2f79cd1a2596bb9ce4566be9ebc380b64ede03e4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.574ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {X} )}"></span> is a constant with respect to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b776aaf12c2da4b78ca777cb8295c2000bfd51f5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.634ex; height:2.176ex;" alt="{\displaystyle \mathbf {Z} }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{\mathbf {Z} }Q(\mathbf {Z} )=1}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
          </mrow>
        </munder>
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mn>1</mn>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{\mathbf {Z} }Q(\mathbf {Z} )=1}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5b82b63d51288faacb531a872414f4c7bd809812" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:13.285ex; height:5.509ex;" alt="{\displaystyle \sum _{\mathbf {Z} }Q(\mathbf {Z} )=1}"></span> because <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88749053afc1a144f8a7763a9ba2c564cb234f46" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.282ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )}"></span> is a distribution, we have
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <munder>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
          </mrow>
        </munder>
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mi>log</mi>
            <mo>&#x2061;<!-- ⁡ --></mo>
            <mi>Q</mi>
            <mo stretchy="false">(</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
            <mo stretchy="false">)</mo>
            <mo>&#x2212;<!-- − --></mo>
            <mi>log</mi>
            <mo>&#x2061;<!-- ⁡ --></mo>
            <mi>P</mi>
            <mo stretchy="false">(</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
            <mo>,</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">X</mi>
            </mrow>
            <mo stretchy="false">)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe7ea8e2d866fa0a91aaab65b66646a27ee2c1ef" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:60.966ex; height:5.509ex;" alt="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\sum _{\mathbf {Z} }Q(\mathbf {Z} )\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}"></span></dd></dl>
<p>which, according to the definition of <a href="/wiki/Expected_value" title="Expected value">expected value</a> (for a discrete <a href="/wiki/Random_variable" title="Random variable">random variable</a>), can be written as follows
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="double-struck">E</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Q</mi>
            </mrow>
          </mrow>
        </msub>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mi>log</mi>
            <mo>&#x2061;<!-- ⁡ --></mo>
            <mi>Q</mi>
            <mo stretchy="false">(</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
            <mo stretchy="false">)</mo>
            <mo>&#x2212;<!-- − --></mo>
            <mi>log</mi>
            <mo>&#x2061;<!-- ⁡ --></mo>
            <mi>P</mi>
            <mo stretchy="false">(</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">Z</mi>
            </mrow>
            <mo>,</mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="bold">X</mi>
            </mrow>
            <mo stretchy="false">)</mo>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mo>+</mo>
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a8cdf19ada48df35350f6069e8bdb467ea90fa3a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:55.145ex; height:3.009ex;" alt="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)=\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]+\log P(\mathbf {X} )}"></span></dd></dl>
<p>which can be rearranged to become
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{array}{rl}\log P(\mathbf {X} )&amp;=D_{\mathrm {KL} }(Q\parallel P)-\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]\\&amp;=D_{\mathrm {KL} }(Q\parallel P)+{\mathcal {L}}(Q)\end{array}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left" rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mi>log</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>P</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mo>=</mo>
                <msub>
                  <mi>D</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">K</mi>
                      <mi mathvariant="normal">L</mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>Q</mi>
                <mo>&#x2225;<!-- ∥ --></mo>
                <mi>P</mi>
                <mo stretchy="false">)</mo>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="double-struck">E</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Q</mi>
                    </mrow>
                  </mrow>
                </msub>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>Q</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>P</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mo>=</mo>
                <msub>
                  <mi>D</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">K</mi>
                      <mi mathvariant="normal">L</mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <mi>Q</mi>
                <mo>&#x2225;<!-- ∥ --></mo>
                <mi>P</mi>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mi>Q</mi>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{array}{rl}\log P(\mathbf {X} )&amp;=D_{\mathrm {KL} }(Q\parallel P)-\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]\\&amp;=D_{\mathrm {KL} }(Q\parallel P)+{\mathcal {L}}(Q)\end{array}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b75a2614d1b490cab91fd5a0039f5e646d9f74" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -2.671ex; width:57.574ex; height:6.509ex;" alt="{\displaystyle {\begin{array}{rl}\log P(\mathbf {X} )&amp;=D_{\mathrm {KL} }(Q\parallel P)-\mathbb {E} _{\mathbf {Q} }\left[\log Q(\mathbf {Z} )-\log P(\mathbf {Z} ,\mathbf {X} )\right]\\&amp;=D_{\mathrm {KL} }(Q\parallel P)+{\mathcal {L}}(Q)\end{array}}}"></span></dd></dl>
<p>As the <i>log-<a href="/wiki/Model_evidence" class="mw-redirect" title="Model evidence">evidence</a></i> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \log P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \log P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/960216514fcbb365f3720d23b238b30dddf0d12c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:8.933ex; height:2.843ex;" alt="{\displaystyle \log P(\mathbf {X} )}"></span> is fixed with respect to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span>, maximizing the final term <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {L}}(Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {L}}(Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b029605b9e0e2a9fdf4f96b0e88944f70bc04b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.251ex; height:2.843ex;" alt="{\displaystyle {\mathcal {L}}(Q)}"></span> minimizes the KL divergence of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span> from <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b4dc73bf40314945ff376bd363916a738548d40a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.745ex; height:2.176ex;" alt="{\displaystyle P}"></span>. By appropriate choice of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {L}}(Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {L}}(Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b029605b9e0e2a9fdf4f96b0e88944f70bc04b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.251ex; height:2.843ex;" alt="{\displaystyle {\mathcal {L}}(Q)}"></span> becomes tractable to compute and to maximize. Hence we have both an analytical approximation <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span> for the posterior <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1093996252ce78495fc6eca165bde03055ed469e" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.145ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} \mid \mathbf {X} )}"></span>, and a lower bound <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {L}}(Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {L}}(Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b029605b9e0e2a9fdf4f96b0e88944f70bc04b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.251ex; height:2.843ex;" alt="{\displaystyle {\mathcal {L}}(Q)}"></span> for the log-evidence <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \log P(\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \log P(\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/960216514fcbb365f3720d23b238b30dddf0d12c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:8.933ex; height:2.843ex;" alt="{\displaystyle \log P(\mathbf {X} )}"></span> (since the KL-divergence is non-negative).
</p><p>The lower bound <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {L}}(Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {L}}(Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b029605b9e0e2a9fdf4f96b0e88944f70bc04b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.251ex; height:2.843ex;" alt="{\displaystyle {\mathcal {L}}(Q)}"></span> is known as the (negative) <b>variational free energy</b> in analogy with <a href="/wiki/Thermodynamic_free_energy" title="Thermodynamic free energy">thermodynamic free energy</a> because it can also be expressed as a negative energy <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} _{Q}[\log P(\mathbf {Z} ,\mathbf {X} )]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} _{Q}[\log P(\mathbf {Z} ,\mathbf {X} )]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a7e43c3758a771143c7934709ad3198bf43e1ca6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:16.01ex; height:3.009ex;" alt="{\displaystyle \operatorname {E} _{Q}[\log P(\mathbf {Z} ,\mathbf {X} )]}"></span> plus the <a href="/wiki/Entropy_(information_theory)" title="Entropy (information theory)">entropy</a> of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span>. The term <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {L}}(Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {L}}(Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5b029605b9e0e2a9fdf4f96b0e88944f70bc04b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.251ex; height:2.843ex;" alt="{\displaystyle {\mathcal {L}}(Q)}"></span> is also known as <b>Evidence Lower Bound</b>, abbreviated as <a href="/wiki/Evidence_lower_bound" title="Evidence lower bound"><b>ELBO</b></a>, to emphasize that it is a lower (worst-case) bound on the log-evidence of the data.
</p>
<div class="mw-heading mw-heading3"><h3 id="Proofs">Proofs</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=6" title="Edit section: Proofs"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>By the generalized <a href="/wiki/Pythagorean_theorem" title="Pythagorean theorem">Pythagorean theorem</a> of <a href="/wiki/Bregman_divergence" title="Bregman divergence">Bregman divergence</a>, of which KL-divergence is a special case, it can be shown that:<sup id="cite&#95;ref-Tran2018&#95;1-0" class="reference"><a href="#cite_note-Tran2018-1"><span class="cite-bracket">&#91;</span>1<span class="cite-bracket">&#93;</span></a></sup><sup id="cite&#95;ref-Martin2014&#95;2-0" class="reference"><a href="#cite_note-Martin2014-2"><span class="cite-bracket">&#91;</span>2<span class="cite-bracket">&#93;</span></a></sup>
</p>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Bregman_divergence_Pythagorean.png" class="mw-file-description"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Bregman_divergence_Pythagorean.png/330px-Bregman_divergence_Pythagorean.png" decoding="async" width="300" height="141" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Bregman_divergence_Pythagorean.png/500px-Bregman_divergence_Pythagorean.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Bregman_divergence_Pythagorean.png/960px-Bregman_divergence_Pythagorean.png 2x" data-file-width="1024" data-file-height="482" /></a><figcaption>Generalized Pythagorean theorem for <a href="/wiki/Bregman_divergence" title="Bregman divergence">Bregman divergence</a><sup id="cite&#95;ref-Martin2014&#95;2-1" class="reference"><a href="#cite_note-Martin2014-2"><span class="cite-bracket">&#91;</span>2<span class="cite-bracket">&#93;</span></a></sup></figcaption></figure>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\geq D_{\mathrm {KL} }(Q\parallel Q^{*})+D_{\mathrm {KL} }(Q^{*}\parallel P),\forall Q^{*}\in {\mathcal {C}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
        <mi mathvariant="normal">&#x2200;<!-- ∀ --></mi>
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x2208;<!-- ∈ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">C</mi>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\geq D_{\mathrm {KL} }(Q\parallel Q^{*})+D_{\mathrm {KL} }(Q^{*}\parallel P),\forall Q^{*}\in {\mathcal {C}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/daf718bc8ea60db70698bbcdcae824c89bf382e8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:54.364ex; height:2.843ex;" alt="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)\geq D_{\mathrm {KL} }(Q\parallel Q^{*})+D_{\mathrm {KL} }(Q^{*}\parallel P),\forall Q^{*}\in {\mathcal {C}}}"></span></dd></dl>
<p>where  <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {C}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">C</mi>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {C}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e7b3edab7022ca9e2976651bc59c489513ee9019" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.239ex; height:2.176ex;" alt="{\displaystyle {\mathcal {C}}}"></span> is a <a href="/wiki/Convex_set" title="Convex set">convex set</a> and the equality holds if:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q=Q^{*}\triangleq \arg \min _{Q\in {\mathcal {C}}}D_{\mathrm {KL} }(Q\parallel P).}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo>=</mo>
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo>&#x225C;<!-- ≜ --></mo>
        <mi>arg</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <munder>
          <mo movablelimits="true" form="prefix">min</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>Q</mi>
            <mo>&#x2208;<!-- ∈ --></mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mrow class="MJX-TeXAtom-ORD">
                <mi class="MJX-tex-caligraphic" mathvariant="script">C</mi>
              </mrow>
            </mrow>
          </mrow>
        </munder>
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q=Q^{*}\triangleq \arg \min _{Q\in {\mathcal {C}}}D_{\mathrm {KL} }(Q\parallel P).}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/32799aa37c5fa597e8512093f38925afcf0e95e9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -2.338ex; width:31.769ex; height:4.509ex;" alt="{\displaystyle Q=Q^{*}\triangleq \arg \min _{Q\in {\mathcal {C}}}D_{\mathrm {KL} }(Q\parallel P).}"></span></dd></dl>
<p>In this case, the global minimizer <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})q^{*}(\mathbf {Z} _{2})=q^{*}(\mathbf {Z} _{2}\mid \mathbf {Z} _{1})q^{*}(\mathbf {Z} _{1}),}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})q^{*}(\mathbf {Z} _{2})=q^{*}(\mathbf {Z} _{2}\mid \mathbf {Z} _{1})q^{*}(\mathbf {Z} _{1}),}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a7b304fd4dffd4220a069db346954ba77dd24572" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:48.955ex; height:2.843ex;" alt="{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})q^{*}(\mathbf {Z} _{2})=q^{*}(\mathbf {Z} _{2}\mid \mathbf {Z} _{1})q^{*}(\mathbf {Z} _{1}),}"></span> with <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} =\{\mathbf {Z_{1}} ,\mathbf {Z_{2}} \},}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>=</mo>
        <mo fence="false" stretchy="false">{</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi mathvariant="bold">Z</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn mathvariant="bold">1</mn>
            </mrow>
          </msub>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi mathvariant="bold">Z</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn mathvariant="bold">2</mn>
            </mrow>
          </msub>
        </mrow>
        <mo fence="false" stretchy="false">}</mo>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} =\{\mathbf {Z_{1}} ,\mathbf {Z_{2}} \},}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fc80908d68e13ae65cfdef36b41e6e9f630a1bd7" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:14.361ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} =\{\mathbf {Z_{1}} ,\mathbf {Z_{2}} \},}"></span> can be found as follows:<sup id="cite&#95;ref-Tran2018&#95;1-1" class="reference"><a href="#cite_note-Tran2018-1"><span class="cite-bracket">&#91;</span>1<span class="cite-bracket">&#93;</span></a></sup>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{array}{rl}q^{*}(\mathbf {Z} _{2})&amp;={\frac {P(\mathbf {X} )}{\zeta (\mathbf {X} )}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;={\frac {1}{\zeta (\mathbf {X} )}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right),\end{array}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left" rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <msup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msup>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">Z</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>P</mi>
                      <mo stretchy="false">(</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi>&#x03B6;<!-- ζ --></mi>
                      <mo stretchy="false">(</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>P</mi>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi>exp</mi>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>D</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="normal">K</mi>
                            <mi mathvariant="normal">L</mi>
                          </mrow>
                        </mrow>
                      </msub>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>q</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mo>&#x2217;<!-- ∗ --></mo>
                        </mrow>
                      </msup>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo stretchy="false">)</mo>
                      <mo>&#x2225;<!-- ∥ --></mo>
                      <mi>P</mi>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>,</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mrow>
                      <mi>&#x03B6;<!-- ζ --></mi>
                      <mo stretchy="false">(</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mrow>
                <mi>exp</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="double-struck">E</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msup>
                      <mi>q</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2217;<!-- ∗ --></mo>
                      </mrow>
                    </msup>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msub>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mi>P</mi>
                          <mo stretchy="false">(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">Z</mi>
                          </mrow>
                          <mo>,</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">X</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <msup>
                            <mi>q</mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mo>&#x2217;<!-- ∗ --></mo>
                            </mrow>
                          </msup>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi mathvariant="bold">Z</mi>
                            </mrow>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>1</mn>
                            </mrow>
                          </msub>
                          <mo>&#x2223;<!-- ∣ --></mo>
                          <msub>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi mathvariant="bold">Z</mi>
                            </mrow>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>,</mo>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{array}{rl}q^{*}(\mathbf {Z} _{2})&amp;={\frac {P(\mathbf {X} )}{\zeta (\mathbf {X} )}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;={\frac {1}{\zeta (\mathbf {X} )}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right),\end{array}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3de32be4bdb02133e9a9c3f014de4494459f0ce8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -4.338ex; width:45.588ex; height:9.843ex;" alt="{\displaystyle {\begin{array}{rl}q^{*}(\mathbf {Z} _{2})&amp;={\frac {P(\mathbf {X} )}{\zeta (\mathbf {X} )}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;={\frac {1}{\zeta (\mathbf {X} )}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right),\end{array}}}"></span></dd></dl>
<p>in which the normalizing constant is:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{array}{rl}\zeta (\mathbf {X} )&amp;=P(\mathbf {X} )\int _{\mathbf {Z} _{2}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;=\int _{\mathbf {Z} _{2}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right).\end{array}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left" rowspacing="4pt" columnspacing="1em">
            <mtr>
              <mtd>
                <mi>&#x03B6;<!-- ζ --></mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mo>=</mo>
                <mi>P</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <msub>
                  <mo>&#x222B;<!-- ∫ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msub>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>P</mi>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi>exp</mi>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>D</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="normal">K</mi>
                            <mi mathvariant="normal">L</mi>
                          </mrow>
                        </mrow>
                      </msub>
                      <mo stretchy="false">(</mo>
                      <msup>
                        <mi>q</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mo>&#x2217;<!-- ∗ --></mo>
                        </mrow>
                      </msup>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo stretchy="false">)</mo>
                      <mo>&#x2225;<!-- ∥ --></mo>
                      <mi>P</mi>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>&#x2223;<!-- ∣ --></mo>
                      <msub>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">Z</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>,</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">X</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mo>=</mo>
                <msub>
                  <mo>&#x222B;<!-- ∫ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msub>
                  </mrow>
                </msub>
                <mi>exp</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="double-struck">E</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msup>
                      <mi>q</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2217;<!-- ∗ --></mo>
                      </mrow>
                    </msup>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">Z</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">)</mo>
                  </mrow>
                </msub>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>log</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mi>P</mi>
                          <mo stretchy="false">(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">Z</mi>
                          </mrow>
                          <mo>,</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi mathvariant="bold">X</mi>
                          </mrow>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mrow>
                          <msup>
                            <mi>q</mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mo>&#x2217;<!-- ∗ --></mo>
                            </mrow>
                          </msup>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi mathvariant="bold">Z</mi>
                            </mrow>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>1</mn>
                            </mrow>
                          </msub>
                          <mo>&#x2223;<!-- ∣ --></mo>
                          <msub>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi mathvariant="bold">Z</mi>
                            </mrow>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>.</mo>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{array}{rl}\zeta (\mathbf {X} )&amp;=P(\mathbf {X} )\int _{\mathbf {Z} _{2}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;=\int _{\mathbf {Z} _{2}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right).\end{array}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f782b665a6fa9baf3f9262553f89b90646d0da69" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -4.338ex; width:46.378ex; height:9.843ex;" alt="{\displaystyle {\begin{array}{rl}\zeta (\mathbf {X} )&amp;=P(\mathbf {X} )\int _{\mathbf {Z} _{2}}{\frac {P(\mathbf {Z} _{2}\mid \mathbf {X} )}{\exp(D_{\mathrm {KL} }(q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})\parallel P(\mathbf {Z} _{1}\mid \mathbf {Z} _{2},\mathbf {X} )))}}\\&amp;=\int _{\mathbf {Z} _{2}}\exp \mathbb {E} _{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}\left(\log {\frac {P(\mathbf {Z} ,\mathbf {X} )}{q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})}}\right).\end{array}}}"></span></dd></dl>
<p>The term <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \zeta (\mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03B6;<!-- ζ --></mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \zeta (\mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7e76b933c500ab057152484b5d86dc8e6f6e52a6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:4.924ex; height:2.843ex;" alt="{\displaystyle \zeta (\mathbf {X} )}"></span> is often called the <a href="/wiki/Model_evidence" class="mw-redirect" title="Model evidence">evidence</a> lower bound (<b>ELBO</b>) in practice, since <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {X} )\geq \zeta (\mathbf {X} )=\exp({\mathcal {L}}(Q^{*}))}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x2265;<!-- ≥ --></mo>
        <mi>&#x03B6;<!-- ζ --></mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>exp</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">L</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {X} )\geq \zeta (\mathbf {X} )=\exp({\mathcal {L}}(Q^{*}))}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9adb90c98195c0753fe4d2c5663668c34db37b4a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:28.362ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {X} )\geq \zeta (\mathbf {X} )=\exp({\mathcal {L}}(Q^{*}))}"></span>,<sup id="cite&#95;ref-Tran2018&#95;1-2" class="reference"><a href="#cite_note-Tran2018-1"><span class="cite-bracket">&#91;</span>1<span class="cite-bracket">&#93;</span></a></sup> as shown above.
</p><p>By interchanging the roles of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{1}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{1}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/325b1e03c02002bec004d9f2488f8f52394a9e9c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.688ex; height:2.509ex;" alt="{\displaystyle \mathbf {Z} _{1}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{2},}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{2},}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/55308e109fec1831ab2c6d4cfd000c2aef6ec433" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.335ex; height:2.509ex;" alt="{\displaystyle \mathbf {Z} _{2},}"></span> we can iteratively compute the approximated <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} _{1})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} _{1})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0616a50132b72995ea4cd14fbdb9144ccd4e1dfd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:6.631ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {Z} _{1})}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} _{2})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} _{2})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4febda42b3360fc5705cf395aa2d42092e78f719" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:6.631ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {Z} _{2})}"></span> of the true model's marginals <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} _{1}\mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} _{1}\mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/747dc360a08ecb050150f57992f36750f8f53dbd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:10.2ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} _{1}\mid \mathbf {X} )}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P(\mathbf {Z} _{2}\mid \mathbf {X} ),}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P(\mathbf {Z} _{2}\mid \mathbf {X} ),}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7001676a0975da012f8bd01a9db5541e6c004d11" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:10.846ex; height:2.843ex;" alt="{\displaystyle P(\mathbf {Z} _{2}\mid \mathbf {X} ),}"></span> respectively. Although this iterative scheme is guaranteed to converge monotonically,<sup id="cite&#95;ref-Tran2018&#95;1-3" class="reference"><a href="#cite_note-Tran2018-1"><span class="cite-bracket">&#91;</span>1<span class="cite-bracket">&#93;</span></a></sup> the converged <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q^{*}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q^{*}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c1785c0a77ab5a06684e8a7ac4f5e59d59ec0319" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.893ex; height:2.676ex;" alt="{\displaystyle Q^{*}}"></span> is only a local minimizer of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">K</mi>
              <mi mathvariant="normal">L</mi>
            </mrow>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D_{\mathrm {KL} }(Q\parallel P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3e7218c8dd2178621cf54e33478b6e3b15da016a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:12.308ex; height:2.843ex;" alt="{\displaystyle D_{\mathrm {KL} }(Q\parallel P)}"></span>.
</p><p>If the constrained space <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {C}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">C</mi>
          </mrow>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {C}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e7b3edab7022ca9e2976651bc59c489513ee9019" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.239ex; height:2.176ex;" alt="{\displaystyle {\mathcal {C}}}"></span> is confined within independent space, i.e. <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})=q^{*}(\mathbf {Z_{1}} ),}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <msub>
            <mi mathvariant="bold">Z</mi>
            <mrow class="MJX-TeXAtom-ORD">
              <mn mathvariant="bold">1</mn>
            </mrow>
          </msub>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})=q^{*}(\mathbf {Z_{1}} ),}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e6ddfe24dd50007693f2df773d5424b3934e1a66" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:21.756ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {Z} _{1}\mid \mathbf {Z} _{2})=q^{*}(\mathbf {Z_{1}} ),}"></span>the above iterative scheme will become the so-called mean field approximation <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1})q^{*}(\mathbf {Z} _{2}),}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>Q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1})q^{*}(\mathbf {Z} _{2}),}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bdf9163856250789fcce9403d37e8325196b5603" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:23.343ex; height:2.843ex;" alt="{\displaystyle Q^{*}(\mathbf {Z} )=q^{*}(\mathbf {Z} _{1})q^{*}(\mathbf {Z} _{2}),}"></span>as shown below.
</p>
<div class="mw-heading mw-heading2"><h2 id="Mean_field_approximation">Mean field approximation</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=7" title="Edit section: Mean field approximation"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>The variational distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/88749053afc1a144f8a7763a9ba2c564cb234f46" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.282ex; height:2.843ex;" alt="{\displaystyle Q(\mathbf {Z} )}"></span> is usually assumed to factorize over some <a href="/wiki/Partition_of_a_set" title="Partition of a set">partition</a> of the latent variables, i.e. for some partition of the latent variables <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b776aaf12c2da4b78ca777cb8295c2000bfd51f5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.634ex; height:2.176ex;" alt="{\displaystyle \mathbf {Z} }"></span> into <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{1}\dots \mathbf {Z} _{M}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>&#x2026;<!-- … --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>M</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{1}\dots \mathbf {Z} _{M}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a4c797d24283e2ad0a225cd1bf962ac5887b21a9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:9.779ex; height:2.509ex;" alt="{\displaystyle \mathbf {Z} _{1}\dots \mathbf {Z} _{M}}"></span>,
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q(\mathbf {Z} )=\prod _{i=1}^{M}q_{i}(\mathbf {Z} _{i}\mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>M</mi>
          </mrow>
        </munderover>
        <msub>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q(\mathbf {Z} )=\prod _{i=1}^{M}q_{i}(\mathbf {Z} _{i}\mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6094f9818d77c817dcb6e3ccc8168a498a0c6286" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:21.773ex; height:7.343ex;" alt="{\displaystyle Q(\mathbf {Z} )=\prod _{i=1}^{M}q_{i}(\mathbf {Z} _{i}\mid \mathbf {X} )}"></span></dd></dl>
<p>It can be shown using the <a href="/wiki/Calculus_of_variations" title="Calculus of variations">calculus of variations</a> (hence the name "variational Bayes") that the "best" distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}^{*}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}^{*}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/975a794deceb926d031d6ec155b217e4a068ae75" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.338ex; width:2.134ex; height:3.176ex;" alt="{\displaystyle q_{j}^{*}}"></span> for each of the factors <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e0d567ac2d170501680d2efa4c1d71d6a8569ef1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:1.947ex; height:2.343ex;" alt="{\displaystyle q_{j}}"></span> (in terms of the distribution minimizing the KL divergence, as described above) satisfies:<sup id="cite&#95;ref-Nguyen&#95;3-0" class="reference"><a href="#cite_note-Nguyen-3"><span class="cite-bracket">&#91;</span>3<span class="cite-bracket">&#93;</span></a></sup>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )={\frac {e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}}{\int e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}\,d\mathbf {Z} _{j}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <msup>
              <mi>e</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msubsup>
                      <mi>q</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mi>j</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2217;<!-- ∗ --></mo>
                      </mrow>
                    </msubsup>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
              </mrow>
            </msup>
            <mrow>
              <mo>&#x222B;<!-- ∫ --></mo>
              <msup>
                <mi>e</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <msub>
                    <mi mathvariant="normal">E</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <msubsup>
                        <mi>q</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mo>&#x2212;<!-- − --></mo>
                          <mi>j</mi>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mo>&#x2217;<!-- ∗ --></mo>
                        </mrow>
                      </msubsup>
                    </mrow>
                  </msub>
                  <mo>&#x2061;<!-- ⁡ --></mo>
                  <mo stretchy="false">[</mo>
                  <mi>ln</mi>
                  <mo>&#x2061;<!-- ⁡ --></mo>
                  <mi>p</mi>
                  <mo stretchy="false">(</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">Z</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">X</mi>
                  </mrow>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">]</mo>
                </mrow>
              </msup>
              <mspace width="thinmathspace" />
              <mi>d</mi>
              <msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )={\frac {e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}}{\int e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}\,d\mathbf {Z} _{j}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c433a20d83c8b317b21d3ebe5f6bdc820f564310" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.838ex; width:33.066ex; height:8.509ex;" alt="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )={\frac {e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}}{\int e^{\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}\,d\mathbf {Z} _{j}}}}"></span></dd></dl>
<p>where <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi>q</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2212;<!-- − --></mo>
                <mi>j</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2217;<!-- ∗ --></mo>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8d25b04c50785b1ac3d66bd7e1610b77bc64314d" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.505ex; width:15.587ex; height:3.509ex;" alt="{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}"></span> is the <a href="/wiki/Expected_value" title="Expected value">expectation</a> of the logarithm of the <a href="/wiki/Joint_probability" class="mw-redirect" title="Joint probability">joint probability</a> of the data and latent variables, taken with respect to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f8f2b5e5515bb7a24f643d7fcf1550f5eeb04b41" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.134ex; height:2.676ex;" alt="{\displaystyle q^{*}}"></span> over all variables not in the partition: refer to Lemma 4.1 of<sup id="cite&#95;ref-Yoon2021&#95;4-0" class="reference"><a href="#cite_note-Yoon2021-4"><span class="cite-bracket">&#91;</span>4<span class="cite-bracket">&#93;</span></a></sup> for a derivation of the distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/27f85d66607ecb5faa10f38986cb03faf9bc5096" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.338ex; width:10.443ex; height:3.343ex;" alt="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}"></span>.
</p><p>In practice, we usually work in terms of logarithms, i.e.:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi>q</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2212;<!-- − --></mo>
                <mi>j</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2217;<!-- ∗ --></mo>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>constant</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/87a270648b59bbf964ca39d81d20b7de87d50d25" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.505ex; width:42.963ex; height:3.509ex;" alt="{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}"></span></dd></dl>
<p>The constant in the above expression is related to the <a href="/wiki/Normalizing_constant" title="Normalizing constant">normalizing constant</a> (the denominator in the expression above for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}^{*}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}^{*}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/975a794deceb926d031d6ec155b217e4a068ae75" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.338ex; width:2.134ex; height:3.176ex;" alt="{\displaystyle q_{j}^{*}}"></span>) and is usually reinstated by inspection, as the rest of the expression can usually be recognized as being a known type of distribution (e.g. <a href="/wiki/Gaussian_distribution" class="mw-redirect" title="Gaussian distribution">Gaussian</a>, <a href="/wiki/Gamma_distribution" title="Gamma distribution">gamma</a>, etc.).
</p><p>Using the properties of expectations, the expression <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msubsup>
              <mi>q</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2212;<!-- − --></mo>
                <mi>j</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mo>&#x2217;<!-- ∗ --></mo>
              </mrow>
            </msubsup>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8d25b04c50785b1ac3d66bd7e1610b77bc64314d" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.505ex; width:15.587ex; height:3.509ex;" alt="{\displaystyle \operatorname {E} _{q_{-j}^{*}}[\ln p(\mathbf {Z} ,\mathbf {X} )]}"></span> can usually be simplified into a function of the fixed <a href="/wiki/Hyperparameter_(Bayesian_statistics)" title="Hyperparameter (Bayesian statistics)">hyperparameters</a> of the <a href="/wiki/Prior_distribution" class="mw-redirect" title="Prior distribution">prior distributions</a> over the latent variables and of expectations (and sometimes higher <a href="/wiki/Moment_(mathematics)" title="Moment (mathematics)">moments</a> such as the <a href="/wiki/Variance" title="Variance">variance</a>) of latent variables not in the current partition (i.e. latent variables not included in <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{j}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{j}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ffbb56db9f29c78324a4758e2dd41dc1c3c0cc1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:2.544ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} _{j}}"></span>). This creates <a href="/wiki/Circular_dependency" title="Circular dependency">circular dependencies</a> between the parameters of the distributions over variables in one partition and the expectations of variables in the other partitions.  This naturally suggests an <a href="/wiki/Iterative" class="mw-redirect" title="Iterative">iterative</a> algorithm, much like EM (the <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization algorithm</a>), in which the expectations (and possibly higher moments) of the latent variables are initialized in some fashion (perhaps randomly), and then the parameters of each distribution are computed in turn using the current values of the expectations, after which the expectation of the newly computed distribution is set appropriately according to the computed parameters. An algorithm of this sort is guaranteed to <a href="/wiki/Limit_of_a_sequence" title="Limit of a sequence">converge</a>.<sup id="cite&#95;ref-5" class="reference"><a href="#cite_note-5"><span class="cite-bracket">&#91;</span>5<span class="cite-bracket">&#93;</span></a></sup>
</p><p>In other words, for each of the partitions of variables, by simplifying the expression for the distribution over the partition's variables and examining the distribution's <a href="/wiki/Functional_dependency" title="Functional dependency">functional dependency</a> on the variables in question, the family of the distribution can usually be determined (which in turn determines the value of the constant).  The formula for the distribution's parameters will be expressed in terms of the prior distributions' hyperparameters (which are known constants), but also in terms of expectations of functions of variables in other partitions.  Usually these expectations can be simplified into functions of expectations of the variables themselves (i.e. the <a href="/wiki/Mean" title="Mean">means</a>); sometimes expectations of squared variables (which can be related to the <a href="/wiki/Variance" title="Variance">variance</a> of the variables), or expectations of higher powers (i.e. higher <a href="/wiki/Moment_(mathematics)" title="Moment (mathematics)">moments</a>) also appear. In most cases, the other variables' distributions will be from known families, and the formulas for the relevant expectations can be looked up. However, those formulas depend on those distributions' parameters, which depend in turn on the expectations about other variables. The result is that the formulas for the parameters of each variable's distributions can be expressed as a series of equations with mutual, <a href="/wiki/Nonlinear" class="mw-redirect" title="Nonlinear">nonlinear</a> dependencies among the variables. Usually, it is not possible to solve this system of equations directly. However, as described above, the dependencies suggest a simple iterative algorithm, which in most cases is guaranteed to converge. An example will make this process clearer.
</p>
<div class="mw-heading mw-heading2"><h2 id="A_duality_formula_for_variational_inference">A duality formula for variational inference</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=8" title="Edit section: A duality formula for variational inference"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:CAVI_algorithm_explain.jpg" class="mw-file-description"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/6/60/CAVI_algorithm_explain.jpg/960px-CAVI_algorithm_explain.jpg" decoding="async" width="600" height="271" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/6/60/CAVI_algorithm_explain.jpg/1200px-CAVI_algorithm_explain.jpg 2x" data-file-width="3150" data-file-height="1425" /></a><figcaption>Pictorial illustration of coordinate ascent variational inference algorithm by the duality formula<sup id="cite&#95;ref-Yoon2021&#95;4-1" class="reference"><a href="#cite_note-Yoon2021-4"><span class="cite-bracket">&#91;</span>4<span class="cite-bracket">&#93;</span></a></sup></figcaption></figure>
<p>The following theorem is referred to as a duality formula for variational inference.<sup id="cite&#95;ref-Yoon2021&#95;4-2" class="reference"><a href="#cite_note-Yoon2021-4"><span class="cite-bracket">&#91;</span>4<span class="cite-bracket">&#93;</span></a></sup> It explains some important properties of the variational distributions used in variational Bayes methods.
</p><p><span id="math&#95;3" class="reference nourlexpansion" style="font-weight:bold;">Theorem</span> Consider two <a href="/wiki/Probability_spaces" class="mw-redirect" title="Probability spaces">probability spaces</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle (\Theta ,{\mathcal {F}},P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Θ --></mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">F</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (\Theta ,{\mathcal {F}},P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a041c954bb66ac75dff73cb36f4451ec412d26ad" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.357ex; height:2.843ex;" alt="{\displaystyle (\Theta ,{\mathcal {F}},P)}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle (\Theta ,{\mathcal {F}},Q)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Θ --></mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">F</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mi>Q</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (\Theta ,{\mathcal {F}},Q)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/86c52eea005add082da3daadf597eefd76952f7a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.45ex; height:2.843ex;" alt="{\displaystyle (\Theta ,{\mathcal {F}},Q)}"></span> with <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q\ll P}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo>&#x226A;<!-- ≪ --></mo>
        <mi>P</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q\ll P}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dbaff603eec8673703c6850fb36cb4ac6508b717" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:7.198ex; height:2.509ex;" alt="{\displaystyle Q\ll P}"></span>. Assume that there is a common dominating <a href="/wiki/Probability_measure" title="Probability measure">probability measure</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b43d0ea3c9c025af1be9128e62a18fa74bedda2a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.355ex; height:2.176ex;" alt="{\displaystyle \lambda }"></span> such that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P\ll \lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
        <mo>&#x226A;<!-- ≪ --></mo>
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P\ll \lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4556d3c282180a8e3a7ad0b1caf97ce75ff9ecda" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:6.715ex; height:2.176ex;" alt="{\displaystyle P\ll \lambda }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q\ll \lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
        <mo>&#x226A;<!-- ≪ --></mo>
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q\ll \lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4a981d0f9292cace238801c1c3f89d5289a4874f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:6.808ex; height:2.509ex;" alt="{\displaystyle Q\ll \lambda }"></span>. Let <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle h}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>h</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle h}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b26be3e694314bc90c3215047e4a2010c6ee184a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.339ex; height:2.176ex;" alt="{\displaystyle h}"></span> denote any real-valued <a href="/wiki/Random_variable" title="Random variable">random variable</a> on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle (\Theta ,{\mathcal {F}},P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mo stretchy="false">(</mo>
        <mi mathvariant="normal">&#x0398;<!-- Θ --></mi>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">F</mi>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle (\Theta ,{\mathcal {F}},P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a041c954bb66ac75dff73cb36f4451ec412d26ad" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.357ex; height:2.843ex;" alt="{\displaystyle (\Theta ,{\mathcal {F}},P)}"></span> that satisfies <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle h\in L_{1}(P)}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>h</mi>
        <mo>&#x2208;<!-- ∈ --></mo>
        <msub>
          <mi>L</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle h\in L_{1}(P)}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f8525ea64ffd546a49ea8df4605af7adfee57c0f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:10.371ex; height:2.843ex;" alt="{\displaystyle h\in L_{1}(P)}"></span>. Then the following equality holds
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \log E_{P}[\exp h]={\text{sup}}_{Q\ll P}\{E_{Q}[h]-D_{\text{KL}}(Q\parallel P)\}.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>log</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msub>
          <mi>E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>P</mi>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>exp</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>h</mi>
        <mo stretchy="false">]</mo>
        <mo>=</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mtext>sup</mtext>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>Q</mi>
            <mo>&#x226A;<!-- ≪ --></mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo stretchy="false">[</mo>
        <mi>h</mi>
        <mo stretchy="false">]</mo>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mi>D</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mtext>KL</mtext>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <mi>Q</mi>
        <mo>&#x2225;<!-- ∥ --></mo>
        <mi>P</mi>
        <mo stretchy="false">)</mo>
        <mo fence="false" stretchy="false">}</mo>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \log E_{P}[\exp h]={\text{sup}}_{Q\ll P}\{E_{Q}[h]-D_{\text{KL}}(Q\parallel P)\}.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6b77d97ef624d72b613687f5ba1dae28f355ea34" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.171ex; width:48.122ex; height:3.176ex;" alt="{\displaystyle \log E_{P}[\exp h]={\text{sup}}_{Q\ll P}\{E_{Q}[h]-D_{\text{KL}}(Q\parallel P)\}.}"></span></dd></dl>
<p>Further, the supremum on the right-hand side is attained <a href="/wiki/If_and_only_if" title="If and only if">if and only if</a> it holds
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\frac {q(\theta )}{p(\theta )}}={\frac {\exp h(\theta )}{E_{P}[\exp h]}},}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>q</mi>
              <mo stretchy="false">(</mo>
              <mi>&#x03B8;<!-- θ --></mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <mi>p</mi>
              <mo stretchy="false">(</mo>
              <mi>&#x03B8;<!-- θ --></mi>
              <mo stretchy="false">)</mo>
            </mrow>
          </mfrac>
        </mrow>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mrow>
              <mi>exp</mi>
              <mo>&#x2061;<!-- ⁡ --></mo>
              <mi>h</mi>
              <mo stretchy="false">(</mo>
              <mi>&#x03B8;<!-- θ --></mi>
              <mo stretchy="false">)</mo>
            </mrow>
            <mrow>
              <msub>
                <mi>E</mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>P</mi>
                </mrow>
              </msub>
              <mo stretchy="false">[</mo>
              <mi>exp</mi>
              <mo>&#x2061;<!-- ⁡ --></mo>
              <mi>h</mi>
              <mo stretchy="false">]</mo>
            </mrow>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\frac {q(\theta )}{p(\theta )}}={\frac {\exp h(\theta )}{E_{P}[\exp h]}},}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/3aa6d2bde96aa9ae886413e7889fd4496dbe710c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -2.671ex; width:19.241ex; height:6.509ex;" alt="{\displaystyle {\frac {q(\theta )}{p(\theta )}}={\frac {\exp h(\theta )}{E_{P}[\exp h]}},}"></span></dd></dl>
<p><a href="/wiki/Almost_surely" title="Almost surely">almost surely</a> with respect to probability measure <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span>, where <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle p(\theta )=dP/d\lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03B8;<!-- θ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>d</mi>
        <mi>P</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo>/</mo>
        </mrow>
        <mi>d</mi>
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle p(\theta )=dP/d\lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d18cc724b4408221755e1668fe4fb5033790ce34" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:13.952ex; height:2.843ex;" alt="{\displaystyle p(\theta )=dP/d\lambda }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\theta )=dQ/d\lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03B8;<!-- θ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>d</mi>
        <mi>Q</mi>
        <mrow class="MJX-TeXAtom-ORD">
          <mo>/</mo>
        </mrow>
        <mi>d</mi>
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\theta )=dQ/d\lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/05dad841d2f927def2e7f4720590e2b3cb9ccd75" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:13.856ex; height:2.843ex;" alt="{\displaystyle q(\theta )=dQ/d\lambda }"></span> denote the Radon–Nikodym derivatives of the probability measures <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle P}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>P</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle P}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b4dc73bf40314945ff376bd363916a738548d40a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.745ex; height:2.176ex;" alt="{\displaystyle P}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle Q}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>Q</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle Q}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8752c7023b4b3286800fe3238271bbca681219ed" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:1.838ex; height:2.509ex;" alt="{\displaystyle Q}"></span> with respect to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BB;<!-- λ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b43d0ea3c9c025af1be9128e62a18fa74bedda2a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.355ex; height:2.176ex;" alt="{\displaystyle \lambda }"></span>, respectively.
</p>
<div class="mw-heading mw-heading2"><h2 id="A_basic_example">A basic example</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=9" title="Edit section: A basic example"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Consider a simple non-hierarchical Bayesian model consisting of a set of <a href="/wiki/Independent_identically_distributed" class="mw-redirect" title="Independent identically distributed">i.i.d.</a> observations from a <a href="/wiki/Gaussian_distribution" class="mw-redirect" title="Gaussian distribution">Gaussian distribution</a>, with unknown <a href="/wiki/Mean" title="Mean">mean</a> and <a href="/wiki/Variance" title="Variance">variance</a>.<sup id="cite&#95;ref-bishop&#95;6-0" class="reference"><a href="#cite_note-bishop-6"><span class="cite-bracket">&#91;</span>6<span class="cite-bracket">&#93;</span></a></sup> In the following, we work through this model in great detail to illustrate the workings of the variational Bayes method.
</p><p>For mathematical convenience, in the following example we work in terms of the <a href="/wiki/Precision_(statistics)" title="Precision (statistics)">precision</a> — i.e. the reciprocal of the variance (or in a multivariate Gaussian, the inverse of the <a href="/wiki/Covariance_matrix" title="Covariance matrix">covariance matrix</a>) — rather than the variance itself.  (From a theoretical standpoint, precision and variance are equivalent since there is a <a href="/wiki/One-to-one_correspondence" class="mw-redirect" title="One-to-one correspondence">one-to-one correspondence</a> between the two.)
</p>
<div class="mw-heading mw-heading3"><h3 id="The_mathematical_model">The mathematical model</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=10" title="Edit section: The mathematical model"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>We place <a href="/wiki/Conjugate_prior" title="Conjugate prior">conjugate prior</a> distributions on the unknown mean <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and precision <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \tau }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C4;<!-- τ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \tau }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/38a7dcde9730ef0853809fefc18d88771f95206c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.202ex; height:1.676ex;" alt="{\displaystyle \tau }"></span>, i.e. the mean also follows a Gaussian distribution while the precision follows a <a href="/wiki/Gamma_distribution" title="Gamma distribution">gamma distribution</a>.  In other words:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\tau &amp;\sim \operatorname {Gamma} (a_{0},b_{0})\\\mu |\tau &amp;\sim {\mathcal {N}}(\mu _{0},(\lambda _{0}\tau )^{-1})\\\{x_{1},\dots ,x_{N}\}&amp;\sim {\mathcal {N}}(\mu ,\tau ^{-1})\\N&amp;={\text{number of data points}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>&#x03C4;<!-- τ --></mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mi>Gamma</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>&#x03BC;<!-- μ --></mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mi>&#x03C4;<!-- τ --></mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mi>&#x03C4;<!-- τ --></mi>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mo fence="false" stretchy="false">{</mo>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <mo>&#x2026;<!-- … --></mo>
                <mo>,</mo>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo fence="false" stretchy="false">}</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>,</mo>
                <msup>
                  <mi>&#x03C4;<!-- τ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>N</mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>number of data points</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\tau &amp;\sim \operatorname {Gamma} (a_{0},b_{0})\\\mu |\tau &amp;\sim {\mathcal {N}}(\mu _{0},(\lambda _{0}\tau )^{-1})\\\{x_{1},\dots ,x_{N}\}&amp;\sim {\mathcal {N}}(\mu ,\tau ^{-1})\\N&amp;={\text{number of data points}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/56c45767b9084c40aa723534694b01a544a07bdf" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -5.671ex; width:38.869ex; height:12.509ex;" alt="{\displaystyle {\begin{aligned}\tau &amp;\sim \operatorname {Gamma} (a_{0},b_{0})\\\mu |\tau &amp;\sim {\mathcal {N}}(\mu _{0},(\lambda _{0}\tau )^{-1})\\\{x_{1},\dots ,x_{N}\}&amp;\sim {\mathcal {N}}(\mu ,\tau ^{-1})\\N&amp;={\text{number of data points}}\end{aligned}}}"></span></dd></dl>
<p>The <a href="/wiki/Hyperparameter_(Bayesian_statistics)" title="Hyperparameter (Bayesian statistics)">hyperparameters</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu _{0},\lambda _{0},a_{0}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BC;<!-- μ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>&#x03BB;<!-- λ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu _{0},\lambda _{0},a_{0}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dd3920a9d8638ba27a0859c5b7830f7d78d41b65" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.217ex; height:2.676ex;" alt="{\displaystyle \mu _{0},\lambda _{0},a_{0}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b_{0}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>b</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b_{0}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9e425056f502ca07b103ffbf6ac4720e0f8a01f0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.052ex; height:2.509ex;" alt="{\displaystyle b_{0}}"></span> in the prior distributions are fixed, given values.  They can be set to small positive numbers to give broad prior distributions indicating ignorance about the prior distributions of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \tau }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C4;<!-- τ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \tau }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/38a7dcde9730ef0853809fefc18d88771f95206c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.202ex; height:1.676ex;" alt="{\displaystyle \tau }"></span>.
</p><p>We are given <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>N</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f5e3890c981ae85503089652feb48b191b57aae3" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.064ex; height:2.176ex;" alt="{\displaystyle N}"></span> data points <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {X} =\{x_{1},\ldots ,x_{N}\}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>=</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo fence="false" stretchy="false">}</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {X} =\{x_{1},\ldots ,x_{N}\}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/658770c7e7e8c01fde78df19427112315ff35fba" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:18.026ex; height:2.843ex;" alt="{\displaystyle \mathbf {X} =\{x_{1},\ldots ,x_{N}\}}"></span> and our goal is to infer the <a href="/wiki/Posterior_distribution" class="mw-redirect" title="Posterior distribution">posterior distribution</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\mu ,\tau )=p(\mu ,\tau \mid x_{1},\ldots ,x_{N})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>,</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>,</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\mu ,\tau )=p(\mu ,\tau \mid x_{1},\ldots ,x_{N})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/43d30e0518d9cd59015f1d49ca179c2f3b087234" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:28.752ex; height:2.843ex;" alt="{\displaystyle q(\mu ,\tau )=p(\mu ,\tau \mid x_{1},\ldots ,x_{N})}"></span> of the parameters <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \tau .}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C4;<!-- τ --></mi>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \tau .}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/871bb01391136d3551c8ea59059e106be2a403cd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.849ex; height:1.676ex;" alt="{\displaystyle \tau .}"></span>
</p>
<div class="mw-heading mw-heading3"><h3 id="The_joint_probability">The joint probability</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=11" title="Edit section: The joint probability"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>The <a href="/wiki/Joint_probability" class="mw-redirect" title="Joint probability">joint probability</a> of all variables can be rewritten as
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle p(\mathbf {X} ,\mu ,\tau )=p(\mathbf {X} \mid \mu ,\tau )p(\mu \mid \tau )p(\tau )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>,</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>,</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>,</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle p(\mathbf {X} ,\mu ,\tau )=p(\mathbf {X} \mid \mu ,\tau )p(\mu \mid \tau )p(\tau )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2a477fd72d63519fde4f0369cfe9f171bc385df8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:35.131ex; height:2.843ex;" alt="{\displaystyle p(\mathbf {X} ,\mu ,\tau )=p(\mathbf {X} \mid \mu ,\tau )p(\mu \mid \tau )p(\tau )}"></span></dd></dl>
<p>where the individual factors are
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mu ,\tau )&amp;=\prod _{n=1}^{N}{\mathcal {N}}(x_{n}\mid \mu ,\tau ^{-1})\\p(\mu \mid \tau )&amp;={\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\\p(\tau )&amp;=\operatorname {Gamma} (\tau \mid a_{0},b_{0})\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>,</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>,</mo>
                <msup>
                  <mi>&#x03C4;<!-- τ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>,</mo>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>1</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mi>Gamma</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mu ,\tau )&amp;=\prod _{n=1}^{N}{\mathcal {N}}(x_{n}\mid \mu ,\tau ^{-1})\\p(\mu \mid \tau )&amp;={\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\\p(\tau )&amp;=\operatorname {Gamma} (\tau \mid a_{0},b_{0})\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8e8f6901803e5dc60aca07db4faf4dcae3d9fd13" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -6.505ex; width:33.797ex; height:14.176ex;" alt="{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mu ,\tau )&amp;=\prod _{n=1}^{N}{\mathcal {N}}(x_{n}\mid \mu ,\tau ^{-1})\\p(\mu \mid \tau )&amp;={\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\\p(\tau )&amp;=\operatorname {Gamma} (\tau \mid a_{0},b_{0})\end{aligned}}}"></span></dd></dl>
<p>where
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}{\mathcal {N}}(x\mid \mu ,\sigma ^{2})&amp;={\frac {1}{\sqrt {2\pi \sigma ^{2}}}}e^{\frac {-(x-\mu )^{2}}{2\sigma ^{2}}}\\\operatorname {Gamma} (\tau \mid a,b)&amp;={\frac {1}{\Gamma (a)}}b^{a}\tau ^{a-1}e^{-b\tau }\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mi>x</mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>,</mo>
                <msup>
                  <mi>&#x03C3;<!-- σ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <msqrt>
                      <mn>2</mn>
                      <mi>&#x03C0;<!-- π --></mi>
                      <msup>
                        <mi>&#x03C3;<!-- σ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>2</mn>
                        </mrow>
                      </msup>
                    </msqrt>
                  </mfrac>
                </mrow>
                <msup>
                  <mi>e</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mfrac>
                      <mrow>
                        <mo>&#x2212;<!-- − --></mo>
                        <mo stretchy="false">(</mo>
                        <mi>x</mi>
                        <mo>&#x2212;<!-- − --></mo>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <msup>
                          <mo stretchy="false">)</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mrow>
                        <mn>2</mn>
                        <msup>
                          <mi>&#x03C3;<!-- σ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                      </mrow>
                    </mfrac>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>Gamma</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>a</mi>
                <mo>,</mo>
                <mi>b</mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mrow>
                      <mi mathvariant="normal">&#x0393;<!-- Γ --></mi>
                      <mo stretchy="false">(</mo>
                      <mi>a</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mrow>
                <msup>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>a</mi>
                  </mrow>
                </msup>
                <msup>
                  <mi>&#x03C4;<!-- τ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>a</mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <msup>
                  <mi>e</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>b</mi>
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}{\mathcal {N}}(x\mid \mu ,\sigma ^{2})&amp;={\frac {1}{\sqrt {2\pi \sigma ^{2}}}}e^{\frac {-(x-\mu )^{2}}{2\sigma ^{2}}}\\\operatorname {Gamma} (\tau \mid a,b)&amp;={\frac {1}{\Gamma (a)}}b^{a}\tau ^{a-1}e^{-b\tau }\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/17af5ba66373887df38fdd12e47f4a9edc751d2d" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -6.171ex; width:36.118ex; height:13.509ex;" alt="{\displaystyle {\begin{aligned}{\mathcal {N}}(x\mid \mu ,\sigma ^{2})&amp;={\frac {1}{\sqrt {2\pi \sigma ^{2}}}}e^{\frac {-(x-\mu )^{2}}{2\sigma ^{2}}}\\\operatorname {Gamma} (\tau \mid a,b)&amp;={\frac {1}{\Gamma (a)}}b^{a}\tau ^{a-1}e^{-b\tau }\end{aligned}}}"></span></dd></dl>
<div class="mw-heading mw-heading3"><h3 id="Factorized_approximation">Factorized approximation</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=12" title="Edit section: Factorized approximation"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Assume that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\mu ,\tau )=q(\mu )q(\tau )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo>,</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo stretchy="false">)</mo>
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\mu ,\tau )=q(\mu )q(\tau )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6c28f5e2b2d3b9847accf422004216bad09d9a9f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:17.976ex; height:2.843ex;" alt="{\displaystyle q(\mu ,\tau )=q(\mu )q(\tau )}"></span>, i.e. that the posterior distribution factorizes into independent factors for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \tau }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03C4;<!-- τ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \tau }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/38a7dcde9730ef0853809fefc18d88771f95206c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.202ex; height:1.676ex;" alt="{\displaystyle \tau }"></span>.  This type of assumption underlies the variational Bayesian method.  The true posterior distribution does not in fact factor this way (in fact, in this simple case, it is known to be a <a href="/wiki/Gaussian-gamma_distribution" class="mw-redirect" title="Gaussian-gamma distribution">Gaussian-gamma distribution</a>), and hence the result we obtain will be an approximation.
</p>
<div class="mw-heading mw-heading3"><h3 id="Derivation_of_q(μ)"><span id="Derivation_of_q.28.CE.BC.29"></span>Derivation of <span class="texhtml"><i>q</i>(<i>&#956;</i>)</span></h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=13" title="Edit section: Derivation of q(μ)"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Then
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )+\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\mu \mid \tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\mathcal {N}}\left(x_{n}\mid \mu ,\tau ^{-1}\right)\right]+\operatorname {E} _{\tau }\left[\ln {\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\sqrt {\frac {\tau }{2\pi }}}e^{-{\frac {(x_{n}-\mu )^{2}\tau }{2}}}\right]+\operatorname {E} _{\tau }\left[\ln {\sqrt {\frac {\lambda _{0}\tau }{2\pi }}}e^{-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}\left({\frac {1}{2}}(\ln \tau -\ln 2\pi )-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right)\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}{\frac {1}{2}}(\ln \tau -\ln 2\pi )\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>,</mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                    <mo>+</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                    <mo>+</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <mi>C</mi>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">X</mi>
                    </mrow>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>,</mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>p</mi>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <mi>C</mi>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <munderover>
                      <mo>&#x220F;<!-- ∏ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                      </mrow>
                    </mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                        <mo>&#x2223;<!-- ∣ --></mo>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mo>,</mo>
                        <msup>
                          <mi>&#x03C4;<!-- τ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>&#x2212;<!-- − --></mo>
                            <mn>1</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                      </mrow>
                    </mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mo>&#x2223;<!-- ∣ --></mo>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>,</mo>
                        <mo stretchy="false">(</mo>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mi>&#x03C4;<!-- τ --></mi>
                        <msup>
                          <mo stretchy="false">)</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>&#x2212;<!-- − --></mo>
                            <mn>1</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <munderover>
                      <mo>&#x220F;<!-- ∏ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mrow class="MJX-TeXAtom-ORD">
                      <msqrt>
                        <mfrac>
                          <mi>&#x03C4;<!-- τ --></mi>
                          <mrow>
                            <mn>2</mn>
                            <mi>&#x03C0;<!-- π --></mi>
                          </mrow>
                        </mfrac>
                      </msqrt>
                    </mrow>
                    <msup>
                      <mi>e</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mfrac>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <msub>
                                <mi>x</mi>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mi>n</mi>
                                </mrow>
                              </msub>
                              <mo>&#x2212;<!-- − --></mo>
                              <mi>&#x03BC;<!-- μ --></mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mi>&#x03C4;<!-- τ --></mi>
                            </mrow>
                            <mn>2</mn>
                          </mfrac>
                        </mrow>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <msqrt>
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>&#x03BB;<!-- λ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <mi>&#x03C4;<!-- τ --></mi>
                          </mrow>
                          <mrow>
                            <mn>2</mn>
                            <mi>&#x03C0;<!-- π --></mi>
                          </mrow>
                        </mfrac>
                      </msqrt>
                    </mrow>
                    <msup>
                      <mi>e</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mfrac>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mi>&#x03BC;<!-- μ --></mi>
                              <mo>&#x2212;<!-- − --></mo>
                              <msub>
                                <mi>&#x03BC;<!-- μ --></mi>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mn>0</mn>
                                </mrow>
                              </msub>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <msub>
                                <mi>&#x03BB;<!-- λ --></mi>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mn>0</mn>
                                </mrow>
                              </msub>
                              <mi>&#x03C4;<!-- τ --></mi>
                            </mrow>
                            <mn>2</mn>
                          </mfrac>
                        </mrow>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mfrac>
                            <mn>1</mn>
                            <mn>2</mn>
                          </mfrac>
                        </mrow>
                        <mo stretchy="false">(</mo>
                        <mi>ln</mi>
                        <mo>&#x2061;<!-- ⁡ --></mo>
                        <mi>&#x03C4;<!-- τ --></mi>
                        <mo>&#x2212;<!-- − --></mo>
                        <mi>ln</mi>
                        <mo>&#x2061;<!-- ⁡ --></mo>
                        <mn>2</mn>
                        <mi>&#x03C0;<!-- π --></mi>
                        <mo stretchy="false">)</mo>
                        <mo>&#x2212;<!-- − --></mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mfrac>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <msub>
                                <mi>x</mi>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mi>n</mi>
                                </mrow>
                              </msub>
                              <mo>&#x2212;<!-- − --></mo>
                              <mi>&#x03BC;<!-- μ --></mi>
                              <msup>
                                <mo stretchy="false">)</mo>
                                <mrow class="MJX-TeXAtom-ORD">
                                  <mn>2</mn>
                                </mrow>
                              </msup>
                              <mi>&#x03C4;<!-- τ --></mi>
                            </mrow>
                            <mn>2</mn>
                          </mfrac>
                        </mrow>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mn>1</mn>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mn>2</mn>
                    <mi>&#x03C0;<!-- π --></mi>
                    <mo stretchy="false">)</mo>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mo>&#x2212;<!-- − --></mo>
                          <msub>
                            <mi>&#x03BC;<!-- μ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <msup>
                            <mo stretchy="false">)</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msup>
                          <msub>
                            <mi>&#x03BB;<!-- λ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>x</mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi>n</mi>
                            </mrow>
                          </msub>
                          <mo>&#x2212;<!-- − --></mo>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <msup>
                            <mo stretchy="false">)</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msup>
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mo>&#x2212;<!-- − --></mo>
                          <msub>
                            <mi>&#x03BC;<!-- μ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <msup>
                            <mo stretchy="false">)</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msup>
                          <msub>
                            <mi>&#x03BB;<!-- λ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mn>1</mn>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mn>2</mn>
                    <mi>&#x03C0;<!-- π --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mn>1</mn>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mn>2</mn>
                    <mi>&#x03C0;<!-- π --></mi>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <msub>
                            <mi>x</mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mi>n</mi>
                            </mrow>
                          </msub>
                          <mo>&#x2212;<!-- − --></mo>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <msup>
                            <mo stretchy="false">)</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msup>
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mo>&#x2212;<!-- − --></mo>
                          <msub>
                            <mi>&#x03BC;<!-- μ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <msup>
                            <mo stretchy="false">)</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>2</mn>
                            </mrow>
                          </msup>
                          <msub>
                            <mi>&#x03BB;<!-- λ --></mi>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mn>0</mn>
                            </mrow>
                          </msub>
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )+\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\mu \mid \tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\mathcal {N}}\left(x_{n}\mid \mu ,\tau ^{-1}\right)\right]+\operatorname {E} _{\tau }\left[\ln {\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\sqrt {\frac {\tau }{2\pi }}}e^{-{\frac {(x_{n}-\mu )^{2}\tau }{2}}}\right]+\operatorname {E} _{\tau }\left[\ln {\sqrt {\frac {\lambda _{0}\tau }{2\pi }}}e^{-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}\left({\frac {1}{2}}(\ln \tau -\ln 2\pi )-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right)\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}{\frac {1}{2}}(\ln \tau -\ln 2\pi )\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c64dbf7b78ed109532c4258d2f03ed35181be164" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -25.505ex; width:121.345ex; height:52.176ex;" alt="{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )+\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln p(\mathbf {X} \mid \mu ,\tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\mu \mid \tau )\right]+\operatorname {E} _{\tau }\left[\ln p(\tau )\right]+C\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\mathcal {N}}\left(x_{n}\mid \mu ,\tau ^{-1}\right)\right]+\operatorname {E} _{\tau }\left[\ln {\mathcal {N}}\left(\mu \mid \mu _{0},(\lambda _{0}\tau )^{-1}\right)\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\ln \prod _{n=1}^{N}{\sqrt {\frac {\tau }{2\pi }}}e^{-{\frac {(x_{n}-\mu )^{2}\tau }{2}}}\right]+\operatorname {E} _{\tau }\left[\ln {\sqrt {\frac {\lambda _{0}\tau }{2\pi }}}e^{-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}\left({\frac {1}{2}}(\ln \tau -\ln 2\pi )-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right)\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}{\frac {1}{2}}(\ln \tau -\ln 2\pi )\right]+\operatorname {E} _{\tau }\left[{\frac {1}{2}}(\ln \lambda _{0}+\ln \tau -\ln 2\pi )\right]+C_{2}\\&amp;=\operatorname {E} _{\tau }\left[\sum _{n=1}^{N}-{\frac {(x_{n}-\mu )^{2}\tau }{2}}\right]+\operatorname {E} _{\tau }\left[-{\frac {(\mu -\mu _{0})^{2}\lambda _{0}\tau }{2}}\right]+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\end{aligned}}}"></span></dd></dl>
<p>In the above derivation, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle C}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>C</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle C}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4fc55753007cd3c18576f7933f6f089196732029" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.766ex; height:2.176ex;" alt="{\displaystyle C}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle C_{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>C</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle C_{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7ec545f7870665e1028b7492746848d149878808" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.716ex; height:2.509ex;" alt="{\displaystyle C_{2}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle C_{3}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>C</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>3</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle C_{3}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/66e9abeb5057b7afbf88e3169101849354f13c65" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.716ex; height:2.509ex;" alt="{\displaystyle C_{3}}"></span> refer to values that are constant with respect to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span>.  Note that the term <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} _{\tau }[\ln p(\tau )]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03C4;<!-- τ --></mi>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} _{\tau }[\ln p(\tau )]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ccf212e8b1c0bdaf7c00735ff771c5f117572089" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:10.466ex; height:2.843ex;" alt="{\displaystyle \operatorname {E} _{\tau }[\ln p(\tau )]}"></span> is not a function of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and will have the same value regardless of the value of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span>.  Hence in line 3 we can absorb it into the <a href="/wiki/Constant_term" title="Constant term">constant term</a> at the end.  We do the same thing in line 7.
</p><p>The last line is simply a quadratic polynomial in <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span>.  Since this is the logarithm of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{\mu }^{*}(\mu )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{\mu }^{*}(\mu )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/19d118ecdb4a6016ad4c038245ffdd70634af87a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:5.471ex; height:3.009ex;" alt="{\displaystyle q_{\mu }^{*}(\mu )}"></span>, we can see that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{\mu }^{*}(\mu )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>&#x03BC;<!-- μ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{\mu }^{*}(\mu )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/19d118ecdb4a6016ad4c038245ffdd70634af87a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:5.471ex; height:3.009ex;" alt="{\displaystyle q_{\mu }^{*}(\mu )}"></span> itself is a <a href="/wiki/Gaussian_distribution" class="mw-redirect" title="Gaussian distribution">Gaussian distribution</a>.
</p><p>With a certain amount of tedious math (expanding the squares inside of the braces, separating out and grouping the terms involving <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu ^{2}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>&#x03BC;<!-- μ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu ^{2}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/155c5b5630673f7c1e819577a3ddf1f45cd6cfc1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:2.456ex; height:3.176ex;" alt="{\displaystyle \mu ^{2}}"></span> and <a href="/wiki/Completing_the_square" title="Completing the square">completing the square</a> over <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>&#x03BC;<!-- μ --></mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9fd47b2a39f7a7856952afec1f1db72c67af6161" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:1.402ex; height:2.176ex;" alt="{\displaystyle \mu }"></span>), we can derive the parameters of the Gaussian distribution:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}^{2}-2x_{n}\mu +\mu ^{2})+\lambda _{0}(\mu ^{2}-2\mu _{0}\mu +\mu _{0}^{2})\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\left(\sum _{n=1}^{N}x_{n}^{2}\right)-2\left(\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}\mu ^{2}\right)+\lambda _{0}\mu ^{2}-2\lambda _{0}\mu _{0}\mu +\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)(\lambda _{0}+N)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu \right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}-\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{5}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right\}+C_{5}\\&amp;=-{\frac {1}{2}}(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}+C_{5}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msubsup>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo stretchy="false">)</mo>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>3</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>4</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>&#x03BB;<!-- λ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>&#x03BC;<!-- μ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <munderover>
                              <mo>&#x2211;<!-- ∑ --></mo>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>n</mi>
                                <mo>=</mo>
                                <mn>1</mn>
                              </mrow>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>N</mi>
                              </mrow>
                            </munderover>
                            <msub>
                              <mi>x</mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>n</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <mrow>
                            <msub>
                              <mi>&#x03BB;<!-- λ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <mi>N</mi>
                          </mrow>
                        </mfrac>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>4</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>2</mn>
                        <mrow>
                          <mo>(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>&#x03BC;<!-- μ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <munderover>
                                  <mo>&#x2211;<!-- ∑ --></mo>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>N</mi>
                                  </mrow>
                                </munderover>
                                <msub>
                                  <mi>x</mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <mi>N</mi>
                              </mrow>
                            </mfrac>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mi>&#x03BC;<!-- μ --></mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>4</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>2</mn>
                        <mrow>
                          <mo>(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>&#x03BC;<!-- μ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <munderover>
                                  <mo>&#x2211;<!-- ∑ --></mo>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>N</mi>
                                  </mrow>
                                </munderover>
                                <msub>
                                  <mi>x</mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <mi>N</mi>
                              </mrow>
                            </mfrac>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mo>+</mo>
                        <msup>
                          <mrow>
                            <mo>(</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mfrac>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <msub>
                                    <mi>&#x03BC;<!-- μ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <munderover>
                                    <mo>&#x2211;<!-- ∑ --></mo>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                      <mo>=</mo>
                                      <mn>1</mn>
                                    </mrow>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>N</mi>
                                    </mrow>
                                  </munderover>
                                  <msub>
                                    <mi>x</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <mi>N</mi>
                                </mrow>
                              </mfrac>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                        <mo>&#x2212;<!-- − --></mo>
                        <msup>
                          <mrow>
                            <mo>(</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mfrac>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <msub>
                                    <mi>&#x03BC;<!-- μ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <munderover>
                                    <mo>&#x2211;<!-- ∑ --></mo>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                      <mo>=</mo>
                                      <mn>1</mn>
                                    </mrow>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>N</mi>
                                    </mrow>
                                  </munderover>
                                  <msub>
                                    <mi>x</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <mi>N</mi>
                                </mrow>
                              </mfrac>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>4</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>2</mn>
                        <mrow>
                          <mo>(</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>&#x03BC;<!-- μ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <munderover>
                                  <mo>&#x2211;<!-- ∑ --></mo>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>N</mi>
                                  </mrow>
                                </munderover>
                                <msub>
                                  <mi>x</mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <mi>N</mi>
                              </mrow>
                            </mfrac>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mo>+</mo>
                        <msup>
                          <mrow>
                            <mo>(</mo>
                            <mrow class="MJX-TeXAtom-ORD">
                              <mfrac>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <msub>
                                    <mi>&#x03BC;<!-- μ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <munderover>
                                    <mo>&#x2211;<!-- ∑ --></mo>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                      <mo>=</mo>
                                      <mn>1</mn>
                                    </mrow>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>N</mi>
                                    </mrow>
                                  </munderover>
                                  <msub>
                                    <mi>x</mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mi>n</mi>
                                    </mrow>
                                  </msub>
                                </mrow>
                                <mrow>
                                  <msub>
                                    <mi>&#x03BB;<!-- λ --></mi>
                                    <mrow class="MJX-TeXAtom-ORD">
                                      <mn>0</mn>
                                    </mrow>
                                  </msub>
                                  <mo>+</mo>
                                  <mi>N</mi>
                                </mrow>
                              </mfrac>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>5</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi mathvariant="normal">E</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03C4;<!-- τ --></mi>
                        </mrow>
                      </msub>
                      <mo>&#x2061;<!-- ⁡ --></mo>
                      <mo stretchy="false">[</mo>
                      <mi>&#x03C4;<!-- τ --></mi>
                      <mo stretchy="false">]</mo>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mo>&#x2212;<!-- − --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mfrac>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <msub>
                                  <mi>&#x03BC;<!-- μ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <munderover>
                                  <mo>&#x2211;<!-- ∑ --></mo>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                  </mrow>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>N</mi>
                                  </mrow>
                                </munderover>
                                <msub>
                                  <mi>x</mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mi>n</mi>
                                  </mrow>
                                </msub>
                              </mrow>
                              <mrow>
                                <msub>
                                  <mi>&#x03BB;<!-- λ --></mi>
                                  <mrow class="MJX-TeXAtom-ORD">
                                    <mn>0</mn>
                                  </mrow>
                                </msub>
                                <mo>+</mo>
                                <mi>N</mi>
                              </mrow>
                            </mfrac>
                          </mrow>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>}</mo>
                </mrow>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>5</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mi>N</mi>
                <mo stretchy="false">)</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">]</mo>
                <msup>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mo>&#x2212;<!-- − --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mfrac>
                          <mrow>
                            <msub>
                              <mi>&#x03BB;<!-- λ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <msub>
                              <mi>&#x03BC;<!-- μ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <munderover>
                              <mo>&#x2211;<!-- ∑ --></mo>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>n</mi>
                                <mo>=</mo>
                                <mn>1</mn>
                              </mrow>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>N</mi>
                              </mrow>
                            </munderover>
                            <msub>
                              <mi>x</mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mi>n</mi>
                              </mrow>
                            </msub>
                          </mrow>
                          <mrow>
                            <msub>
                              <mi>&#x03BB;<!-- λ --></mi>
                              <mrow class="MJX-TeXAtom-ORD">
                                <mn>0</mn>
                              </mrow>
                            </msub>
                            <mo>+</mo>
                            <mi>N</mi>
                          </mrow>
                        </mfrac>
                      </mrow>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msup>
                <mo>+</mo>
                <msub>
                  <mi>C</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>5</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}^{2}-2x_{n}\mu +\mu ^{2})+\lambda _{0}(\mu ^{2}-2\mu _{0}\mu +\mu _{0}^{2})\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\left(\sum _{n=1}^{N}x_{n}^{2}\right)-2\left(\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}\mu ^{2}\right)+\lambda _{0}\mu ^{2}-2\lambda _{0}\mu _{0}\mu +\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)(\lambda _{0}+N)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu \right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}-\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{5}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right\}+C_{5}\\&amp;=-{\frac {1}{2}}(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}+C_{5}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b95121a849ebbf25ba5413565ef4696267ba0e42" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -43.124ex; margin-bottom: -0.214ex; width:122.323ex; height:87.843ex;" alt="{\displaystyle {\begin{aligned}\ln q_{\mu }^{*}(\mu )&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\sum _{n=1}^{N}(x_{n}^{2}-2x_{n}\mu +\mu ^{2})+\lambda _{0}(\mu ^{2}-2\mu _{0}\mu +\mu _{0}^{2})\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{\left(\sum _{n=1}^{N}x_{n}^{2}\right)-2\left(\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}\mu ^{2}\right)+\lambda _{0}\mu ^{2}-2\lambda _{0}\mu _{0}\mu +\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right\}+C_{3}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)(\lambda _{0}+N)\mu \right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu \right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}-\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{4}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu ^{2}-2\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)\mu +\left({\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right)\right\}+C_{5}\\&amp;=-{\frac {\operatorname {E} _{\tau }[\tau ]}{2}}\left\{(\lambda _{0}+N)\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}\right\}+C_{5}\\&amp;=-{\frac {1}{2}}(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\left(\mu -{\frac {\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}}{\lambda _{0}+N}}\right)^{2}+C_{5}\end{aligned}}}"></span></dd></dl>
<p>Note that all of the above steps can be shortened by using the formula for the <a href="/wiki/Normal_distribution#Sum_of_two_quadratics" title="Normal distribution">sum of two quadratics</a>.
</p><p>In other words:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msubsup>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mrow class="MJX-TeXAtom-ORD">
                          <mover>
                            <mi>x</mi>
                            <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                          </mover>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                    </mrow>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mi>N</mi>
                <mo stretchy="false">)</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">]</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>x</mi>
                      <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                    </mover>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mi>N</mi>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2d299b83cbb420dff824c2914458942a0fb39859" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -9.163ex; margin-bottom: -0.175ex; width:24.56ex; height:19.843ex;" alt="{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}"></span></dd></dl>
<div class="mw-heading mw-heading3"><h3 id="Derivation_of_q(τ)"><span id="Derivation_of_q.28.CF.84.29"></span>Derivation of <span class="texhtml">q(&#964;)</span></h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=14" title="Edit section: Derivation of q(τ)"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>The derivation of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{\tau }^{*}(\tau )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03C4;<!-- τ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{\tau }^{*}(\tau )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1e1e42dc79dac09f18a284556d7478a008c28503" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.145ex; height:2.843ex;" alt="{\displaystyle q_{\tau }^{*}(\tau )}"></span> is similar to above, although we omit some of the details for the sake of brevity.
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\ln q_{\tau }^{*}(\tau )&amp;=\operatorname {E} _{\mu }[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )]+\ln p(\tau )+{\text{constant}}\\&amp;=(a_{0}-1)\ln \tau -b_{0}\tau +{\frac {1}{2}}\ln \tau +{\frac {N}{2}}\ln \tau -{\frac {\tau }{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]+{\text{constant}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>,</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
                <mo>+</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <mn>1</mn>
                <mo stretchy="false">)</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>N</mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2212;<!-- − --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mi>&#x03C4;<!-- τ --></mi>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\ln q_{\tau }^{*}(\tau )&amp;=\operatorname {E} _{\mu }[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )]+\ln p(\tau )+{\text{constant}}\\&amp;=(a_{0}-1)\ln \tau -b_{0}\tau +{\frac {1}{2}}\ln \tau +{\frac {N}{2}}\ln \tau -{\frac {\tau }{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]+{\text{constant}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/58986c8046658988c363da1009d0beedc83ce01c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -4.838ex; width:97.948ex; height:10.843ex;" alt="{\displaystyle {\begin{aligned}\ln q_{\tau }^{*}(\tau )&amp;=\operatorname {E} _{\mu }[\ln p(\mathbf {X} \mid \mu ,\tau )+\ln p(\mu \mid \tau )]+\ln p(\tau )+{\text{constant}}\\&amp;=(a_{0}-1)\ln \tau -b_{0}\tau +{\frac {1}{2}}\ln \tau +{\frac {N}{2}}\ln \tau -{\frac {\tau }{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]+{\text{constant}}\end{aligned}}}"></span></dd></dl>
<p>Exponentiating both sides, we can see that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{\tau }^{*}(\tau )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03C4;<!-- τ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <mi>&#x03C4;<!-- τ --></mi>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{\tau }^{*}(\tau )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1e1e42dc79dac09f18a284556d7478a008c28503" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.145ex; height:2.843ex;" alt="{\displaystyle q_{\tau }^{*}(\tau )}"></span> is a <a href="/wiki/Gamma_distribution" title="Gamma distribution">gamma distribution</a>.  Specifically:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mi>Gamma</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>N</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f6ca127beab48a5d09ca7e57f8826ed863d01727" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -7.2ex; margin-bottom: -0.305ex; width:49.61ex; height:16.176ex;" alt="{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}"></span></dd></dl>
<div class="mw-heading mw-heading3"><h3 id="Algorithm_for_computing_the_parameters">Algorithm for computing the parameters</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=15" title="Edit section: Algorithm for computing the parameters"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Let us recap the conclusions from the previous sections:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mi>&#x03BC;<!-- μ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msubsup>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mrow class="MJX-TeXAtom-ORD">
                          <mover>
                            <mi>x</mi>
                            <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                          </mover>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                    </mrow>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mi>N</mi>
                <mo stretchy="false">)</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">]</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>x</mi>
                      <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                    </mover>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mi>N</mi>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2d299b83cbb420dff824c2914458942a0fb39859" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -9.163ex; margin-bottom: -0.175ex; width:24.56ex; height:19.843ex;" alt="{\displaystyle {\begin{aligned}q_{\mu }^{*}(\mu )&amp;\sim {\mathcal {N}}(\mu \mid \mu _{N},\lambda _{N}^{-1})\\\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N)\operatorname {E} _{\tau }[\tau ]\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\end{aligned}}}"></span></dd></dl>
<p>and
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msubsup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03C4;<!-- τ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msubsup>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mi>Gamma</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>N</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f6ca127beab48a5d09ca7e57f8826ed863d01727" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -7.2ex; margin-bottom: -0.305ex; width:49.61ex; height:16.176ex;" alt="{\displaystyle {\begin{aligned}q_{\tau }^{*}(\tau )&amp;\sim \operatorname {Gamma} (\tau \mid a_{N},b_{N})\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\end{aligned}}}"></span></dd></dl>
<p>In each case, the parameters for the distribution over one of the variables depend on expectations taken with respect to the other variable.  We can expand the expectations, using the standard formulas for the expectations of moments of the Gaussian and gamma distributions:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\operatorname {E} [\tau \mid a_{N},b_{N}]&amp;={\frac {a_{N}}{b_{N}}}\\\operatorname {E} \left[\mu \mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\mu _{N}\\\operatorname {E} \left[X^{2}\right]&amp;=\operatorname {Var} (X)+(\operatorname {E} [X])^{2}\\\operatorname {E} \left[\mu ^{2}\mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\lambda _{N}^{-1}+\mu _{N}^{2}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>&#x03C4;<!-- τ --></mi>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">]</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <msub>
                      <mi>a</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>b</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>,</mo>
                    <msubsup>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>1</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <msup>
                    <mi>X</mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mn>2</mn>
                    </mrow>
                  </msup>
                  <mo>]</mo>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mi>Var</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>X</mi>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <mo stretchy="false">(</mo>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>X</mi>
                <mo stretchy="false">]</mo>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2223;<!-- ∣ --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>,</mo>
                    <msubsup>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>1</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msubsup>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <msubsup>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>2</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\operatorname {E} [\tau \mid a_{N},b_{N}]&amp;={\frac {a_{N}}{b_{N}}}\\\operatorname {E} \left[\mu \mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\mu _{N}\\\operatorname {E} \left[X^{2}\right]&amp;=\operatorname {Var} (X)+(\operatorname {E} [X])^{2}\\\operatorname {E} \left[\mu ^{2}\mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\lambda _{N}^{-1}+\mu _{N}^{2}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/917241f915e88f88f8e3ff74096507c6efe8551c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -7.338ex; width:37.747ex; height:15.843ex;" alt="{\displaystyle {\begin{aligned}\operatorname {E} [\tau \mid a_{N},b_{N}]&amp;={\frac {a_{N}}{b_{N}}}\\\operatorname {E} \left[\mu \mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\mu _{N}\\\operatorname {E} \left[X^{2}\right]&amp;=\operatorname {Var} (X)+(\operatorname {E} [X])^{2}\\\operatorname {E} \left[\mu ^{2}\mid \mu _{N},\lambda _{N}^{-1}\right]&amp;=\lambda _{N}^{-1}+\mu _{N}^{2}\end{aligned}}}"></span></dd></dl>
<p>Applying these formulas to the above equations is trivial in most cases, but the equation for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b_{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>b</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b_{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bf4e4e22fd2dea61c6ff23552caf55c7c772368b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.689ex; height:2.509ex;" alt="{\displaystyle b_{N}}"></span> takes more work:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\operatorname {E} _{\mu }[\mu ^{2}]-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\operatorname {E} _{\mu }[\mu ]+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </munderover>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <msub>
                      <mi mathvariant="normal">E</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>&#x03BC;<!-- μ --></mi>
                      </mrow>
                    </msub>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mo stretchy="false">[</mo>
                    <msup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msup>
                    <mo stretchy="false">]</mo>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi mathvariant="normal">E</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>&#x03BC;<!-- μ --></mi>
                      </mrow>
                    </msub>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mo stretchy="false">[</mo>
                    <mi>&#x03BC;<!-- μ --></mi>
                    <mo stretchy="false">]</mo>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msubsup>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>&#x2212;<!-- − --></mo>
                            <mn>1</mn>
                          </mrow>
                        </msubsup>
                        <mo>+</mo>
                        <msubsup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\operatorname {E} _{\mu }[\mu ^{2}]-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\operatorname {E} _{\mu }[\mu ]+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/16171a58ee7ad1a9dca35de3637f8034197b22a6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -14.671ex; width:83.854ex; height:30.509ex;" alt="{\displaystyle {\begin{aligned}b_{N}&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[\sum _{n=1}^{N}(x_{n}-\mu )^{2}+\lambda _{0}(\mu -\mu _{0})^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\operatorname {E} _{\mu }\left[(\lambda _{0}+N)\mu ^{2}-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu +\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\operatorname {E} _{\mu }[\mu ^{2}]-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\operatorname {E} _{\mu }[\mu ]+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\\\end{aligned}}}"></span></dd></dl>
<p>We can then write the parameter equations as follows, without any expectations:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N){\frac {a_{N}}{b_{N}}}\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BC;<!-- μ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>&#x03BC;<!-- μ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mrow class="MJX-TeXAtom-ORD">
                          <mover>
                            <mi>x</mi>
                            <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                          </mover>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mrow>
                      <msub>
                        <mi>&#x03BB;<!-- λ --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <mi>N</mi>
                    </mrow>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03BB;<!-- λ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mi>N</mi>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <msub>
                      <mi>a</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>b</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mover>
                      <mi>x</mi>
                      <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                    </mover>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mi>N</mi>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>x</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>a</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi>N</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                    </mrow>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>b</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mn>2</mn>
                  </mfrac>
                </mrow>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mi>N</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msubsup>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>&#x2212;<!-- − --></mo>
                            <mn>1</mn>
                          </mrow>
                        </msubsup>
                        <mo>+</mo>
                        <msubsup>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>2</mn>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>&#x03BB;<!-- λ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <msub>
                          <mi>&#x03BC;<!-- μ --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>0</mn>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msub>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <msub>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>N</mi>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <munderover>
                          <mo>&#x2211;<!-- ∑ --></mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>N</mi>
                          </mrow>
                        </munderover>
                        <msubsup>
                          <mi>x</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>n</mi>
                          </mrow>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mn>2</mn>
                          </mrow>
                        </msubsup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>+</mo>
                    <msub>
                      <mi>&#x03BB;<!-- λ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <msubsup>
                      <mi>&#x03BC;<!-- μ --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>2</mn>
                      </mrow>
                    </msubsup>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N){\frac {a_{N}}{b_{N}}}\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/fe12241932dc8dfb6a202e043b02cd60b3f593a6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -15.338ex; width:84.258ex; height:31.843ex;" alt="{\displaystyle {\begin{aligned}\mu _{N}&amp;={\frac {\lambda _{0}\mu _{0}+N{\bar {x}}}{\lambda _{0}+N}}\\\lambda _{N}&amp;=(\lambda _{0}+N){\frac {a_{N}}{b_{N}}}\\{\bar {x}}&amp;={\frac {1}{N}}\sum _{n=1}^{N}x_{n}\\a_{N}&amp;=a_{0}+{\frac {N+1}{2}}\\b_{N}&amp;=b_{0}+{\frac {1}{2}}\left[(\lambda _{0}+N)\left(\lambda _{N}^{-1}+\mu _{N}^{2}\right)-2\left(\lambda _{0}\mu _{0}+\sum _{n=1}^{N}x_{n}\right)\mu _{N}+\left(\sum _{n=1}^{N}x_{n}^{2}\right)+\lambda _{0}\mu _{0}^{2}\right]\end{aligned}}}"></span></dd></dl>
<p>Note that there are circular dependencies among the formulas for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda _{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BB;<!-- λ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda _{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/595111953b67b8b3128ad3b7e568ff3f0f997be4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.047ex; height:2.509ex;" alt="{\displaystyle \lambda _{N}}"></span>and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b_{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>b</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b_{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bf4e4e22fd2dea61c6ff23552caf55c7c772368b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.689ex; height:2.509ex;" alt="{\displaystyle b_{N}}"></span>.  This naturally suggests an <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">EM</a>-like algorithm:
</p>
<ol><li>Compute <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{n=1}^{N}x_{n}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munderover>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <msub>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{n=1}^{N}x_{n}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7b1ecbd29b6f06d832ee19bff142d17e822921a0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:6.29ex; height:7.343ex;" alt="{\displaystyle \sum _{n=1}^{N}x_{n}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \sum _{n=1}^{N}x_{n}^{2}.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <munderover>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <msubsup>
          <mi>x</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \sum _{n=1}^{N}x_{n}^{2}.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/136329355406e35d28ec3cd668d78e35a7427381" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:6.937ex; height:7.343ex;" alt="{\displaystyle \sum _{n=1}^{N}x_{n}^{2}.}"></span> Use these values to compute <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mu _{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BC;<!-- μ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mu _{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c2136e1026c8a9df2da1fdbe61a6e7d183b387e9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:3.093ex; height:2.176ex;" alt="{\displaystyle \mu _{N}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle a_{N}.}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>a</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo>.</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle a_{N}.}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/35f87ecc4888664d11d4684e4a90f05383d6e06e" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.568ex; height:2.009ex;" alt="{\displaystyle a_{N}.}"></span></li>
<li>Initialize <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda _{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BB;<!-- λ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda _{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/595111953b67b8b3128ad3b7e568ff3f0f997be4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.047ex; height:2.509ex;" alt="{\displaystyle \lambda _{N}}"></span> to some arbitrary value.</li>
<li>Use the current value of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda _{N},}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BB;<!-- λ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda _{N},}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8cd7b32f2dee88fe802c33abb0feae5dd2811a32" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.694ex; height:2.509ex;" alt="{\displaystyle \lambda _{N},}"></span> along with the known values of the other parameters, to compute <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b_{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>b</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b_{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bf4e4e22fd2dea61c6ff23552caf55c7c772368b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.689ex; height:2.509ex;" alt="{\displaystyle b_{N}}"></span>.</li>
<li>Use the current value of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle b_{N},}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>b</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo>,</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle b_{N},}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c4096c740b6bf2d164be0e5b5ed361c37ab1f434" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.336ex; height:2.509ex;" alt="{\displaystyle b_{N},}"></span> along with the known values of the other parameters, to compute <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \lambda _{N}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BB;<!-- λ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \lambda _{N}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/595111953b67b8b3128ad3b7e568ff3f0f997be4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.047ex; height:2.509ex;" alt="{\displaystyle \lambda _{N}}"></span>.</li>
<li>Repeat the last two steps until convergence (i.e. until neither value has changed more than some small amount).</li></ol>
<p>We then have values for the hyperparameters of the approximating distributions of the posterior parameters, which we can use to compute any properties we want of the posterior — e.g. its mean and variance, a 95% highest-density region (the smallest interval that includes 95% of the total probability), etc.
</p><p>It can be shown that this algorithm is guaranteed to converge to a local maximum.
</p><p>Note also that the posterior distributions have the same form as the corresponding prior distributions.  We did <i>not</i> assume this; the only assumption we made was that the distributions factorize, and the form of the distributions followed naturally.  It turns out (see below) that the fact that the posterior distributions have the same form as the prior distributions is not a coincidence, but a general result whenever the prior distributions are members of the <a href="/wiki/Exponential_family" title="Exponential family">exponential family</a>, which is the case for most of the standard distributions.
</p>
<div class="mw-heading mw-heading2"><h2 id="Further_discussion">Further discussion</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=16" title="Edit section: Further discussion"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<div class="mw-heading mw-heading3"><h3 id="Step-by-step_recipe">Step-by-step recipe</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=17" title="Edit section: Step-by-step recipe"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>The above example shows the method by which the variational-Bayesian approximation to a <a href="/wiki/Posterior_probability" title="Posterior probability">posterior probability</a> density in a given <a href="/wiki/Bayesian_network" title="Bayesian network">Bayesian network</a> is derived:
</p>
<ol><li>Describe the network with a <a href="/wiki/Graphical_model" title="Graphical model">graphical model</a>, identifying the observed variables (data) <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {X} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {X} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9f75966a2f9d5672136fa9401ee1e75008f95ffd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.019ex; height:2.176ex;" alt="{\displaystyle \mathbf {X} }"></span> and unobserved variables (<a href="/wiki/Parameter" title="Parameter">parameters</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\boldsymbol {\Theta }}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x0398;<!-- Θ --></mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\boldsymbol {\Theta }}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f2749cbb9bd4c2ce7c4787c264216fedfff3ee81" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.078ex; height:2.176ex;" alt="{\displaystyle {\boldsymbol {\Theta }}}"></span> and <a href="/wiki/Latent_variable" class="mw-redirect" title="Latent variable">latent variables</a> <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/b776aaf12c2da4b78ca777cb8295c2000bfd51f5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.634ex; height:2.176ex;" alt="{\displaystyle \mathbf {Z} }"></span>) and their <a href="/wiki/Conditional_probability_distribution" title="Conditional probability distribution">conditional probability distributions</a>.  Variational Bayes will then construct an approximation to the posterior probability <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle p(\mathbf {Z} ,{\boldsymbol {\Theta }}\mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x0398;<!-- Θ --></mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle p(\mathbf {Z} ,{\boldsymbol {\Theta }}\mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2a49582d5ce49e43550e0fe466ad7e6214b8ef92" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:11.77ex; height:2.843ex;" alt="{\displaystyle p(\mathbf {Z} ,{\boldsymbol {\Theta }}\mid \mathbf {X} )}"></span>.  The approximation has the basic property that it is a factorized distribution, i.e. a product of two or more <a href="/wiki/Statistical_independence" class="mw-redirect" title="Statistical independence">independent</a> distributions over disjoint subsets of the unobserved variables.</li>
<li>Partition the unobserved variables into two or more subsets, over which the independent factors will be derived.  There is no universal procedure for doing this; creating too many subsets yields a poor approximation, while creating too few makes the entire variational Bayes procedure intractable.  Typically, the first split is to separate the parameters and latent variables; often, this is enough by itself to produce a tractable result.  Assume that the partitions are called <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{1},\ldots ,\mathbf {Z} _{M}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>M</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{1},\ldots ,\mathbf {Z} _{M}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cca2414b6018df7d6ac0f10c402bc02f11cdb10b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:11.459ex; height:2.509ex;" alt="{\displaystyle \mathbf {Z} _{1},\ldots ,\mathbf {Z} _{M}}"></span>.</li>
<li>For a given partition <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{j}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{j}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ffbb56db9f29c78324a4758e2dd41dc1c3c0cc1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:2.544ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} _{j}}"></span>, write down the formula for the best approximating distribution <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/27f85d66607ecb5faa10f38986cb03faf9bc5096" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.338ex; width:10.443ex; height:3.343ex;" alt="{\displaystyle q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )}"></span> using the basic equation <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{i\neq j}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msubsup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msubsup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>&#x2260;<!-- ≠ --></mo>
            <mi>j</mi>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>constant</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{i\neq j}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/931ba9fd5d59d6d74dad8cf2a82448fbca0c5ff9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.338ex; width:43.001ex; height:3.343ex;" alt="{\displaystyle \ln q_{j}^{*}(\mathbf {Z} _{j}\mid \mathbf {X} )=\operatorname {E} _{i\neq j}[\ln p(\mathbf {Z} ,\mathbf {X} )]+{\text{constant}}}"></span> .</li>
<li>Fill in the formula for the <a href="/wiki/Joint_probability_distribution" title="Joint probability distribution">joint probability distribution</a> using the graphical model.  Any component conditional distributions that don't involve any of the variables in <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{j}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{j}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ffbb56db9f29c78324a4758e2dd41dc1c3c0cc1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:2.544ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} _{j}}"></span> can be ignored; they will be folded into the constant term.</li>
<li>Simplify the formula and apply the expectation operator, following the above example.  Ideally, this should simplify into expectations of basic functions of variables not in <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} _{j}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">Z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>j</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} _{j}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ffbb56db9f29c78324a4758e2dd41dc1c3c0cc1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:2.544ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} _{j}}"></span> (e.g. first or second raw <a href="/wiki/Moment_(mathematics)" title="Moment (mathematics)">moments</a>, expectation of a logarithm, etc.).  In order for the variational Bayes procedure to work well, these expectations should generally be expressible analytically as functions of the parameters and/or <a href="/wiki/Hyperparameter_(Bayesian_statistics)" title="Hyperparameter (Bayesian statistics)">hyperparameters</a> of the distributions of these variables.  In all cases, these expectation terms are constants with respect to the variables in the current partition.</li>
<li>The functional form of the formula with respect to the variables in the current partition indicates the type of distribution.  In particular, exponentiating the formula generates the <a href="/wiki/Probability_density_function" title="Probability density function">probability density function</a> (PDF) of the distribution (or at least, something proportional to it, with unknown <a href="/wiki/Normalization_constant" class="mw-redirect" title="Normalization constant">normalization constant</a>).  In order for the overall method to be tractable, it should be possible to recognize the functional form as belonging to a known distribution.  Significant mathematical manipulation may be required to convert the formula into a form that matches the PDF of a known distribution.  When this can be done, the normalization constant can be reinstated by definition, and equations for the parameters of the known distribution can be derived by extracting the appropriate parts of the formula.</li>
<li>When all expectations can be replaced analytically with functions of variables not in the current partition, and the PDF put into a form that allows identification with a known distribution, the result is a set of equations expressing the values of the optimum parameters as functions of the parameters of variables in other partitions.</li>
<li>When this procedure can be applied to all partitions, the result is a set of mutually linked equations specifying the optimum values of all parameters.</li>
<li>An <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization</a> (EM) type procedure is then applied, picking an initial value for each parameter and the iterating through a series of steps, where at each step we cycle through the equations, updating each parameter in turn.  This is guaranteed to converge.</li></ol>
<div class="mw-heading mw-heading3"><h3 id="Most_important_points">Most important points</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=18" title="Edit section: Most important points"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Due to all of the mathematical manipulations involved, it is easy to lose track of the big picture.  The important things are:
</p>
<ol><li>The idea of variational Bayes is to construct an analytical approximation to the <a href="/wiki/Posterior_probability" title="Posterior probability">posterior probability</a> of the set of unobserved variables (parameters and latent variables), given the data.  This means that the form of the solution is similar to other <a href="/wiki/Bayesian_inference" title="Bayesian inference">Bayesian inference</a> methods, such as <a href="/wiki/Gibbs_sampling" title="Gibbs sampling">Gibbs sampling</a> — i.e. a distribution that seeks to describe everything that is known about the variables.  As in other Bayesian methods — but unlike e.g. in <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization</a> (EM) or other <a href="/wiki/Maximum_likelihood" class="mw-redirect" title="Maximum likelihood">maximum likelihood</a> methods — both types of unobserved variables (i.e. parameters and latent variables) are treated the same, i.e. as <a href="/wiki/Random_variable" title="Random variable">random variables</a>.  Estimates for the variables can then be derived in the standard Bayesian ways, e.g. calculating the mean of the distribution to get a single <a href="/wiki/Point_estimation" title="Point estimation">point estimate</a> or deriving a <a href="/wiki/Credible_interval" title="Credible interval">credible interval</a>, highest density region, etc.</li>
<li>"Analytical approximation" means that a formula can be written down for the posterior distribution.  The formula generally consists of a product of well-known probability distributions, each of which <i>factorizes</i> over a set of unobserved variables (i.e. it is <a href="/wiki/Conditionally_independent" class="mw-redirect" title="Conditionally independent">conditionally independent</a> of the other variables, given the observed data).  This formula is not the true posterior distribution, but an approximation to it; in particular, it will generally agree fairly closely in the lowest <a href="/wiki/Moment_(mathematics)" title="Moment (mathematics)">moments</a> of the unobserved variables, e.g. the <a href="/wiki/Mean" title="Mean">mean</a> and <a href="/wiki/Variance" title="Variance">variance</a>.</li>
<li>The result of all of the mathematical manipulations is (1) the identity of the probability distributions making up the factors, and (2) mutually dependent formulas for the parameters of these distributions.  The actual values of these parameters are computed numerically, through an alternating iterative procedure much like EM.</li></ol>
<div class="mw-heading mw-heading3"><h3 id="Compared_with_expectation–maximization_(EM)"><span id="Compared_with_expectation.E2.80.93maximization_.28EM.29"></span>Compared with expectation–maximization (EM)</h3><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=19" title="Edit section: Compared with expectation–maximization (EM)"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Variational Bayes (VB) is often compared with <a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">expectation–maximization</a> (EM).  The actual numerical procedure is quite similar, in that both are alternating iterative procedures that successively converge on optimum parameter values.  The initial steps to derive the respective procedures are also vaguely similar, both starting out with formulas for probability densities and both involving significant amounts of mathematical manipulations.
</p><p>However, there are a number of differences.  Most important is <i>what</i> is being computed.
</p>
<ul><li>EM computes point estimates of posterior distribution of those random variables that can be categorized as "parameters", but only estimates of the actual posterior distributions of the latent variables (at least in "soft EM", and often only when the latent variables are discrete).  The point estimates computed are the <a href="/wiki/Mode_(statistics)" title="Mode (statistics)">modes</a> of these parameters; no other information is available.</li>
<li>VB, on the other hand, computes estimates of the actual posterior distribution of all variables, both parameters and latent variables.  When point estimates need to be derived, generally the <a href="/wiki/Mean" title="Mean">mean</a> is used rather than the mode, as is normal in Bayesian inference.  Concomitant with this, the parameters computed in VB do <i>not</i> have the same significance as those in EM.  EM computes optimum values of the parameters of the Bayes network itself.  VB computes optimum values of the parameters of the distributions used to approximate the parameters and latent variables of the Bayes network.  For example, a typical Gaussian <a href="/wiki/Mixture_model" title="Mixture model">mixture model</a> will have parameters for the mean and variance of each of the mixture components.  EM would directly estimate optimum values for these parameters.  VB, however, would first fit a distribution to these parameters — typically in the form of a <a href="/wiki/Prior_distribution" class="mw-redirect" title="Prior distribution">prior distribution</a>, e.g. a <a href="/wiki/Normal-scaled_inverse_gamma_distribution" class="mw-redirect" title="Normal-scaled inverse gamma distribution">normal-scaled inverse gamma distribution</a> — and would then compute values for the parameters of this prior distribution, i.e. essentially <a href="/wiki/Hyperparameter_(Bayesian_statistics)" title="Hyperparameter (Bayesian statistics)">hyperparameters</a>.  In this case, VB would compute optimum estimates of the four parameters of the normal-scaled inverse gamma distribution that describes the joint distribution of the mean and variance of the component.</li></ul>
<div style="clear:both;" class=""></div>
<div class="mw-heading mw-heading2"><h2 id="A_more_complex_example">A more complex example</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=20" title="Edit section: A more complex example"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<figure class="mw-halign-right" typeof="mw:File/Thumb"><a href="/wiki/File:Bayesian-gaussian-mixture-vb.svg" class="mw-file-description"><img src="//upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Bayesian-gaussian-mixture-vb.svg/330px-Bayesian-gaussian-mixture-vb.svg.png" decoding="async" width="300" height="292" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Bayesian-gaussian-mixture-vb.svg/500px-Bayesian-gaussian-mixture-vb.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Bayesian-gaussian-mixture-vb.svg/960px-Bayesian-gaussian-mixture-vb.svg.png 2x" data-file-width="227" data-file-height="221" /></a><figcaption>Bayesian Gaussian mixture model using <a href="/wiki/Plate_notation" title="Plate notation">plate notation</a>.  Smaller squares indicate fixed parameters; larger circles indicate random variables.  Filled-in shapes indicate known values.  The indication [K] means a vector of size <i>K</i>; [<i>D</i>,<i>D</i>] means a matrix of size <i>D</i>&#215;<i>D</i>; <i>K</i> alone means a <a href="/wiki/Categorical_variable" title="Categorical variable">categorical variable</a> with <i>K</i> outcomes.  The squiggly line coming from <i>z</i> ending in a crossbar indicates a <i>switch</i> — the value of this variable selects, for the other incoming variables, which value to use out of the size-<i>K</i> array of possible values.</figcaption></figure>
<p>Imagine a Bayesian <a href="/wiki/Gaussian_mixture_model" class="mw-redirect" title="Gaussian mixture model">Gaussian mixture model</a> described as follows:<sup id="cite&#95;ref-Nguyen&#95;3-1" class="reference"><a href="#cite_note-Nguyen-3"><span class="cite-bracket">&#91;</span>3<span class="cite-bracket">&#93;</span></a></sup>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\mathbf {\pi } &amp;\sim \operatorname {SymDir} (K,\alpha _{0})\\\mathbf {\Lambda } _{i=1\dots K}&amp;\sim {\mathcal {W}}(\mathbf {W} _{0},\nu _{0})\\\mathbf {\mu } _{i=1\dots K}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{i})^{-1})\\\mathbf {z} [i=1\dots N]&amp;\sim \operatorname {Mult} (1,\mathbf {\pi } )\\\mathbf {x} _{i=1\dots N}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{z_{i}},{\mathbf {\Lambda } _{z_{i}}}^{-1})\\K&amp;={\text{number of mixing components}}\\N&amp;={\text{number of data points}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mi>SymDir</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mi>K</mi>
                <mo>,</mo>
                <msub>
                  <mi>&#x03B1;<!-- α --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>&#x2026;<!-- … --></mo>
                    <mi>K</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">W</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>&#x2026;<!-- … --></mo>
                    <mi>K</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">z</mi>
                </mrow>
                <mo stretchy="false">[</mo>
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
                <mo>&#x2026;<!-- … --></mo>
                <mi>N</mi>
                <mo stretchy="false">]</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mi>Mult</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">(</mo>
                <mn>1</mn>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>&#x2026;<!-- … --></mo>
                    <mi>N</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x223C;<!-- ∼ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mi>z</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>i</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <msub>
                          <mi>z</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mrow>
                    </msub>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>K</mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>number of mixing components</mtext>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>N</mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>number of data points</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\mathbf {\pi } &amp;\sim \operatorname {SymDir} (K,\alpha _{0})\\\mathbf {\Lambda } _{i=1\dots K}&amp;\sim {\mathcal {W}}(\mathbf {W} _{0},\nu _{0})\\\mathbf {\mu } _{i=1\dots K}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{i})^{-1})\\\mathbf {z} [i=1\dots N]&amp;\sim \operatorname {Mult} (1,\mathbf {\pi } )\\\mathbf {x} _{i=1\dots N}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{z_{i}},{\mathbf {\Lambda } _{z_{i}}}^{-1})\\K&amp;={\text{number of mixing components}}\\N&amp;={\text{number of data points}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6e54f90a522209bd5e80751661fbd8f25570b952" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -10.671ex; width:47.266ex; height:22.509ex;" alt="{\displaystyle {\begin{aligned}\mathbf {\pi } &amp;\sim \operatorname {SymDir} (K,\alpha _{0})\\\mathbf {\Lambda } _{i=1\dots K}&amp;\sim {\mathcal {W}}(\mathbf {W} _{0},\nu _{0})\\\mathbf {\mu } _{i=1\dots K}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{i})^{-1})\\\mathbf {z} [i=1\dots N]&amp;\sim \operatorname {Mult} (1,\mathbf {\pi } )\\\mathbf {x} _{i=1\dots N}&amp;\sim {\mathcal {N}}(\mathbf {\mu } _{z_{i}},{\mathbf {\Lambda } _{z_{i}}}^{-1})\\K&amp;={\text{number of mixing components}}\\N&amp;={\text{number of data points}}\end{aligned}}}"></span></dd></dl>
<p>Note:
</p>
<ul><li>SymDir() is the symmetric <a href="/wiki/Dirichlet_distribution" title="Dirichlet distribution">Dirichlet distribution</a> of dimension <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle K}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle K}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2b76fce82a62ed5461908f0dc8f037de4e3686b0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.066ex; height:2.176ex;" alt="{\displaystyle K}"></span>, with the hyperparameter for each component set to <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \alpha _{0}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B1;<!-- α --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \alpha _{0}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a214eff2fcc322f780dd8837e7472b0edb994a13" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.542ex; height:2.009ex;" alt="{\displaystyle \alpha _{0}}"></span>.  The Dirichlet distribution is the <a href="/wiki/Conjugate_prior" title="Conjugate prior">conjugate prior</a> of the <a href="/wiki/Categorical_distribution" title="Categorical distribution">categorical distribution</a> or <a href="/wiki/Multinomial_distribution" title="Multinomial distribution">multinomial distribution</a>.</li>
<li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {W}}()}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">W</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {W}}()}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ea721c03e0cad4fc58cdb4e60c2881b96677a27c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:4.214ex; height:2.843ex;" alt="{\displaystyle {\mathcal {W}}()}"></span> is the <a href="/wiki/Wishart_distribution" title="Wishart distribution">Wishart distribution</a>, which is the conjugate prior of the <a href="/wiki/Precision_matrix" class="mw-redirect" title="Precision matrix">precision matrix</a> (inverse <a href="/wiki/Covariance_matrix" title="Covariance matrix">covariance matrix</a>) for a <a href="/wiki/Multivariate_Gaussian_distribution" class="mw-redirect" title="Multivariate Gaussian distribution">multivariate Gaussian distribution</a>.</li>
<li>Mult() is a <a href="/wiki/Multinomial_distribution" title="Multinomial distribution">multinomial distribution</a> over a single observation (equivalent to a <a href="/wiki/Categorical_distribution" title="Categorical distribution">categorical distribution</a>).  The state space is a "one-of-K" representation, i.e., a <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle K}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle K}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2b76fce82a62ed5461908f0dc8f037de4e3686b0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.066ex; height:2.176ex;" alt="{\displaystyle K}"></span>-dimensional vector in which one of the elements is 1 (specifying the identity of the observation) and all other elements are 0.</li>
<li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\mathcal {N}}()}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\mathcal {N}}()}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dcc84cb16dc05a84b640ffb5f96cce22af8fa0b8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.062ex; width:4.146ex; height:3.009ex;" alt="{\displaystyle {\mathcal {N}}()}"></span> is the <a href="/wiki/Gaussian_distribution" class="mw-redirect" title="Gaussian distribution">Gaussian distribution</a>, in this case specifically the <a href="/wiki/Multivariate_Gaussian_distribution" class="mw-redirect" title="Multivariate Gaussian distribution">multivariate Gaussian distribution</a>.</li></ul>
<p>The interpretation of the above variables is as follows:
</p>
<ul><li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {X} =\{\mathbf {x} _{1},\dots ,\mathbf {x} _{N}\}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>=</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo fence="false" stretchy="false">}</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {X} =\{\mathbf {x} _{1},\dots ,\mathbf {x} _{N}\}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/899f889b086f2e9b956c3e937ce6793f9cb66faa" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:18.189ex; height:2.843ex;" alt="{\displaystyle \mathbf {X} =\{\mathbf {x} _{1},\dots ,\mathbf {x} _{N}\}}"></span> is the set of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>N</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f5e3890c981ae85503089652feb48b191b57aae3" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.064ex; height:2.176ex;" alt="{\displaystyle N}"></span> data points, each of which is a <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle D}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>D</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle D}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f34a0c600395e5d4345287e21fb26efd386990e6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.924ex; height:2.176ex;" alt="{\displaystyle D}"></span>-dimensional vector distributed according to a <a href="/wiki/Multivariate_Gaussian_distribution" class="mw-redirect" title="Multivariate Gaussian distribution">multivariate Gaussian distribution</a>.</li>
<li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {Z} =\{\mathbf {z} _{1},\dots ,\mathbf {z} _{N}\}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>=</mo>
        <mo fence="false" stretchy="false">{</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo>&#x2026;<!-- … --></mo>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </msub>
        <mo fence="false" stretchy="false">}</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {Z} =\{\mathbf {z} _{1},\dots ,\mathbf {z} _{N}\}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5959d0417f5c451bf7d812d5bc2d2a16854c12e9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:17.357ex; height:2.843ex;" alt="{\displaystyle \mathbf {Z} =\{\mathbf {z} _{1},\dots ,\mathbf {z} _{N}\}}"></span> is a set of latent variables, one per data point, specifying which mixture component the corresponding data point belongs to, using a "one-of-K" vector representation with components <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle z_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle z_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/50c1a2ebeb33c48ba0e8ba03176918425862d4c9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.156ex; height:2.009ex;" alt="{\displaystyle z_{nk}}"></span> for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k=1\dots K}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
        <mo>&#x2026;<!-- … --></mo>
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k=1\dots K}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f1b2624be134bda7a383bf912a040d6579a6127c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:11.036ex; height:2.176ex;" alt="{\displaystyle k=1\dots K}"></span>, as described above.</li>
<li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\pi } }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\pi } }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/07b0cee10b7be89207fd2de25f81a23f11018ff8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.332ex; height:1.676ex;" alt="{\displaystyle \mathbf {\pi } }"></span> is the mixing proportions for the <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle K}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle K}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2b76fce82a62ed5461908f0dc8f037de4e3686b0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:2.066ex; height:2.176ex;" alt="{\displaystyle K}"></span> mixture components.</li>
<li><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\mu } _{i=1\dots K}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
            <mo>&#x2026;<!-- … --></mo>
            <mi>K</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\mu } _{i=1\dots K}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/89b56734561b9a53296b3c7abe3463e2798e9ac7" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:7.688ex; height:2.176ex;" alt="{\displaystyle \mathbf {\mu } _{i=1\dots K}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\Lambda } _{i=1\dots K}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>i</mi>
            <mo>=</mo>
            <mn>1</mn>
            <mo>&#x2026;<!-- … --></mo>
            <mi>K</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\Lambda } _{i=1\dots K}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8397707df58b255aeabec6047b0d01f5140241e2" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:8.16ex; height:2.509ex;" alt="{\displaystyle \mathbf {\Lambda } _{i=1\dots K}}"></span> specify the parameters (<a href="/wiki/Mean" title="Mean">mean</a> and <a href="/wiki/Precision_(statistics)" title="Precision (statistics)">precision</a>) associated with each mixture component.</li></ul>
<p>The joint probability of all variables can be rewritten as
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )p(\mathbf {Z} \mid \mathbf {\pi } )p(\mathbf {\pi } )p(\mathbf {\mu } \mid \mathbf {\Lambda } )p(\mathbf {\Lambda } )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )p(\mathbf {Z} \mid \mathbf {\pi } )p(\mathbf {\pi } )p(\mathbf {\mu } \mid \mathbf {\Lambda } )p(\mathbf {\Lambda } )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c583236ba92e993d0a8bbcd77ea2afde26f4ec14" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:57.71ex; height:2.843ex;" alt="{\displaystyle p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )p(\mathbf {Z} \mid \mathbf {\pi } )p(\mathbf {\pi } )p(\mathbf {\mu } \mid \mathbf {\Lambda } )p(\mathbf {\Lambda } )}"></span></dd></dl>
<p>where the individual factors are
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})^{z_{nk}}\\p(\mathbf {Z} \mid \mathbf {\pi } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}\pi _{k}^{z_{nk}}\\p(\mathbf {\pi } )&amp;={\frac {\Gamma (K\alpha _{0})}{\Gamma (\alpha _{0})^{K}}}\prod _{k=1}^{K}\pi _{k}^{\alpha _{0}-1}\\p(\mathbf {\mu } \mid \mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{k})^{-1})\\p(\mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{0},\nu _{0})\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03BC;<!-- μ --></mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mi>z</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <msubsup>
                  <mi>&#x03C0;<!-- π --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mi>z</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>n</mi>
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <mi mathvariant="normal">&#x0393;<!-- Γ --></mi>
                      <mo stretchy="false">(</mo>
                      <mi>K</mi>
                      <msub>
                        <mi>&#x03B1;<!-- α --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi mathvariant="normal">&#x0393;<!-- Γ --></mi>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>&#x03B1;<!-- α --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <msup>
                        <mo stretchy="false">)</mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>K</mi>
                        </mrow>
                      </msup>
                    </mrow>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <msubsup>
                  <mi>&#x03C0;<!-- π --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mi>&#x03B1;<!-- α --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mn>0</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03BC;<!-- μ --></mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x220F;<!-- ∏ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">W</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>&#x2223;<!-- ∣ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})^{z_{nk}}\\p(\mathbf {Z} \mid \mathbf {\pi } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}\pi _{k}^{z_{nk}}\\p(\mathbf {\pi } )&amp;={\frac {\Gamma (K\alpha _{0})}{\Gamma (\alpha _{0})^{K}}}\prod _{k=1}^{K}\pi _{k}^{\alpha _{0}-1}\\p(\mathbf {\mu } \mid \mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{k})^{-1})\\p(\mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{0},\nu _{0})\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/4fb8a250bfc8ff4c25d41fe537d73505462fe5c7" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -17.955ex; margin-bottom: -0.216ex; width:43.631ex; height:37.509ex;" alt="{\displaystyle {\begin{aligned}p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})^{z_{nk}}\\p(\mathbf {Z} \mid \mathbf {\pi } )&amp;=\prod _{n=1}^{N}\prod _{k=1}^{K}\pi _{k}^{z_{nk}}\\p(\mathbf {\pi } )&amp;={\frac {\Gamma (K\alpha _{0})}{\Gamma (\alpha _{0})^{K}}}\prod _{k=1}^{K}\pi _{k}^{\alpha _{0}-1}\\p(\mathbf {\mu } \mid \mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {\mu } _{0},(\beta _{0}\mathbf {\Lambda } _{k})^{-1})\\p(\mathbf {\Lambda } )&amp;=\prod _{k=1}^{K}{\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{0},\nu _{0})\end{aligned}}}"></span></dd></dl>
<p>where
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}{\mathcal {N}}(\mathbf {x} \mid \mathbf {\mu } ,\mathbf {\Sigma } )&amp;={\frac {1}{(2\pi )^{D/2}}}{\frac {1}{|\mathbf {\Sigma } |^{1/2}}}\exp \left\{-{\frac {1}{2}}(\mathbf {x} -\mathbf {\mu } )^{\rm {T}}\mathbf {\Sigma } ^{-1}(\mathbf {x} -\mathbf {\mu } )\right\}\\{\mathcal {W}}(\mathbf {\Lambda } \mid \mathbf {W} ,\nu )&amp;=B(\mathbf {W} ,\nu )|\mathbf {\Lambda } |^{(\nu -D-1)/2}\exp \left(-{\frac {1}{2}}\operatorname {Tr} (\mathbf {W} ^{-1}\mathbf {\Lambda } )\right)\\B(\mathbf {W} ,\nu )&amp;=|\mathbf {W} |^{-\nu /2}\left\{2^{\nu D/2}\pi ^{D(D-1)/4}\prod _{i=1}^{D}\Gamma \left({\frac {\nu +1-i}{2}}\right)\right\}^{-1}\\D&amp;={\text{dimensionality of each data point}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">x</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03BC;<!-- μ --></mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x03A3;<!-- Σ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mn>2</mn>
                      <mi>&#x03C0;<!-- π --></mi>
                      <msup>
                        <mo stretchy="false">)</mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>D</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>/</mo>
                          </mrow>
                          <mn>2</mn>
                        </mrow>
                      </msup>
                    </mrow>
                  </mfrac>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo stretchy="false">|</mo>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">&#x03A3;<!-- Σ --></mi>
                      </mrow>
                      <msup>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mo stretchy="false">|</mo>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>1</mn>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>/</mo>
                          </mrow>
                          <mn>2</mn>
                        </mrow>
                      </msup>
                    </mrow>
                  </mfrac>
                </mrow>
                <mi>exp</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>{</mo>
                  <mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mn>1</mn>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">x</mi>
                    </mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03BC;<!-- μ --></mi>
                    </mrow>
                    <msup>
                      <mo stretchy="false">)</mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="normal">T</mi>
                        </mrow>
                      </mrow>
                    </msup>
                    <msup>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">&#x03A3;<!-- Σ --></mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>1</mn>
                      </mrow>
                    </msup>
                    <mo stretchy="false">(</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">x</mi>
                    </mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03BC;<!-- μ --></mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>}</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow class="MJX-TeXAtom-ORD">
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi class="MJX-tex-caligraphic" mathvariant="script">W</mi>
                  </mrow>
                </mrow>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">W</mi>
                </mrow>
                <mo>,</mo>
                <mi>&#x03BD;<!-- ν --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mi>B</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">W</mi>
                </mrow>
                <mo>,</mo>
                <mi>&#x03BD;<!-- ν --></mi>
                <mo stretchy="false">)</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <msup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">(</mo>
                    <mi>&#x03BD;<!-- ν --></mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>D</mi>
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                    <mo stretchy="false">)</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mo>/</mo>
                    </mrow>
                    <mn>2</mn>
                  </mrow>
                </msup>
                <mi>exp</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mo>&#x2212;<!-- − --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mfrac>
                        <mn>1</mn>
                        <mn>2</mn>
                      </mfrac>
                    </mrow>
                    <mi>Tr</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">W</mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mo>&#x2212;<!-- − --></mo>
                        <mn>1</mn>
                      </mrow>
                    </msup>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                    </mrow>
                    <mo stretchy="false">)</mo>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>B</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">W</mi>
                </mrow>
                <mo>,</mo>
                <mi>&#x03BD;<!-- ν --></mi>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">W</mi>
                </mrow>
                <msup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo stretchy="false">|</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mi>&#x03BD;<!-- ν --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mo>/</mo>
                    </mrow>
                    <mn>2</mn>
                  </mrow>
                </msup>
                <msup>
                  <mrow>
                    <mo>{</mo>
                    <mrow>
                      <msup>
                        <mn>2</mn>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>&#x03BD;<!-- ν --></mi>
                          <mi>D</mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>/</mo>
                          </mrow>
                          <mn>2</mn>
                        </mrow>
                      </msup>
                      <msup>
                        <mi>&#x03C0;<!-- π --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>D</mi>
                          <mo stretchy="false">(</mo>
                          <mi>D</mi>
                          <mo>&#x2212;<!-- − --></mo>
                          <mn>1</mn>
                          <mo stretchy="false">)</mo>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mo>/</mo>
                          </mrow>
                          <mn>4</mn>
                        </mrow>
                      </msup>
                      <munderover>
                        <mo>&#x220F;<!-- ∏ --></mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>i</mi>
                          <mo>=</mo>
                          <mn>1</mn>
                        </mrow>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>D</mi>
                        </mrow>
                      </munderover>
                      <mi mathvariant="normal">&#x0393;<!-- Γ --></mi>
                      <mrow>
                        <mo>(</mo>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mfrac>
                            <mrow>
                              <mi>&#x03BD;<!-- ν --></mi>
                              <mo>+</mo>
                              <mn>1</mn>
                              <mo>&#x2212;<!-- − --></mo>
                              <mi>i</mi>
                            </mrow>
                            <mn>2</mn>
                          </mfrac>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>}</mo>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>D</mi>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>dimensionality of each data point</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}{\mathcal {N}}(\mathbf {x} \mid \mathbf {\mu } ,\mathbf {\Sigma } )&amp;={\frac {1}{(2\pi )^{D/2}}}{\frac {1}{|\mathbf {\Sigma } |^{1/2}}}\exp \left\{-{\frac {1}{2}}(\mathbf {x} -\mathbf {\mu } )^{\rm {T}}\mathbf {\Sigma } ^{-1}(\mathbf {x} -\mathbf {\mu } )\right\}\\{\mathcal {W}}(\mathbf {\Lambda } \mid \mathbf {W} ,\nu )&amp;=B(\mathbf {W} ,\nu )|\mathbf {\Lambda } |^{(\nu -D-1)/2}\exp \left(-{\frac {1}{2}}\operatorname {Tr} (\mathbf {W} ^{-1}\mathbf {\Lambda } )\right)\\B(\mathbf {W} ,\nu )&amp;=|\mathbf {W} |^{-\nu /2}\left\{2^{\nu D/2}\pi ^{D(D-1)/4}\prod _{i=1}^{D}\Gamma \left({\frac {\nu +1-i}{2}}\right)\right\}^{-1}\\D&amp;={\text{dimensionality of each data point}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6e297b20d7c9af755fdc79dfe634cc58ccc4c122" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -11.505ex; width:64.366ex; height:24.176ex;" alt="{\displaystyle {\begin{aligned}{\mathcal {N}}(\mathbf {x} \mid \mathbf {\mu } ,\mathbf {\Sigma } )&amp;={\frac {1}{(2\pi )^{D/2}}}{\frac {1}{|\mathbf {\Sigma } |^{1/2}}}\exp \left\{-{\frac {1}{2}}(\mathbf {x} -\mathbf {\mu } )^{\rm {T}}\mathbf {\Sigma } ^{-1}(\mathbf {x} -\mathbf {\mu } )\right\}\\{\mathcal {W}}(\mathbf {\Lambda } \mid \mathbf {W} ,\nu )&amp;=B(\mathbf {W} ,\nu )|\mathbf {\Lambda } |^{(\nu -D-1)/2}\exp \left(-{\frac {1}{2}}\operatorname {Tr} (\mathbf {W} ^{-1}\mathbf {\Lambda } )\right)\\B(\mathbf {W} ,\nu )&amp;=|\mathbf {W} |^{-\nu /2}\left\{2^{\nu D/2}\pi ^{D(D-1)/4}\prod _{i=1}^{D}\Gamma \left({\frac {\nu +1-i}{2}}\right)\right\}^{-1}\\D&amp;={\text{dimensionality of each data point}}\end{aligned}}}"></span></dd></dl>
<p>Assume that <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=q(\mathbf {Z} )q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=q(\mathbf {Z} )q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/48318f9eaa5512ae1b1432aeabe75506c837713d" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:29.386ex; height:2.843ex;" alt="{\displaystyle q(\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )=q(\mathbf {Z} )q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}"></span>.
</p><p>Then<sup id="cite&#95;ref-Nguyen&#95;3-2" class="reference"><a href="#cite_note-Nguyen-3"><span class="cite-bracket">&#91;</span>3<span class="cite-bracket">&#93;</span></a></sup>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {Z} )&amp;=\operatorname {E} _{\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\operatorname {E} _{\mathbf {\pi } }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+\operatorname {E} _{\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\sum _{n=1}^{N}\sum _{k=1}^{K}z_{nk}\ln \rho _{nk}+{\text{constant}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msup>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03C0;<!-- π --></mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03BC;<!-- μ --></mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03BC;<!-- μ --></mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03C0;<!-- π --></mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>&#x03BC;<!-- μ --></mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">X</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03BC;<!-- μ --></mi>
                </mrow>
                <mo>,</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>z</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mi>&#x03C1;<!-- ρ --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {Z} )&amp;=\operatorname {E} _{\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\operatorname {E} _{\mathbf {\pi } }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+\operatorname {E} _{\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\sum _{n=1}^{N}\sum _{k=1}^{K}z_{nk}\ln \rho _{nk}+{\text{constant}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a9e6956e240ed7d5d347063c687111ca758eabfd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -6.338ex; width:62.481ex; height:13.843ex;" alt="{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {Z} )&amp;=\operatorname {E} _{\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} ,\mathbf {Z} ,\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\operatorname {E} _{\mathbf {\pi } }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+\operatorname {E} _{\mathbf {\mu } ,\mathbf {\Lambda } }[\ln p(\mathbf {X} \mid \mathbf {Z} ,\mathbf {\mu } ,\mathbf {\Lambda } )]+{\text{constant}}\\&amp;=\sum _{n=1}^{N}\sum _{k=1}^{K}z_{nk}\ln \rho _{nk}+{\text{constant}}\end{aligned}}}"></span></dd></dl>
<p>where we have defined
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ln \rho _{nk}=\operatorname {E} [\ln \pi _{k}]+{\frac {1}{2}}\operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]-{\frac {D}{2}}\ln(2\pi )-{\frac {1}{2}}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msub>
          <mi>&#x03C1;<!-- ρ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msub>
          <mi>&#x03C0;<!-- π --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">]</mo>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">]</mo>
        <mo>&#x2212;<!-- − --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mi>D</mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">(</mo>
        <mn>2</mn>
        <mi>&#x03C0;<!-- π --></mi>
        <mo stretchy="false">)</mo>
        <mo>&#x2212;<!-- − --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <mn>1</mn>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>&#x03BC;<!-- μ --></mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
            <mo>,</mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">T</mi>
            </mrow>
          </mrow>
        </msup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ln \rho _{nk}=\operatorname {E} [\ln \pi _{k}]+{\frac {1}{2}}\operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]-{\frac {D}{2}}\ln(2\pi )-{\frac {1}{2}}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6ec0788f8a16fa7e700c96d3af8382f54cbb287f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.838ex; width:79.981ex; height:5.176ex;" alt="{\displaystyle \ln \rho _{nk}=\operatorname {E} [\ln \pi _{k}]+{\frac {1}{2}}\operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]-{\frac {D}{2}}\ln(2\pi )-{\frac {1}{2}}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}"></span></dd></dl>
<p>Exponentiating both sides of the formula for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ln q^{*}(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ln q^{*}(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/0b004a9635c4925745f96e7f15050926fc4d78bd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:7.903ex; height:2.843ex;" alt="{\displaystyle \ln q^{*}(\mathbf {Z} )}"></span> yields
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} )\propto \prod _{n=1}^{N}\prod _{k=1}^{K}\rho _{nk}^{z_{nk}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x221D;<!-- ∝ --></mo>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>K</mi>
          </mrow>
        </munderover>
        <msubsup>
          <mi>&#x03C1;<!-- ρ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>n</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} )\propto \prod _{n=1}^{N}\prod _{k=1}^{K}\rho _{nk}^{z_{nk}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/dea44fe4e56df5e195593dbe748ac45b9dccaa35" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:19.365ex; height:7.343ex;" alt="{\displaystyle q^{*}(\mathbf {Z} )\propto \prod _{n=1}^{N}\prod _{k=1}^{K}\rho _{nk}^{z_{nk}}}"></span></dd></dl>
<p>Requiring that this be normalized ends up requiring that the <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \rho _{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03C1;<!-- ρ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \rho _{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e8adde11d7a36e6ac15d6ff18a40dc68ca5c5861" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:3.277ex; height:2.176ex;" alt="{\displaystyle \rho _{nk}}"></span> sum to 1 over all values of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;" alt="{\displaystyle k}"></span>, yielding
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} )=\prod _{n=1}^{N}\prod _{k=1}^{K}r_{nk}^{z_{nk}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>K</mi>
          </mrow>
        </munderover>
        <msubsup>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mi>z</mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>n</mi>
                <mi>k</mi>
              </mrow>
            </msub>
          </mrow>
        </msubsup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} )=\prod _{n=1}^{N}\prod _{k=1}^{K}r_{nk}^{z_{nk}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/76a0934ae8df172e6ba425f89ffe383f5367fb34" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:19.211ex; height:7.343ex;" alt="{\displaystyle q^{*}(\mathbf {Z} )=\prod _{n=1}^{N}\prod _{k=1}^{K}r_{nk}^{z_{nk}}}"></span></dd></dl>
<p>where
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}={\frac {\rho _{nk}}{\sum _{j=1}^{K}\rho _{nj}}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mfrac>
            <msub>
              <mi>&#x03C1;<!-- ρ --></mi>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>n</mi>
                <mi>k</mi>
              </mrow>
            </msub>
            <mrow>
              <munderover>
                <mo>&#x2211;<!-- ∑ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>j</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>K</mi>
                </mrow>
              </munderover>
              <msub>
                <mi>&#x03C1;<!-- ρ --></mi>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>n</mi>
                  <mi>j</mi>
                </mrow>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}={\frac {\rho _{nk}}{\sum _{j=1}^{K}\rho _{nj}}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c142dc2891f560561d42c3630bd402e3436c9e48" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.505ex; width:16.007ex; height:6.509ex;" alt="{\displaystyle r_{nk}={\frac {\rho _{nk}}{\sum _{j=1}^{K}\rho _{nj}}}}"></span></dd></dl>
<p>In other words, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {Z} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {Z} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/90de3cc99b18da7ee87f98d0cd7cd66b7c791836" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.577ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {Z} )}"></span> is a product of single-observation <a href="/wiki/Multinomial_distribution" title="Multinomial distribution">multinomial distributions</a>, and factors over each individual <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {z} _{n}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">z</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {z} _{n}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ff3c4e54a2f18ad992a5eb8057055d92e1389f5f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.406ex; height:2.009ex;" alt="{\displaystyle \mathbf {z} _{n}}"></span>, which is distributed as a single-observation multinomial distribution with parameters <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span> for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k=1\dots K}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
        <mo>=</mo>
        <mn>1</mn>
        <mo>&#x2026;<!-- … --></mo>
        <mi>K</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k=1\dots K}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f1b2624be134bda7a383bf912a040d6579a6127c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:11.036ex; height:2.176ex;" alt="{\displaystyle k=1\dots K}"></span>.
</p><p>Furthermore, we note that
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} [z_{nk}]=r_{nk}\,}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">]</mo>
        <mo>=</mo>
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mspace width="thinmathspace" />
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} [z_{nk}]=r_{nk}\,}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c15f150fa73aec952164769cfde73f6df58590e6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:12.642ex; height:2.843ex;" alt="{\displaystyle \operatorname {E} [z_{nk}]=r_{nk}\,}"></span></dd></dl>
<p>which is a standard result for categorical distributions.
</p><p>Now, considering the factor <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03BC;<!-- μ --></mi>
        </mrow>
        <mo>,</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/475da78c442f8bf3b83fbadb83249702f9e3517f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.554ex; height:2.843ex;" alt="{\displaystyle q(\mathbf {\pi } ,\mathbf {\mu } ,\mathbf {\Lambda } )}"></span>, note that it automatically factors into <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q(\mathbf {\pi } )\prod _{k=1}^{K}q(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <munderover>
          <mo>&#x220F;<!-- ∏ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>K</mi>
          </mrow>
        </munderover>
        <mi>q</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q(\mathbf {\pi } )\prod _{k=1}^{K}q(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/89d2a7f45d1252065f836fb12ef31675e9705733" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:17.32ex; height:7.343ex;" alt="{\displaystyle q(\mathbf {\pi } )\prod _{k=1}^{K}q(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})}"></span> due to the structure of the graphical model defining our Gaussian mixture model, which is specified above.
</p><p>Then,
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {\pi } )&amp;=\ln p(\mathbf {\pi } )+\operatorname {E} _{\mathbf {Z} }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+{\text{constant}}\\&amp;=(\alpha _{0}-1)\sum _{k=1}^{K}\ln \pi _{k}+\sum _{n=1}^{N}\sum _{k=1}^{K}r_{nk}\ln \pi _{k}+{\text{constant}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msup>
                  <mi>q</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2217;<!-- ∗ --></mo>
                  </mrow>
                </msup>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo>+</mo>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="bold">Z</mi>
                    </mrow>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mi>p</mi>
                <mo stretchy="false">(</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">Z</mi>
                </mrow>
                <mo>&#x2223;<!-- ∣ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi>&#x03C0;<!-- π --></mi>
                </mrow>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd />
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03B1;<!-- α --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <mn>1</mn>
                <mo stretchy="false">)</mo>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mi>&#x03C0;<!-- π --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>+</mo>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>K</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>r</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mi>&#x03C0;<!-- π --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mtext>constant</mtext>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {\pi } )&amp;=\ln p(\mathbf {\pi } )+\operatorname {E} _{\mathbf {Z} }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+{\text{constant}}\\&amp;=(\alpha _{0}-1)\sum _{k=1}^{K}\ln \pi _{k}+\sum _{n=1}^{N}\sum _{k=1}^{K}r_{nk}\ln \pi _{k}+{\text{constant}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9ce937b397d56eb7f4ee329522f5ba5379abd69f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -4.671ex; width:58.759ex; height:10.509ex;" alt="{\displaystyle {\begin{aligned}\ln q^{*}(\mathbf {\pi } )&amp;=\ln p(\mathbf {\pi } )+\operatorname {E} _{\mathbf {Z} }[\ln p(\mathbf {Z} \mid \mathbf {\pi } )]+{\text{constant}}\\&amp;=(\alpha _{0}-1)\sum _{k=1}^{K}\ln \pi _{k}+\sum _{n=1}^{N}\sum _{k=1}^{K}r_{nk}\ln \pi _{k}+{\text{constant}}\end{aligned}}}"></span></dd></dl>
<p>Taking the exponential of both sides, we recognize <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {\pi } )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {\pi } )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9aa11c5f81ece5855102329edd0d414cb9b2ddc7" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:5.275ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {\pi } )}"></span> as a <a href="/wiki/Dirichlet_distribution" title="Dirichlet distribution">Dirichlet distribution</a>
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {\pi } )\sim \operatorname {Dir} (\mathbf {\alpha } )\,}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mo>&#x223C;<!-- ∼ --></mo>
        <mi>Dir</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03B1;<!-- α --></mi>
        </mrow>
        <mo stretchy="false">)</mo>
        <mspace width="thinmathspace" />
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {\pi } )\sim \operatorname {Dir} (\mathbf {\alpha } )\,}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7746f0edeceda0c8599bf54a318591737792fed4" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:15.392ex; height:2.843ex;" alt="{\displaystyle q^{*}(\mathbf {\pi } )\sim \operatorname {Dir} (\mathbf {\alpha } )\,}"></span></dd></dl>
<p>where
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \alpha _{k}=\alpha _{0}+N_{k}\,}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B1;<!-- α --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <msub>
          <mi>&#x03B1;<!-- α --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>0</mn>
          </mrow>
        </msub>
        <mo>+</mo>
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mspace width="thinmathspace" />
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \alpha _{k}=\alpha _{0}+N_{k}\,}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cc05ba94245d5aa284388af9eb42fcc16603818d" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:14.399ex; height:2.509ex;" alt="{\displaystyle \alpha _{k}=\alpha _{0}+N_{k}\,}"></span></dd></dl>
<p>where
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{k}=\sum _{n=1}^{N}r_{nk}\,}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <munderover>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mspace width="thinmathspace" />
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{k}=\sum _{n=1}^{N}r_{nk}\,}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/576dd9a643f447e3f861754be8595ebd728d3dcd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:13.306ex; height:7.343ex;" alt="{\displaystyle N_{k}=\sum _{n=1}^{N}r_{nk}\,}"></span></dd></dl>
<p>Finally
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \ln q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})=\ln p(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})+\sum _{n=1}^{N}\operatorname {E} [z_{nk}]\ln {\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})+{\text{constant}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <munderover>
          <mo>&#x2211;<!-- ∑ --></mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mo>=</mo>
            <mn>1</mn>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>N</mi>
          </mrow>
        </munderover>
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <msub>
          <mi>z</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">]</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msubsup>
        <mo stretchy="false">)</mo>
        <mo>+</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mtext>constant</mtext>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \ln q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})=\ln p(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})+\sum _{n=1}^{N}\operatorname {E} [z_{nk}]\ln {\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})+{\text{constant}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cc21b5385915806fac7030e8de06621c21ee716c" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -3.005ex; width:70.864ex; height:7.343ex;" alt="{\displaystyle \ln q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})=\ln p(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})+\sum _{n=1}^{N}\operatorname {E} [z_{nk}]\ln {\mathcal {N}}(\mathbf {x} _{n}\mid \mathbf {\mu } _{k},\mathbf {\Lambda } _{k}^{-1})+{\text{constant}}}"></span></dd></dl>
<p>Grouping and reading off terms involving <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\mu } _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\mu } _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bbc0e86cd6298aec58f95ff25c7171dc10e330be" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:2.49ex; height:2.176ex;" alt="{\displaystyle \mathbf {\mu } _{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\Lambda } _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\Lambda } _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/969af1cce7839ff781158a8e64e5643ca85e4f27" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.962ex; height:2.509ex;" alt="{\displaystyle \mathbf {\Lambda } _{k}}"></span>, the result is a <a href="/wiki/Gaussian-Wishart_distribution" class="mw-redirect" title="Gaussian-Wishart distribution">Gaussian-Wishart distribution</a> given by
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})={\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {m} _{k},(\beta _{k}\mathbf {\Lambda } _{k})^{-1}){\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{k},\nu _{k})}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mi>q</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2217;<!-- ∗ --></mo>
          </mrow>
        </msup>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo>=</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">N</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">m</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mi>&#x03B2;<!-- β --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mo>&#x2212;<!-- − --></mo>
            <mn>1</mn>
          </mrow>
        </msup>
        <mo stretchy="false">)</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mrow class="MJX-TeXAtom-ORD">
            <mi class="MJX-tex-caligraphic" mathvariant="script">W</mi>
          </mrow>
        </mrow>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>&#x2223;<!-- ∣ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">W</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>&#x03BD;<!-- ν --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})={\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {m} _{k},(\beta _{k}\mathbf {\Lambda } _{k})^{-1}){\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{k},\nu _{k})}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/30dc879001e5185ffd06cc5441babfc3c04e8fce" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:52.133ex; height:3.176ex;" alt="{\displaystyle q^{*}(\mathbf {\mu } _{k},\mathbf {\Lambda } _{k})={\mathcal {N}}(\mathbf {\mu } _{k}\mid \mathbf {m} _{k},(\beta _{k}\mathbf {\Lambda } _{k})^{-1}){\mathcal {W}}(\mathbf {\Lambda } _{k}\mid \mathbf {W} _{k},\nu _{k})}"></span></dd></dl>
<p>given the definitions
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\beta _{k}&amp;=\beta _{0}+N_{k}\\\mathbf {m} _{k}&amp;={\frac {1}{\beta _{k}}}(\beta _{0}\mathbf {\mu } _{0}+N_{k}{\bar {\mathbf {x} }}_{k})\\\mathbf {W} _{k}^{-1}&amp;=\mathbf {W} _{0}^{-1}+N_{k}\mathbf {S} _{k}+{\frac {\beta _{0}N_{k}}{\beta _{0}+N_{k}}}({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})^{\rm {T}}\\\nu _{k}&amp;=\nu _{0}+N_{k}\\N_{k}&amp;=\sum _{n=1}^{N}r_{nk}\\{\bar {\mathbf {x} }}_{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}\mathbf {x} _{n}\\\mathbf {S} _{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})^{\rm {T}}\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">m</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <msub>
                      <mi>&#x03B2;<!-- β --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msubsup>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">S</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>+</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>&#x03B2;<!-- β --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>N</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mrow>
                    <mrow>
                      <msub>
                        <mi>&#x03B2;<!-- β --></mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mn>0</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>N</mi>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi>k</mi>
                        </mrow>
                      </msub>
                    </mrow>
                  </mfrac>
                </mrow>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">T</mi>
                    </mrow>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mn>0</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>N</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>N</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>r</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <msub>
                      <mi>N</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>r</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">S</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mfrac>
                    <mn>1</mn>
                    <msub>
                      <mi>N</mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>N</mi>
                  </mrow>
                </munderover>
                <msub>
                  <mi>r</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mrow class="MJX-TeXAtom-ORD">
                          <mi mathvariant="bold">x</mi>
                        </mrow>
                        <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">T</mi>
                    </mrow>
                  </mrow>
                </msup>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\beta _{k}&amp;=\beta _{0}+N_{k}\\\mathbf {m} _{k}&amp;={\frac {1}{\beta _{k}}}(\beta _{0}\mathbf {\mu } _{0}+N_{k}{\bar {\mathbf {x} }}_{k})\\\mathbf {W} _{k}^{-1}&amp;=\mathbf {W} _{0}^{-1}+N_{k}\mathbf {S} _{k}+{\frac {\beta _{0}N_{k}}{\beta _{0}+N_{k}}}({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})^{\rm {T}}\\\nu _{k}&amp;=\nu _{0}+N_{k}\\N_{k}&amp;=\sum _{n=1}^{N}r_{nk}\\{\bar {\mathbf {x} }}_{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}\mathbf {x} _{n}\\\mathbf {S} _{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})^{\rm {T}}\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/a5e390b9fe838d3864e07b6fa538f3e4047605b7" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -19.396ex; margin-bottom: -0.275ex; width:54.882ex; height:40.509ex;" alt="{\displaystyle {\begin{aligned}\beta _{k}&amp;=\beta _{0}+N_{k}\\\mathbf {m} _{k}&amp;={\frac {1}{\beta _{k}}}(\beta _{0}\mathbf {\mu } _{0}+N_{k}{\bar {\mathbf {x} }}_{k})\\\mathbf {W} _{k}^{-1}&amp;=\mathbf {W} _{0}^{-1}+N_{k}\mathbf {S} _{k}+{\frac {\beta _{0}N_{k}}{\beta _{0}+N_{k}}}({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})({\bar {\mathbf {x} }}_{k}-\mathbf {\mu } _{0})^{\rm {T}}\\\nu _{k}&amp;=\nu _{0}+N_{k}\\N_{k}&amp;=\sum _{n=1}^{N}r_{nk}\\{\bar {\mathbf {x} }}_{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}\mathbf {x} _{n}\\\mathbf {S} _{k}&amp;={\frac {1}{N_{k}}}\sum _{n=1}^{N}r_{nk}(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})(\mathbf {x} _{n}-{\bar {\mathbf {x} }}_{k})^{\rm {T}}\end{aligned}}}"></span></dd></dl>
<p>Finally, notice that these functions require the values of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span>, which make use of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \rho _{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03C1;<!-- ρ --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \rho _{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/e8adde11d7a36e6ac15d6ff18a40dc68ca5c5861" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:3.277ex; height:2.176ex;" alt="{\displaystyle \rho _{nk}}"></span>, which is defined in turn based on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} [\ln \pi _{k}]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <msub>
          <mi>&#x03C0;<!-- π --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} [\ln \pi _{k}]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7038f8179432a3693f8296feacc5f8874ba6f267" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:7.617ex; height:2.843ex;" alt="{\displaystyle \operatorname {E} [\ln \pi _{k}]}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi mathvariant="normal">E</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mi>ln</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mrow class="MJX-TeXAtom-ORD">
          <mo stretchy="false">|</mo>
        </mrow>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c07e1eecf8caee684700b0e4b63cc117051feab1" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:9.459ex; height:2.843ex;" alt="{\displaystyle \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]}"></span>, and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi mathvariant="normal">E</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>&#x03BC;<!-- μ --></mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
            <mo>,</mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
          </mrow>
        </msub>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mo stretchy="false">[</mo>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <msup>
          <mo stretchy="false">)</mo>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mi mathvariant="normal">T</mi>
            </mrow>
          </mrow>
        </msup>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">(</mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">x</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
          </mrow>
        </msub>
        <mo>&#x2212;<!-- − --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <mo stretchy="false">)</mo>
        <mo stretchy="false">]</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/632ace27969c8d456caa65b802e8e8ce268e51bb" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -1.005ex; width:31.521ex; height:3.343ex;" alt="{\displaystyle \operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]}"></span>.  Now that we have determined the distributions over which these expectations are taken, we can derive formulas for them:
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\begin{aligned}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]&amp;=D\beta _{k}^{-1}+\nu _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\\\ln {\widetilde {\Lambda }}_{k}&amp;\equiv \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]=\sum _{i=1}^{D}\psi \left({\frac {\nu _{k}+1-i}{2}}\right)+D\ln 2+\ln |\mathbf {W} _{k}|\\\ln {\widetilde {\pi }}_{k}&amp;\equiv \operatorname {E} \left[\ln |\pi _{k}|\right]=\psi (\alpha _{k})-\psi \left(\sum _{i=1}^{K}\alpha _{i}\right)\end{aligned}}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true">
            <mtr>
              <mtd>
                <msub>
                  <mi mathvariant="normal">E</mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>&#x03BC;<!-- μ --></mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                    <mo>,</mo>
                    <msub>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msub>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">T</mi>
                    </mrow>
                  </mrow>
                </msup>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>&#x03BC;<!-- μ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
                <mo stretchy="false">]</mo>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>=</mo>
                <mi>D</mi>
                <msubsup>
                  <mi>&#x03B2;<!-- β --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mo>&#x2212;<!-- − --></mo>
                    <mn>1</mn>
                  </mrow>
                </msubsup>
                <mo>+</mo>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">m</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <msup>
                  <mo stretchy="false">)</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi mathvariant="normal">T</mi>
                    </mrow>
                  </mrow>
                </msup>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">(</mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">x</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>n</mi>
                  </mrow>
                </msub>
                <mo>&#x2212;<!-- − --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">m</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mi mathvariant="normal">&#x039B;<!-- Λ --></mi>
                        <mo>&#x007E;<!-- ~ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x2261;<!-- ≡ --></mo>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mo stretchy="false">[</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <mo stretchy="false">]</mo>
                <mo>=</mo>
                <munderover>
                  <mo>&#x2211;<!-- ∑ --></mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>D</mi>
                  </mrow>
                </munderover>
                <mi>&#x03C8;<!-- ψ --></mi>
                <mrow>
                  <mo>(</mo>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mfrac>
                      <mrow>
                        <msub>
                          <mi>&#x03BD;<!-- ν --></mi>
                          <mrow class="MJX-TeXAtom-ORD">
                            <mi>k</mi>
                          </mrow>
                        </msub>
                        <mo>+</mo>
                        <mn>1</mn>
                        <mo>&#x2212;<!-- − --></mo>
                        <mi>i</mi>
                      </mrow>
                      <mn>2</mn>
                    </mfrac>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>+</mo>
                <mi>D</mi>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mn>2</mn>
                <mo>+</mo>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi mathvariant="bold">W</mi>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mrow class="MJX-TeXAtom-ORD">
                  <mo stretchy="false">|</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>ln</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <msub>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mrow class="MJX-TeXAtom-ORD">
                      <mover>
                        <mi>&#x03C0;<!-- π --></mi>
                        <mo>&#x007E;<!-- ~ --></mo>
                      </mover>
                    </mrow>
                  </mrow>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
              </mtd>
              <mtd>
                <mi></mi>
                <mo>&#x2261;<!-- ≡ --></mo>
                <mi mathvariant="normal">E</mi>
                <mo>&#x2061;<!-- ⁡ --></mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mi>ln</mi>
                    <mo>&#x2061;<!-- ⁡ --></mo>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mo stretchy="false">|</mo>
                    </mrow>
                    <msub>
                      <mi>&#x03C0;<!-- π --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>k</mi>
                      </mrow>
                    </msub>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mo stretchy="false">|</mo>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mo>=</mo>
                <mi>&#x03C8;<!-- ψ --></mi>
                <mo stretchy="false">(</mo>
                <msub>
                  <mi>&#x03B1;<!-- α --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mo stretchy="false">)</mo>
                <mo>&#x2212;<!-- − --></mo>
                <mi>&#x03C8;<!-- ψ --></mi>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <munderover>
                      <mo>&#x2211;<!-- ∑ --></mo>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>K</mi>
                      </mrow>
                    </munderover>
                    <msub>
                      <mi>&#x03B1;<!-- α --></mi>
                      <mrow class="MJX-TeXAtom-ORD">
                        <mi>i</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\begin{aligned}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]&amp;=D\beta _{k}^{-1}+\nu _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\\\ln {\widetilde {\Lambda }}_{k}&amp;\equiv \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]=\sum _{i=1}^{D}\psi \left({\frac {\nu _{k}+1-i}{2}}\right)+D\ln 2+\ln |\mathbf {W} _{k}|\\\ln {\widetilde {\pi }}_{k}&amp;\equiv \operatorname {E} \left[\ln |\pi _{k}|\right]=\psi (\alpha _{k})-\psi \left(\sum _{i=1}^{K}\alpha _{i}\right)\end{aligned}}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/ef9311bd1332799fbb4578b2547cd94b56b37acd" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -8.671ex; width:86.663ex; height:18.509ex;" alt="{\displaystyle {\begin{aligned}\operatorname {E} _{\mathbf {\mu } _{k},\mathbf {\Lambda } _{k}}[(\mathbf {x} _{n}-\mathbf {\mu } _{k})^{\rm {T}}\mathbf {\Lambda } _{k}(\mathbf {x} _{n}-\mathbf {\mu } _{k})]&amp;=D\beta _{k}^{-1}+\nu _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\\\ln {\widetilde {\Lambda }}_{k}&amp;\equiv \operatorname {E} [\ln |\mathbf {\Lambda } _{k}|]=\sum _{i=1}^{D}\psi \left({\frac {\nu _{k}+1-i}{2}}\right)+D\ln 2+\ln |\mathbf {W} _{k}|\\\ln {\widetilde {\pi }}_{k}&amp;\equiv \operatorname {E} \left[\ln |\pi _{k}|\right]=\psi (\alpha _{k})-\psi \left(\sum _{i=1}^{K}\alpha _{i}\right)\end{aligned}}}"></span></dd></dl>
<p>These results lead to
</p>
<dl><dd><span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}\propto {\widetilde {\pi }}_{k}{\widetilde {\Lambda }}_{k}^{1/2}\exp \left\{-{\frac {D}{2\beta _{k}}}-{\frac {\nu _{k}}{2}}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\right\}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
        <mo>&#x221D;<!-- ∝ --></mo>
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>&#x03C0;<!-- π --></mi>
                <mo>&#x007E;<!-- ~ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
        <msubsup>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi mathvariant="normal">&#x039B;<!-- Λ --></mi>
                <mo>&#x007E;<!-- ~ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
            <mrow class="MJX-TeXAtom-ORD">
              <mo>/</mo>
            </mrow>
            <mn>2</mn>
          </mrow>
        </msubsup>
        <mi>exp</mi>
        <mo>&#x2061;<!-- ⁡ --></mo>
        <mrow>
          <mo>{</mo>
          <mrow>
            <mo>&#x2212;<!-- − --></mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mfrac>
                <mi>D</mi>
                <mrow>
                  <mn>2</mn>
                  <msub>
                    <mi>&#x03B2;<!-- β --></mi>
                    <mrow class="MJX-TeXAtom-ORD">
                      <mi>k</mi>
                    </mrow>
                  </msub>
                </mrow>
              </mfrac>
            </mrow>
            <mo>&#x2212;<!-- − --></mo>
            <mrow class="MJX-TeXAtom-ORD">
              <mfrac>
                <msub>
                  <mi>&#x03BD;<!-- ν --></mi>
                  <mrow class="MJX-TeXAtom-ORD">
                    <mi>k</mi>
                  </mrow>
                </msub>
                <mn>2</mn>
              </mfrac>
            </mrow>
            <mo stretchy="false">(</mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">x</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>n</mi>
              </mrow>
            </msub>
            <mo>&#x2212;<!-- − --></mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">m</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
            <msup>
              <mo stretchy="false">)</mo>
              <mrow class="MJX-TeXAtom-ORD">
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="normal">T</mi>
                </mrow>
              </mrow>
            </msup>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">W</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
            <mo stretchy="false">(</mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">x</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>n</mi>
              </mrow>
            </msub>
            <mo>&#x2212;<!-- − --></mo>
            <msub>
              <mrow class="MJX-TeXAtom-ORD">
                <mi mathvariant="bold">m</mi>
              </mrow>
              <mrow class="MJX-TeXAtom-ORD">
                <mi>k</mi>
              </mrow>
            </msub>
            <mo stretchy="false">)</mo>
          </mrow>
          <mo>}</mo>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}\propto {\widetilde {\pi }}_{k}{\widetilde {\Lambda }}_{k}^{1/2}\exp \left\{-{\frac {D}{2\beta _{k}}}-{\frac {\nu _{k}}{2}}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\right\}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/668102a542c2cb9500edffbd07748ff3526257a0" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -2.505ex; width:58.963ex; height:6.176ex;" alt="{\displaystyle r_{nk}\propto {\widetilde {\pi }}_{k}{\widetilde {\Lambda }}_{k}^{1/2}\exp \left\{-{\frac {D}{2\beta _{k}}}-{\frac {\nu _{k}}{2}}(\mathbf {x} _{n}-\mathbf {m} _{k})^{\rm {T}}\mathbf {W} _{k}(\mathbf {x} _{n}-\mathbf {m} _{k})\right\}}"></span></dd></dl>
<p>These can be converted from proportional to absolute values by normalizing over <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle k}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>k</mi>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle k}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c3c9a2c7b599b37105512c5d570edc034056dd40" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.211ex; height:2.176ex;" alt="{\displaystyle k}"></span> so that the corresponding values sum to 1.
</p><p>Note that:
</p>
<ol><li>The update equations for the parameters <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \beta _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B2;<!-- β --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \beta _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/026079ab88c28912592bb6e6d2a096f8253a5fba" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.404ex; height:2.509ex;" alt="{\displaystyle \beta _{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {m} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">m</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {m} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/68d6714a4bc322a9a143d181ba40b467121e27fb" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.315ex; height:2.009ex;" alt="{\displaystyle \mathbf {m} _{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {W} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">W</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {W} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9102b8a83e111e7056fab952db399d4eab2eb709" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.851ex; height:2.509ex;" alt="{\displaystyle \mathbf {W} _{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \nu _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BD;<!-- ν --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \nu _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ff7db3e5f1a1c6ee5a4529f59981e6d4dbf80c6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.237ex; height:2.009ex;" alt="{\displaystyle \nu _{k}}"></span> of the variables <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\mu } _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>&#x03BC;<!-- μ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\mu } _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bbc0e86cd6298aec58f95ff25c7171dc10e330be" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; width:2.49ex; height:2.176ex;" alt="{\displaystyle \mathbf {\mu } _{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\Lambda } _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">&#x039B;<!-- Λ --></mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\Lambda } _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/969af1cce7839ff781158a8e64e5643ca85e4f27" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.962ex; height:2.509ex;" alt="{\displaystyle \mathbf {\Lambda } _{k}}"></span> depend on the statistics <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7698f968a98115830bcc378e0f849e0375c858c9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.955ex; height:2.509ex;" alt="{\displaystyle N_{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\bar {\mathbf {x} }}_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">x</mi>
                </mrow>
                <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\bar {\mathbf {x} }}_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f2d4db4d364c44b97a4a3103f7f6cb58c69951e5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.5ex; height:2.343ex;" alt="{\displaystyle {\bar {\mathbf {x} }}_{k}}"></span>, and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {S} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">S</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {S} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/09491d73286bdeeeea46ccc7c69882a9c846a964" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.574ex; height:2.509ex;" alt="{\displaystyle \mathbf {S} _{k}}"></span>, and these statistics in turn depend on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span>.</li>
<li>The update equations for the parameters <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \alpha _{1\dots K}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B1;<!-- α --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
            <mo>&#x2026;<!-- … --></mo>
            <mi>K</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \alpha _{1\dots K}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aee3ad43735f45d3e35f641e91646c279923584a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:5.928ex; height:2.009ex;" alt="{\displaystyle \alpha _{1\dots K}}"></span> of the variable <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {\pi } }">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mrow class="MJX-TeXAtom-ORD">
          <mi>&#x03C0;<!-- π --></mi>
        </mrow>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {\pi } }</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/07b0cee10b7be89207fd2de25f81a23f11018ff8" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.338ex; width:1.332ex; height:1.676ex;" alt="{\displaystyle \mathbf {\pi } }"></span> depend on the statistic <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7698f968a98115830bcc378e0f849e0375c858c9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.955ex; height:2.509ex;" alt="{\displaystyle N_{k}}"></span>, which depends in turn on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span>.</li>
<li>The update equation for <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span> has a direct circular dependence on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \beta _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B2;<!-- β --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \beta _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/026079ab88c28912592bb6e6d2a096f8253a5fba" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.404ex; height:2.509ex;" alt="{\displaystyle \beta _{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {m} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">m</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {m} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/68d6714a4bc322a9a143d181ba40b467121e27fb" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.315ex; height:2.009ex;" alt="{\displaystyle \mathbf {m} _{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {W} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">W</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {W} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9102b8a83e111e7056fab952db399d4eab2eb709" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.851ex; height:2.509ex;" alt="{\displaystyle \mathbf {W} _{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \nu _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BD;<!-- ν --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \nu _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ff7db3e5f1a1c6ee5a4529f59981e6d4dbf80c6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.237ex; height:2.009ex;" alt="{\displaystyle \nu _{k}}"></span> as well as an indirect circular dependence on <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {W} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">W</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {W} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/9102b8a83e111e7056fab952db399d4eab2eb709" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.851ex; height:2.509ex;" alt="{\displaystyle \mathbf {W} _{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \nu _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03BD;<!-- ν --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \nu _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/5ff7db3e5f1a1c6ee5a4529f59981e6d4dbf80c6" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.237ex; height:2.009ex;" alt="{\displaystyle \nu _{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \alpha _{1\dots K}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>&#x03B1;<!-- α --></mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mn>1</mn>
            <mo>&#x2026;<!-- … --></mo>
            <mi>K</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \alpha _{1\dots K}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/aee3ad43735f45d3e35f641e91646c279923584a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:5.928ex; height:2.009ex;" alt="{\displaystyle \alpha _{1\dots K}}"></span> through <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\widetilde {\pi }}_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi>&#x03C0;<!-- π --></mi>
                <mo>&#x007E;<!-- ~ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\widetilde {\pi }}_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/216dab116594428a3dd3fd9f33822f8698e3d99b" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.421ex; height:2.343ex;" alt="{\displaystyle {\widetilde {\pi }}_{k}}"></span> and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\widetilde {\Lambda }}_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mi mathvariant="normal">&#x039B;<!-- Λ --></mi>
                <mo>&#x007E;<!-- ~ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\widetilde {\Lambda }}_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/adb89aa3345402b19d760fc1227ef5537fa4a442" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.702ex; height:3.176ex;" alt="{\displaystyle {\widetilde {\Lambda }}_{k}}"></span>.</li></ol>
<p>This suggests an iterative procedure that alternates between two steps:
</p>
<ol><li>An E-step that computes the value of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span> using the current values of all the other parameters.</li>
<li>An M-step that uses the new value of <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span> to compute new values of all the other parameters.</li></ol>
<p>Note that these steps correspond closely with the standard EM algorithm to derive a <a href="/wiki/Maximum_likelihood" class="mw-redirect" title="Maximum likelihood">maximum likelihood</a> or <a href="/wiki/Maximum_a_posteriori" class="mw-redirect" title="Maximum a posteriori">maximum a posteriori</a> (MAP) solution for the parameters of a <a href="/wiki/Gaussian_mixture_model" class="mw-redirect" title="Gaussian mixture model">Gaussian mixture model</a>.  The responsibilities <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle r_{nk}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>r</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle r_{nk}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d2f640f5e142f2e7b490500433a81e863a04413a" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:3.124ex; height:2.009ex;" alt="{\displaystyle r_{nk}}"></span> in the E step correspond closely to the <a href="/wiki/Posterior_probability" title="Posterior probability">posterior probabilities</a> of the latent variables given the data, i.e. <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle p(\mathbf {Z} \mid \mathbf {X} )}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <mi>p</mi>
        <mo stretchy="false">(</mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">Z</mi>
        </mrow>
        <mo>&#x2223;<!-- ∣ --></mo>
        <mrow class="MJX-TeXAtom-ORD">
          <mi mathvariant="bold">X</mi>
        </mrow>
        <mo stretchy="false">)</mo>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle p(\mathbf {Z} \mid \mathbf {X} )}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/cd89b09f65d1e8a693c636869893e12610a66b8f" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.838ex; margin-left: -0.089ex; width:8.659ex; height:2.843ex;" alt="{\displaystyle p(\mathbf {Z} \mid \mathbf {X} )}"></span>; the computation of the statistics <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle N_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mi>N</mi>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle N_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/7698f968a98115830bcc378e0f849e0375c858c9" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.955ex; height:2.509ex;" alt="{\displaystyle N_{k}}"></span>, <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle {\bar {\mathbf {x} }}_{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mrow class="MJX-TeXAtom-ORD">
              <mover>
                <mrow class="MJX-TeXAtom-ORD">
                  <mi mathvariant="bold">x</mi>
                </mrow>
                <mo stretchy="false">&#x00AF;<!-- ¯ --></mo>
              </mover>
            </mrow>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle {\bar {\mathbf {x} }}_{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f2d4db4d364c44b97a4a3103f7f6cb58c69951e5" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.5ex; height:2.343ex;" alt="{\displaystyle {\bar {\mathbf {x} }}_{k}}"></span>, and <span class="mwe-math-element mwe-math-element-inline"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle \mathbf {S} _{k}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msub>
          <mrow class="MJX-TeXAtom-ORD">
            <mi mathvariant="bold">S</mi>
          </mrow>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>k</mi>
          </mrow>
        </msub>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle \mathbf {S} _{k}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/09491d73286bdeeeea46ccc7c69882a9c846a964" class="mwe-math-fallback-image-inline mw-invert skin-invert" aria-hidden="true" style="vertical-align: -0.671ex; width:2.574ex; height:2.509ex;" alt="{\displaystyle \mathbf {S} _{k}}"></span> corresponds closely to the computation of corresponding "soft-count" statistics over the data; and the use of those statistics to compute new values of the parameters corresponds closely to the use of soft counts to compute new parameter values in normal EM over a Gaussian mixture model.
</p>
<div class="mw-heading mw-heading2"><h2 id="Exponential-family_distributions">Exponential-family distributions</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=21" title="Edit section: Exponential-family distributions"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<p>Note that in the previous example, once the distribution over unobserved variables was assumed to factorize into distributions over the "parameters" and distributions over the "latent data", the derived "best" distribution for each variable was in the same family as the corresponding prior distribution over the variable.  This is a general result that holds true for all prior distributions derived from the <a href="/wiki/Exponential_family" title="Exponential family">exponential family</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="See_also">See also</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=22" title="Edit section: See also"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<ul><li><a href="/wiki/Variational_message_passing" title="Variational message passing">Variational message passing</a>: a modular algorithm for variational Bayesian inference.</li>
<li><a href="/wiki/Variational_autoencoder" title="Variational autoencoder">Variational autoencoder</a>: an artificial neural network belonging to the families of probabilistic graphical models and Variational Bayesian methods.</li>
<li><a href="/wiki/Expectation%E2%80%93maximization_algorithm" title="Expectation–maximization algorithm">Expectation–maximization algorithm</a>: a related approach which corresponds to a special case of variational Bayesian inference.</li>
<li><a href="/wiki/Generalized_filtering" title="Generalized filtering">Generalized filtering</a>: a variational filtering scheme for nonlinear state space models.</li>
<li><a href="/wiki/Calculus_of_variations" title="Calculus of variations">Calculus of variations</a>: the field of mathematical analysis that deals with maximizing or minimizing functionals.</li>
<li><a href="/w/index.php?title=Maximum_entropy_discrimination&amp;action=edit&amp;redlink=1" class="new" title="Maximum entropy discrimination (page does not exist)">Maximum entropy discrimination</a>: This is a variational inference framework that allows for introducing and accounting for additional large-margin constraints<sup id="cite&#95;ref-7" class="reference"><a href="#cite_note-7"><span class="cite-bracket">&#91;</span>7<span class="cite-bracket">&#93;</span></a></sup></li></ul>
<div class="mw-heading mw-heading2"><h2 id="References">References</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=23" title="Edit section: References"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<style data-mw-deduplicate="TemplateStyles:r1239543626">.mw-parser-output .reflist{margin-bottom:0.5em;list-style-type:decimal}@media screen{.mw-parser-output .reflist{font-size:90%}}.mw-parser-output .reflist .references{font-size:100%;margin-bottom:0;list-style-type:inherit}.mw-parser-output .reflist-columns-2{column-width:30em}.mw-parser-output .reflist-columns-3{column-width:25em}.mw-parser-output .reflist-columns{margin-top:0.3em}.mw-parser-output .reflist-columns ol{margin-top:0}.mw-parser-output .reflist-columns li{page-break-inside:avoid;break-inside:avoid-column}.mw-parser-output .reflist-upper-alpha{list-style-type:upper-alpha}.mw-parser-output .reflist-upper-roman{list-style-type:upper-roman}.mw-parser-output .reflist-lower-alpha{list-style-type:lower-alpha}.mw-parser-output .reflist-lower-greek{list-style-type:lower-greek}.mw-parser-output .reflist-lower-roman{list-style-type:lower-roman}</style><div class="reflist">
<div class="mw-references-wrap"><ol class="references">
<li id="cite&#95;note-Tran2018-1"><span class="mw-cite-backlink">^ <a href="#cite_ref-Tran2018_1-0"><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-Tran2018_1-1"><sup><i><b>b</b></i></sup></a> <a href="#cite_ref-Tran2018_1-2"><sup><i><b>c</b></i></sup></a> <a href="#cite_ref-Tran2018_1-3"><sup><i><b>d</b></i></sup></a></span> <span class="reference-text"><style data-mw-deduplicate="TemplateStyles:r1238218222">.mw-parser-output cite.citation{font-style:inherit;word-wrap:break-word}.mw-parser-output .citation q{quotes:"\"""\"""'""'"}.mw-parser-output .citation:target{background-color:rgba(0,127,255,0.133)}.mw-parser-output .id-lock-free.id-lock-free a{background:url("//upload.wikimedia.org/wikipedia/commons/6/65/Lock-green.svg")right 0.1em center/9px no-repeat}.mw-parser-output .id-lock-limited.id-lock-limited a,.mw-parser-output .id-lock-registration.id-lock-registration a{background:url("//upload.wikimedia.org/wikipedia/commons/d/d6/Lock-gray-alt-2.svg")right 0.1em center/9px no-repeat}.mw-parser-output .id-lock-subscription.id-lock-subscription a{background:url("//upload.wikimedia.org/wikipedia/commons/a/aa/Lock-red-alt-2.svg")right 0.1em center/9px no-repeat}.mw-parser-output .cs1-ws-icon a{background:url("//upload.wikimedia.org/wikipedia/commons/4/4c/Wikisource-logo.svg")right 0.1em center/12px no-repeat}body:not(.skin-timeless):not(.skin-minerva) .mw-parser-output .id-lock-free a,body:not(.skin-timeless):not(.skin-minerva) .mw-parser-output .id-lock-limited a,body:not(.skin-timeless):not(.skin-minerva) .mw-parser-output .id-lock-registration a,body:not(.skin-timeless):not(.skin-minerva) .mw-parser-output .id-lock-subscription a,body:not(.skin-timeless):not(.skin-minerva) .mw-parser-output .cs1-ws-icon a{background-size:contain;padding:0 1em 0 0}.mw-parser-output .cs1-code{color:inherit;background:inherit;border:none;padding:inherit}.mw-parser-output .cs1-hidden-error{display:none;color:var(--color-error,#d33)}.mw-parser-output .cs1-visible-error{color:var(--color-error,#d33)}.mw-parser-output .cs1-maint{display:none;color:#085;margin-left:0.3em}.mw-parser-output .cs1-kern-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right{padding-right:0.2em}.mw-parser-output .citation .mw-selflink{font-weight:inherit}@media screen{.mw-parser-output .cs1-format{font-size:95%}html.skin-theme-clientpref-night .mw-parser-output .cs1-maint{color:#18911f}}@media screen and (prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .cs1-maint{color:#18911f}}</style><cite id="CITEREFTran2018" class="citation arxiv cs1">Tran, Viet Hung (2018). "Copula Variational Bayes inference via information geometry". <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="id-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="https://arxiv.org/abs/1803.10998">1803.10998</a></span> [<a rel="nofollow" class="external text" href="https://arxiv.org/archive/cs.IT">cs.IT</a>].</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=preprint&amp;rft.jtitle=arXiv&amp;rft.atitle=Copula+Variational+Bayes+inference+via+information+geometry&amp;rft.date=2018&amp;rft&#95;id=info%3Aarxiv%2F1803.10998&amp;rft.aulast=Tran&amp;rft.aufirst=Viet+Hung&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-Martin2014-2"><span class="mw-cite-backlink">^ <a href="#cite_ref-Martin2014_2-0"><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-Martin2014_2-1"><sup><i><b>b</b></i></sup></a></span> <span class="reference-text"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><cite id="CITEREFAdamčík2014" class="citation journal cs1">Adamčík, Martin (2014). <a rel="nofollow" class="external text" href="https://doi.org/10.3390%2Fe16126338">"The Information Geometry of Bregman Divergences and Some Applications in Multi-Expert Reasoning"</a>. <i>Entropy</i>. <b>16</b> (12): <span class="nowrap">6338–</span>6381. <a href="/wiki/Bibcode_(identifier)" class="mw-redirect" title="Bibcode (identifier)">Bibcode</a>:<a rel="nofollow" class="external text" href="https://ui.adsabs.harvard.edu/abs/2014Entrp..16.6338A">2014Entrp..16.6338A</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<span class="id-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="https://doi.org/10.3390%2Fe16126338">10.3390/e16126338</a></span>.</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Entropy&amp;rft.atitle=The+Information+Geometry+of+Bregman+Divergences+and+Some+Applications+in+Multi-Expert+Reasoning&amp;rft.volume=16&amp;rft.issue=12&amp;rft.pages=6338-6381&amp;rft.date=2014&amp;rft&#95;id=info%3Adoi%2F10.3390%2Fe16126338&amp;rft&#95;id=info%3Abibcode%2F2014Entrp..16.6338A&amp;rft.aulast=Adam%C4%8D%C3%ADk&amp;rft.aufirst=Martin&amp;rft&#95;id=https%3A%2F%2Fdoi.org%2F10.3390%252Fe16126338&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-Nguyen-3"><span class="mw-cite-backlink">^ <a href="#cite_ref-Nguyen_3-0"><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-Nguyen_3-1"><sup><i><b>b</b></i></sup></a> <a href="#cite_ref-Nguyen_3-2"><sup><i><b>c</b></i></sup></a></span> <span class="reference-text"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><cite id="CITEREFNguyen2023" class="citation web cs1">Nguyen, Duy (15 August 2023). <a rel="nofollow" class="external text" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4541076">"An in Depth Introduction to Variational Bayes Note"</a>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.2139%2Fssrn.4541076">10.2139/ssrn.4541076</a>. <a href="/wiki/SSRN_(identifier)" class="mw-redirect" title="SSRN (identifier)">SSRN</a>&#160;<a rel="nofollow" class="external text" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4541076">4541076</a><span class="reference-accessdate">. Retrieved <span class="nowrap">15 August</span> 2023</span>.</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=unknown&amp;rft.btitle=An+in+Depth+Introduction+to+Variational+Bayes+Note&amp;rft.date=2023-08-15&amp;rft&#95;id=https%3A%2F%2Fpapers.ssrn.com%2Fsol3%2Fpapers.cfm%3Fabstract&#95;id%3D4541076%23id-name%3DSSRN&amp;rft&#95;id=info%3Adoi%2F10.2139%2Fssrn.4541076&amp;rft.aulast=Nguyen&amp;rft.aufirst=Duy&amp;rft&#95;id=https%3A%2F%2Fpapers.ssrn.com%2Fsol3%2Fpapers.cfm%3Fabstract&#95;id%3D4541076&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-Yoon2021-4"><span class="mw-cite-backlink">^ <a href="#cite_ref-Yoon2021_4-0"><sup><i><b>a</b></i></sup></a> <a href="#cite_ref-Yoon2021_4-1"><sup><i><b>b</b></i></sup></a> <a href="#cite_ref-Yoon2021_4-2"><sup><i><b>c</b></i></sup></a></span> <span class="reference-text"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><cite id="CITEREFLee2021" class="citation journal cs1">Lee, Se Yoon (2021). "Gibbs sampler and coordinate ascent variational inference: A set-theoretical review". <i>Communications in Statistics - Theory and Methods</i>. <b>51</b> (6): <span class="nowrap">1–</span>21. <a href="/wiki/ArXiv_(identifier)" class="mw-redirect" title="ArXiv (identifier)">arXiv</a>:<span class="id-lock-free" title="Freely accessible"><a rel="nofollow" class="external text" href="https://arxiv.org/abs/2008.01006">2008.01006</a></span>. <a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1080%2F03610926.2021.1921214">10.1080/03610926.2021.1921214</a>. <a href="/wiki/S2CID_(identifier)" class="mw-redirect" title="S2CID (identifier)">S2CID</a>&#160;<a rel="nofollow" class="external text" href="https://api.semanticscholar.org/CorpusID:220935477">220935477</a>.</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Communications+in+Statistics+-+Theory+and+Methods&amp;rft.atitle=Gibbs+sampler+and+coordinate+ascent+variational+inference%3A+A+set-theoretical+review&amp;rft.volume=51&amp;rft.issue=6&amp;rft.pages=1-21&amp;rft.date=2021&amp;rft&#95;id=info%3Aarxiv%2F2008.01006&amp;rft&#95;id=https%3A%2F%2Fapi.semanticscholar.org%2FCorpusID%3A220935477%23id-name%3DS2CID&amp;rft&#95;id=info%3Adoi%2F10.1080%2F03610926.2021.1921214&amp;rft.aulast=Lee&amp;rft.aufirst=Se+Yoon&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-5"><span class="mw-cite-backlink"><b><a href="#cite_ref-5">^</a></b></span> <span class="reference-text"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><cite id="CITEREFBoydVandenberghe2004" class="citation book cs1">Boyd, Stephen P.; Vandenberghe, Lieven (2004). <a rel="nofollow" class="external text" href="https://web.stanford.edu/~boyd/cvxbook/bv_cvxbook.pdf"><i>Convex Optimization</i></a> <span class="cs1-format">(PDF)</span>. Cambridge University Press. <a href="/wiki/ISBN_(identifier)" class="mw-redirect" title="ISBN (identifier)">ISBN</a>&#160;<a href="/wiki/Special:BookSources/978-0-521-83378-3" title="Special:BookSources/978-0-521-83378-3"><bdi>978-0-521-83378-3</bdi></a><span class="reference-accessdate">. Retrieved <span class="nowrap">October 15,</span> 2011</span>.</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=book&amp;rft.btitle=Convex+Optimization&amp;rft.pub=Cambridge+University+Press&amp;rft.date=2004&amp;rft.isbn=978-0-521-83378-3&amp;rft.aulast=Boyd&amp;rft.aufirst=Stephen+P.&amp;rft.au=Vandenberghe%2C+Lieven&amp;rft&#95;id=https%3A%2F%2Fweb.stanford.edu%2F~boyd%2Fcvxbook%2Fbv&#95;cvxbook.pdf&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-bishop-6"><span class="mw-cite-backlink"><b><a href="#cite_ref-bishop_6-0">^</a></b></span> <span class="reference-text"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><cite id="CITEREFBishop2006" class="citation book cs1"><a href="/wiki/Christopher_M._Bishop" class="mw-redirect" title="Christopher M. Bishop">Bishop, Christopher M.</a> (2006). "Chapter 10". <i>Pattern Recognition and Machine Learning</i>. Springer. <a href="/wiki/ISBN_(identifier)" class="mw-redirect" title="ISBN (identifier)">ISBN</a>&#160;<a href="/wiki/Special:BookSources/978-0-387-31073-2" title="Special:BookSources/978-0-387-31073-2"><bdi>978-0-387-31073-2</bdi></a>.</cite><span title="ctx&#95;ver=Z39.88-2004&amp;rft&#95;val&#95;fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Abook&amp;rft.genre=bookitem&amp;rft.atitle=Chapter+10&amp;rft.btitle=Pattern+Recognition+and+Machine+Learning&amp;rft.pub=Springer&amp;rft.date=2006&amp;rft.isbn=978-0-387-31073-2&amp;rft.aulast=Bishop&amp;rft.aufirst=Christopher+M.&amp;rfr&#95;id=info%3Asid%2Fen.wikipedia.org%3AVariational+Bayesian+methods" class="Z3988"></span></span>
</li>
<li id="cite&#95;note-7"><span class="mw-cite-backlink"><b><a href="#cite_ref-7">^</a></b></span> <span class="reference-text">Sotirios P. Chatzis, “<a rel="nofollow" class="external text" href="http://proceedings.mlr.press/v28/chatzis13.pdf">Infinite Markov-Switching Maximum Entropy Discrimination Machines</a>,” Proc. 30th International Conference on Machine Learning (ICML). Journal of Machine Learning Research: Workshop and Conference Proceedings, vol. 28, no. 3, pp. 729–737, June 2013.</span>
</li>
</ol></div></div>
<div class="mw-heading mw-heading2"><h2 id="External_links">External links</h2><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Variational_Bayesian_methods&amp;action=edit&amp;section=24" title="Edit section: External links"><span>edit</span></a><span class="mw-editsection-bracket">]</span></span></div>
<ul><li><a rel="nofollow" class="external text" href="https://www.inference.phy.cam.ac.uk/mackay/itila/">The on-line textbook: Information Theory, Inference, and Learning Algorithms</a> <a rel="nofollow" class="external text" href="https://web.archive.org/web/20170512025952/https://www.inference.phy.cam.ac.uk/mackay/itila/">Archived</a> 2017-05-12 at the <a href="/wiki/Wayback_Machine" title="Wayback Machine">Wayback Machine</a>, by <a href="/wiki/David_J.C._MacKay" class="mw-redirect" title="David J.C. MacKay">David J.C. MacKay</a> provides an introduction to variational methods (p.&#160;422).</li>
<li><a rel="nofollow" class="external text" href="https://www.robots.ox.ac.uk/~sjrob/Pubs/fox_vbtut.pdf">A Tutorial on Variational Bayes</a>. Fox, C. and Roberts, S. 2012. Artificial Intelligence Review, <link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238218222" /><a href="/wiki/Doi_(identifier)" class="mw-redirect" title="Doi (identifier)">doi</a>:<a rel="nofollow" class="external text" href="https://doi.org/10.1007%2Fs10462-011-9236-8">10.1007/s10462-011-9236-8</a>.</li>
<li><a rel="nofollow" class="external text" href="https://www.gatsby.ucl.ac.uk/vbayes/">Variational-Bayes Repository</a> A repository of research papers, software, and links related to the use of variational methods for approximate Bayesian learning up to 2003.</li>
<li><a rel="nofollow" class="external text" href="https://www.cse.buffalo.edu/faculty/mbeal/thesis/index.html">Variational Algorithms for Approximate Bayesian Inference</a>, by M. J. Beal includes comparisons of EM to Variational Bayesian EM and derivations of several models including Variational Bayesian HMMs.</li>
<li><a rel="nofollow" class="external text" href="https://www.cs.jhu.edu/~jason/tutorials/variational.html">High-Level Explanation of Variational Inference</a> by Jason Eisner may be worth reading before a more mathematically detailed treatment.</li>
<li><a rel="nofollow" class="external text" href="https://arxiv.org/abs/1803.10998">Copula Variational Bayes inference via information geometry (pdf)</a> by Tran, V.H. 2018. This paper is primarily written for students. Via <a href="/wiki/Bregman_divergence" title="Bregman divergence">Bregman divergence</a>, the paper shows that Variational Bayes is simply a generalized Pythagorean projection of true model onto an arbitrarily correlated (copula) distributional space, of which the independent space is merely a special case.</li>
<li><a rel="nofollow" class="external text" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4541076">An in depth introduction to Variational Bayes note</a>. Nguyen, D.  2023</li></ul>
<!-- 
NewPP limit report
Parsed by mw‐web.eqiad.main‐79d5875b8c‐j8c5c
Cached time: 20251206030830
Cache expiry: 1802
Reduced expiry: true
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.560 seconds
Real time usage: 0.829 seconds
Preprocessor visited node count: 2245/1000000
Revision size: 57565/2097152 bytes
Post‐expand include size: 21924/2097152 bytes
Template argument size: 1034/2097152 bytes
Highest expansion depth: 11/100
Expensive parser function count: 4/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 46858/5000000 bytes
Lua time usage: 0.238/10.000 seconds
Lua memory usage: 5480879/52428800 bytes
Number of Wikibase entities loaded: 0/500
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  391.689      1 -total
 35.18%  137.794      1 Template:Reflist
 26.99%  105.721      1 Template:Short_description
 23.14%   90.647      1 Template:Cite_arXiv
 21.28%   83.364      1 Template:Bayesian_statistics
 20.19%   79.073      2 Template:Pagetype
  5.40%   21.144      1 Template:For
  3.96%   15.506      5 Template:Main_other
  3.15%   12.333      1 Template:SDcat
  3.04%   11.897      2 Template:Cite_book
-->

<!-- Saved in parser cache with key enwiki:pcache:1208480:|#|:idhash:canonical and timestamp 20251206030830 and revision id 1318931229. Rendering was triggered because: page_view
 -->
</div><noscript><img src="https://en.wikipedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&amp;type=1x1&amp;usesul3=1" alt="" width="1" height="1" style="border: none; position: absolute;"></noscript>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://en.wikipedia.org/w/index.php?title=Variational_Bayesian_methods&amp;oldid=1318931229">https://en.wikipedia.org/w/index.php?title=Variational_Bayesian_methods&amp;oldid=1318931229</a>"</div></div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Help:Category" title="Help:Category">Category</a>: <ul><li><a href="/wiki/Category:Bayesian_statistics" title="Category:Bayesian statistics">Bayesian statistics</a></li></ul></div><div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul><li><a href="/wiki/Category:Articles_with_short_description" title="Category:Articles with short description">Articles with short description</a></li><li><a href="/wiki/Category:Short_description_matches_Wikidata" title="Category:Short description matches Wikidata">Short description matches Wikidata</a></li><li><a href="/wiki/Category:Webarchive_template_wayback_links" title="Category:Webarchive template wayback links">Webarchive template wayback links</a></li></ul></div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 26 October 2025, at 21:31<span class="anonymous-show">&#160;(UTC)</span>.</li>
	<li id="footer-info-copyright">Text is available under the <a href="/wiki/Wikipedia:Text_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License" title="Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License">Creative Commons Attribution-ShareAlike 4.0 License</a>;
additional terms may apply. By using this site, you agree to the <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Terms_of_Use" class="extiw" title="foundation:Special:MyLanguage/Policy:Terms of Use">Terms of Use</a> and <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy" class="extiw" title="foundation:Special:MyLanguage/Policy:Privacy policy">Privacy Policy</a>. Wikipedia® is a registered trademark of the <a rel="nofollow" class="external text" href="https://wikimediafoundation.org/">Wikimedia Foundation, Inc.</a>, a non-profit organization.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Wikipedia:About">About Wikipedia</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/Wikipedia:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-contact"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us">Contact Wikipedia</a></li>
	<li id="footer-places-wm-codeofconduct"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Universal_Code_of_Conduct">Code of Conduct</a></li>
	<li id="footer-places-developers"><a href="https://developer.wikimedia.org">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/en.wikipedia.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Cookie_statement">Cookie statement</a></li>
	<li id="footer-places-mobileview"><a href="//en.wikipedia.org/w/index.php?title=Variational_Bayesian_methods&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.wikimedia.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/static/images/footer/wikimedia-button.svg" width="84" height="29"><img src="/static/images/footer/wikimedia.svg" width="25" height="25" alt="Wikimedia Foundation" lang="en" loading="lazy"></picture></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/w/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/w/resources/assets/mediawiki_compact.svg" alt="Powered by MediaWiki" lang="en" width="25" height="25" loading="lazy"></picture></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/w/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div  class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input
									class="cdx-text-input__input mw-searchInput" autocomplete="off"
									
									type="search" name="search" placeholder="Search Wikipedia">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left"  >
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox "  aria-label="Toggle the table of contents"  >
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true" ><span class="mw-page-title-main">Variational Bayesian methods</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<button class="cdx-button cdx-button--weight-quiet mw-interlanguage-selector" id="p-lang-btn-sticky-header" tabindex="-1" data-event-name="ui.dropdown-p-lang-btn-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-language mw-ui-icon-wikimedia-wikimedia-language"></span>

<span>6 languages</span>
			</button>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgHostname":"mw-web.eqiad.main-79d5875b8c-j8c5c","wgBackendResponseTime":988,"wgPageParseReport":{"limitreport":{"cputime":"0.560","walltime":"0.829","ppvisitednodes":{"value":2245,"limit":1000000},"revisionsize":{"value":57565,"limit":2097152},"postexpandincludesize":{"value":21924,"limit":2097152},"templateargumentsize":{"value":1034,"limit":2097152},"expansiondepth":{"value":11,"limit":100},"expensivefunctioncount":{"value":4,"limit":500},"unstrip-depth":{"value":1,"limit":20},"unstrip-size":{"value":46858,"limit":5000000},"entityaccesscount":{"value":0,"limit":500},"timingprofile":["100.00%  391.689      1 -total"," 35.18%  137.794      1 Template:Reflist"," 26.99%  105.721      1 Template:Short_description"," 23.14%   90.647      1 Template:Cite_arXiv"," 21.28%   83.364      1 Template:Bayesian_statistics"," 20.19%   79.073      2 Template:Pagetype","  5.40%   21.144      1 Template:For","  3.96%   15.506      5 Template:Main_other","  3.15%   12.333      1 Template:SDcat","  3.04%   11.897      2 Template:Cite_book"]},"scribunto":{"limitreport-timeusage":{"value":"0.238","limit":"10.000"},"limitreport-memusage":{"value":5480879,"limit":52428800}},"cachereport":{"origin":"mw-web.eqiad.main-79d5875b8c-j8c5c","timestamp":"20251206030830","ttl":1802,"transientcontent":true}}});});</script>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Article","name":"Variational Bayesian methods","url":"https:\/\/en.wikipedia.org\/wiki\/Variational_Bayesian_methods","sameAs":"http:\/\/www.wikidata.org\/entity\/Q7915794","mainEntity":"http:\/\/www.wikidata.org\/entity\/Q7915794","author":{"@type":"Organization","name":"Contributors to Wikimedia projects"},"publisher":{"@type":"Organization","name":"Wikimedia Foundation, Inc.","logo":{"@type":"ImageObject","url":"https:\/\/www.wikimedia.org\/static\/images\/wmf-hor-googpub.png"}},"datePublished":"2004-11-25T11:20:30Z","dateModified":"2025-10-26T21:31:28Z","headline":"mathematical methods used in Bayesian inference and machine learning"}</script>
</body>
</html>